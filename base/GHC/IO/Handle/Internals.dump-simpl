
==================== Tidy Core ====================
2018-03-16 16:05:06.317194917 UTC

Result size of Tidy Core
  = {terms: 3,954, types: 7,911, coercions: 666, joins: 13/26}

-- RHS size: {terms: 26, types: 31, coercions: 0, joins: 0/0}
augmentIOError :: IOException -> String -> Handle -> IOException
[GblId,
 Arity=3,
 Caf=NoCafRefs,
 Str=<S,1*U(A,U,A,U,U,1*U)><L,U><L,U>m,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
         Tmpl= \ (ioe_aa3G8 [Occ=Once!] :: IOException)
                 (fun_aa3Ga [Occ=Once] :: String)
                 (h_aa3Gb :: Handle) ->
                 case ioe_aa3G8 of
                 { IOError _ [Occ=Dead] ds1_da4Fn [Occ=Once] _ [Occ=Dead]
                           ds3_da4Fp [Occ=Once] ds4_da4Fq [Occ=Once] ds5_da4Fr [Occ=Once!] ->
                 GHC.IO.Exception.IOError
                   (GHC.Base.Just @ Handle h_aa3Gb)
                   ds1_da4Fn
                   fun_aa3Ga
                   ds3_da4Fp
                   ds4_da4Fq
                   (case ds5_da4Fr of wild1_Xi {
                      Nothing ->
                        case h_aa3Gb of {
                          FileHandle path_aa3Gd [Occ=Once] _ [Occ=Dead] ->
                            GHC.Base.Just @ FilePath path_aa3Gd;
                          DuplexHandle path_aa3Ge [Occ=Once] _ [Occ=Dead] _ [Occ=Dead] ->
                            GHC.Base.Just @ FilePath path_aa3Ge
                        };
                      Just _ [Occ=Dead] -> wild1_Xi
                    })
                 }}]
augmentIOError
  = \ (ioe_aa3G8 :: IOException)
      (fun_aa3Ga :: String)
      (h_aa3Gb :: Handle) ->
      case ioe_aa3G8 of
      { IOError ds_da4Fm ds1_da4Fn ds2_da4Fo ds3_da4Fp ds4_da4Fq
                ds5_da4Fr ->
      GHC.IO.Exception.IOError
        (GHC.Base.Just @ Handle h_aa3Gb)
        ds1_da4Fn
        fun_aa3Ga
        ds3_da4Fp
        ds4_da4Fq
        (case ds5_da4Fr of wild1_Xi {
           Nothing ->
             case h_aa3Gb of {
               FileHandle path_aa3Gd dt_da4Ve ->
                 GHC.Base.Just @ FilePath path_aa3Gd;
               DuplexHandle path_aa3Ge dt_da4Vf dt1_da4Vg ->
                 GHC.Base.Just @ FilePath path_aa3Ge
             };
           Just ds6_da4Fx -> wild1_Xi
         })
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle14 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 50 0}]
GHC.IO.Handle.Internals.wantReadableHandle14 = "handle is closed"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle13 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle13
  = unpackCString# GHC.IO.Handle.Internals.wantReadableHandle14

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle12 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.wantReadableHandle12
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.wantReadableHandle13
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle11 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle11
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.wantReadableHandle12

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_closedHandle1
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.ioe_closedHandle1
  = \ (@ a_aa4aN) (eta_Xa4XK :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4aN
        GHC.IO.Handle.Internals.wantReadableHandle11
        eta_Xa4XK

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
ioe_closedHandle2_ra7Pb
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_closedHandle2_ra7Pb
  = \ (@ a_aa4aN) (eta_B1 :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4aN
        GHC.IO.Handle.Internals.wantReadableHandle11
        eta_B1

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
ioe_closedHandle :: forall a. IO a
[GblId,
 Arity=1,
 Str=<B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_closedHandle1
               `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. IO a :: *))}]
ioe_closedHandle
  = ioe_closedHandle2_ra7Pb
    `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. IO a :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle10 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 70 0}]
GHC.IO.Handle.Internals.wantReadableHandle10
  = "handle is semi-closed"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle9 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle9
  = unpackCString# GHC.IO.Handle.Internals.wantReadableHandle10

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle8 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.wantReadableHandle8
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.wantReadableHandle9
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle7 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle7
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.wantReadableHandle8

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_semiclosedHandle1
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.ioe_semiclosedHandle1
  = \ (@ a_aa4aH) (eta_Xa4XM :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4aH
        GHC.IO.Handle.Internals.wantReadableHandle7
        eta_Xa4XM

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
ioe_semiclosedHandle2_ra7Pc
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_semiclosedHandle2_ra7Pc
  = \ (@ a_aa4aH) (eta_X2N :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4aH
        GHC.IO.Handle.Internals.wantReadableHandle7
        eta_X2N

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
ioe_semiclosedHandle :: forall a. IO a
[GblId,
 Arity=1,
 Str=<B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_semiclosedHandle1
               `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. IO a :: *))}]
ioe_semiclosedHandle
  = ioe_semiclosedHandle2_ra7Pc
    `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. IO a :: *))

-- RHS size: {terms: 7, types: 5, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.hLookAhead_4 :: IOException
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.hLookAhead_4
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.EOF
      (GHC.Types.[] @ Char)
      (GHC.Types.[] @ Char)
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.hLookAhead_3 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.hLookAhead_3
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.hLookAhead_4

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_EOF1
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.ioe_EOF1
  = \ (@ a_aa4a4) (eta_Xa4XO :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4a4
        GHC.IO.Handle.Internals.hLookAhead_3
        eta_Xa4XO

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
ioe_EOF2_ra7Pd
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_EOF2_ra7Pd
  = \ (@ a_aa4a4) (eta_X2U :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4a4
        GHC.IO.Handle.Internals.hLookAhead_3
        eta_X2U

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
ioe_EOF :: forall a. IO a
[GblId,
 Arity=1,
 Str=<B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_EOF1
               `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. IO a :: *))}]
ioe_EOF
  = ioe_EOF2_ra7Pd
    `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. IO a :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle6 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 90 0}]
GHC.IO.Handle.Internals.wantReadableHandle6
  = "handle is not open for reading"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle5 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle5
  = unpackCString# GHC.IO.Handle.Internals.wantReadableHandle6

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle4 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.wantReadableHandle4
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.wantReadableHandle5
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle3 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantReadableHandle3
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.wantReadableHandle4

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_notReadable1
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.ioe_notReadable1
  = \ (@ a_aa49Y) (eta_Xa4XQ :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa49Y
        GHC.IO.Handle.Internals.wantReadableHandle3
        eta_Xa4XQ

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
ioe_notReadable2_ra7Pe
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_notReadable2_ra7Pe
  = \ (@ a_aa49Y) (eta_X33 :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa49Y
        GHC.IO.Handle.Internals.wantReadableHandle3
        eta_X33

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
ioe_notReadable :: forall a. IO a
[GblId,
 Arity=1,
 Str=<B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_notReadable1
               `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. IO a :: *))}]
ioe_notReadable
  = ioe_notReadable2_ra7Pe
    `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. IO a :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantWritableHandle5 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 90 0}]
GHC.IO.Handle.Internals.wantWritableHandle5
  = "handle is not open for writing"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantWritableHandle4 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantWritableHandle4
  = unpackCString# GHC.IO.Handle.Internals.wantWritableHandle5

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantWritableHandle3 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.wantWritableHandle3
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.wantWritableHandle4
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantWritableHandle2 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantWritableHandle2
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.wantWritableHandle3

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_notWritable1
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.ioe_notWritable1
  = \ (@ a_aa49S) (eta_Xa4XS :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa49S
        GHC.IO.Handle.Internals.wantWritableHandle2
        eta_Xa4XS

-- RHS size: {terms: 5, types: 6, coercions: 0, joins: 0/0}
ioe_notWritable2_ra7Pf
  :: forall a. State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_notWritable2_ra7Pf
  = \ (@ a_aa49S) (eta_X3c :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa49S
        GHC.IO.Handle.Internals.wantWritableHandle2
        eta_X3c

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
ioe_notWritable :: forall a. IO a
[GblId,
 Arity=1,
 Str=<B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_notWritable1
               `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. IO a :: *))}]
ioe_notWritable
  = ioe_notWritable2_ra7Pf
    `cast` (forall (a :: <*>_N). Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a. State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. IO a :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantSeekableHandle6 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 70 0}]
GHC.IO.Handle.Internals.wantSeekableHandle6
  = "handle is not seekable"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantSeekableHandle5 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantSeekableHandle5
  = unpackCString# GHC.IO.Handle.Internals.wantSeekableHandle6

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantSeekableHandle4 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.wantSeekableHandle4
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.wantSeekableHandle5
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantSeekableHandle3 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.wantSeekableHandle3
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.wantSeekableHandle4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer6 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 170 0}]
GHC.IO.Handle.Internals.flushBuffer6
  = "cannot flush the read buffer: underlying device is not seekable"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer5 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.flushBuffer5
  = unpackCString# GHC.IO.Handle.Internals.flushBuffer6

-- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer4 :: IOException
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 70}]
GHC.IO.Handle.Internals.flushBuffer4
  = GHC.IO.Exception.IOError
      (GHC.Base.Nothing @ Handle)
      GHC.IO.Exception.IllegalOperation
      (GHC.Types.[] @ Char)
      GHC.IO.Handle.Internals.flushBuffer5
      (GHC.Base.Nothing @ CInt)
      (GHC.Base.Nothing @ FilePath)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer3 :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.flushBuffer3
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.IO.Handle.Internals.flushBuffer4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl_ra7Pg :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl_ra7Pg = "hSetBuffering"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl1_ra7Ph :: [Char]
[GblId]
lvl1_ra7Ph = unpackCString# lvl_ra7Pg

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl2_ra7Pi :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl2_ra7Pi = "illegal buffer size "#

-- RHS size: {terms: 23, types: 21, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$wioe_bufsiz [InlPrag=NOUSERINLINE[0]]
  :: forall a. Int# -> State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=2, Str=<B,U><B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.$wioe_bufsiz
  = \ (@ a_sa72V) (ww_sa730 :: Int#) (w_sa72X :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_sa72V
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Nothing @ Handle)
              GHC.IO.Exception.InvalidArgument
              lvl1_ra7Ph
              (unpackAppendCString#
                 lvl2_ra7Pi
                 (case GHC.Show.$wshowSignedInt 9# ww_sa730 (GHC.Types.[] @ Char) of
                  { (# ww5_i7NVe, ww6_i7NVf #) ->
                  GHC.Types.: @ Char ww5_i7NVe ww6_i7NVf
                  }))
              (GHC.Base.Nothing @ CInt)
              (GHC.Base.Nothing @ FilePath)))
        w_sa72X

-- RHS size: {terms: 9, types: 8, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.ioe_bufsiz1 [InlPrag=NOUSERINLINE[0]]
  :: forall a. Int -> State# RealWorld -> (# State# RealWorld, a #)
[GblId,
 Arity=2,
 Str=<B,1*U(U)><B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sa72V)
                 (w_sa72W [Occ=Once!] :: Int)
                 (w1_sa72X [Occ=Once] :: State# RealWorld) ->
                 case w_sa72W of { I# ww1_sa730 [Occ=Once] ->
                 GHC.IO.Handle.Internals.$wioe_bufsiz @ a_sa72V ww1_sa730 w1_sa72X
                 }}]
GHC.IO.Handle.Internals.ioe_bufsiz1
  = \ (@ a_sa72V) (w_sa72W :: Int) (w1_sa72X :: State# RealWorld) ->
      case w_sa72W of { I# ww1_sa730 ->
      GHC.IO.Handle.Internals.$wioe_bufsiz @ a_sa72V ww1_sa730 w1_sa72X
      }

-- RHS size: {terms: 1, types: 0, coercions: 8, joins: 0/0}
ioe_bufsiz :: forall a. Int -> IO a
[GblId,
 Arity=2,
 Str=<B,1*U(U)><B,U>x,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.ioe_bufsiz1
               `cast` (forall (a :: <*>_N).
                       <Int>_R ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           Int -> State# RealWorld -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a. Int -> IO a :: *))}]
ioe_bufsiz
  = GHC.IO.Handle.Internals.ioe_bufsiz1
    `cast` (forall (a :: <*>_N).
            <Int>_R ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                Int -> State# RealWorld -> (# State# RealWorld, a #) :: *)
               ~R# (forall a. Int -> IO a :: *))

-- RHS size: {terms: 64, types: 157, coercions: 13, joins: 1/1}
GHC.IO.Handle.Internals.$wstreamEncode [InlPrag=NOUSERINLINE[0]]
  :: forall from to state.
     CodeBuffer from to
     -> (Buffer from -> Buffer to -> IO (Buffer from, Buffer to))
     -> Buffer from
     -> Buffer to
     -> State# RealWorld
     -> (# State# RealWorld, (Buffer from, Buffer to) #)
[GblId,
 Arity=5,
 Caf=NoCafRefs,
 Str=<C(C(C(S(SS(SLL))))),C(C1(C1(U(U,1*U(1*U,U(U,U,U,U,U,U),U)))))><L,C(C1(C1(U(U,1*U(U(U,U,U,U,U,U),U)))))><L,U(U,U,U,U,U,U)><L,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [60 60 0 0 0] 193 0}]
GHC.IO.Handle.Internals.$wstreamEncode
  = \ (@ from_sa738)
      (@ to_sa739)
      (@ state_sa73a)
      (ww_sa73h :: CodeBuffer from_sa738 to_sa739)
      (ww1_sa73i
         :: Buffer from_sa738
            -> Buffer to_sa739 -> IO (Buffer from_sa738, Buffer to_sa739))
      (w_sa73c :: Buffer from_sa738)
      (w1_sa73d :: Buffer to_sa739)
      (w2_sa73e :: State# RealWorld) ->
      joinrec {
        go_sa5o7 [Occ=LoopBreaker]
          :: Buffer from_sa738
             -> Buffer to_sa739
             -> State# RealWorld
             -> (# State# RealWorld, (Buffer from_sa738, Buffer to_sa739) #)
        [LclId[JoinId(3)],
         Arity=3,
         Str=<L,U(U,U,U,U,U,U)><L,U><S,U>,
         Unf=OtherCon []]
        go_sa5o7 (from1_aa3Id :: Buffer from_sa738)
                 (to1_aa3Ie :: Buffer to_sa739)
                 (s_i7IAv :: State# RealWorld)
          = case ((ww_sa73h from1_aa3Id to1_aa3Ie)
                  `cast` (GHC.Types.N:IO[0]
                              <(CodingProgress, Buffer from_sa738, Buffer to_sa739)>_R
                          :: (IO (CodingProgress, Buffer from_sa738, Buffer to_sa739) :: *)
                             ~R# (State# RealWorld
                                  -> (# State# RealWorld,
                                        (CodingProgress, Buffer from_sa738,
                                         Buffer to_sa739) #) :: *)))
                   s_i7IAv
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            case ipv1_i7IAz of { (why_aa3If, from'_aa3Ig, to'_aa3Ih) ->
            case why_aa3If of {
              __DEFAULT -> (# ipv_i7IAy, (from'_aa3Ig, to'_aa3Ih) #);
              InvalidSequence ->
                case from1_aa3Id of
                { Buffer dt_ia4zH dt1_ia4zI ds2_ia4zJ dt2_ia4zK dt3_ia4zL
                         dt4_ia4zM ->
                case from'_aa3Ig of wild3_Xa4E8
                { Buffer dt7_Xa4Ec dt8_Xa4Ee ds3_Xa4Eg dt9_Xa4Ei dt10_Xa4Ek
                         dt11_Xa4Em ->
                case ==# dt3_ia4zL dt10_Xa4Ek of {
                  __DEFAULT -> (# ipv_i7IAy, (wild3_Xa4E8, to'_aa3Ih) #);
                  1# ->
                    case ((ww1_sa73i wild3_Xa4E8 to'_aa3Ih)
                          `cast` (GHC.Types.N:IO[0] <(Buffer from_sa738, Buffer to_sa739)>_R
                                  :: (IO (Buffer from_sa738, Buffer to_sa739) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                (Buffer from_sa738, Buffer to_sa739) #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICp, ipv3_X7ICr #) ->
                    case ipv3_X7ICr of { (from'1_aa3Ii, to'1_aa3Ij) ->
                    jump go_sa5o7 from'1_aa3Ii to'1_aa3Ij ipv2_X7ICp
                    }
                    }
                }
                }
                }
            }
            }
            }; } in
      jump go_sa5o7 w_sa73c w1_sa73d w2_sa73e

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
dEFAULT_CHAR_BUFFER_SIZE :: Int
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
dEFAULT_CHAR_BUFFER_SIZE = GHC.Types.I# 2048#

-- RHS size: {terms: 7, types: 2, coercions: 0, joins: 0/0}
initBufferState :: HandleType -> BufferState
[GblId,
 Arity=1,
 Caf=NoCafRefs,
 Str=<S,1*U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (ds_da4vV [Occ=Once!] :: HandleType) ->
                 case ds_da4vV of {
                   __DEFAULT -> GHC.IO.Buffer.WriteBuffer;
                   ReadHandle -> GHC.IO.Buffer.ReadBuffer
                 }}]
initBufferState
  = \ (ds_da4vV :: HandleType) ->
      case ds_da4vV of {
        __DEFAULT -> GHC.IO.Buffer.WriteBuffer;
        ReadHandle -> GHC.IO.Buffer.ReadBuffer
      }

-- RHS size: {terms: 27, types: 45, coercions: 5, joins: 0/0}
lvl3_ra7Pj
  :: State# RealWorld -> (# State# RealWorld, CharBuffer #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl3_ra7Pj
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMutVar#
             @ GHC.ForeignPtr.Finalizers
             @ RealWorld
             GHC.ForeignPtr.NoFinalizers
             s'_i91ZE
      of
      { (# ipv_ia4Xw, ipv1_ia4Xx #) ->
      case newPinnedByteArray# @ RealWorld 4# ipv_ia4Xw of
      { (# ipv2_ia4XB, ipv3_ia4XC #) ->
      (# ipv2_ia4XB,
         GHC.IO.Buffer.Buffer
           @ Char
           (byteArrayContents#
              (ipv3_ia4XC
               `cast` (UnsafeCo representational (MutableByteArray#
                                                    RealWorld) ByteArray#
                       :: (MutableByteArray# RealWorld :: TYPE 'UnliftedRep)
                          ~R# (ByteArray# :: TYPE 'UnliftedRep))))
           (GHC.ForeignPtr.MallocPtr ipv3_ia4XC ipv1_ia4Xx)
           GHC.IO.Buffer.ReadBuffer
           1#
           0#
           0# #)
      }
      }
      }

-- RHS size: {terms: 5, types: 30, coercions: 0, joins: 0/0}
noCharBuffer [InlPrag=NOINLINE] :: CharBuffer
[GblId]
noCharBuffer
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, CharBuffer #)
           lvl3_ra7Pj
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 27, types: 45, coercions: 5, joins: 0/0}
lvl4_ra7Pk
  :: State# RealWorld -> (# State# RealWorld, Buffer Word8 #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl4_ra7Pk
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMutVar#
             @ GHC.ForeignPtr.Finalizers
             @ RealWorld
             GHC.ForeignPtr.NoFinalizers
             s'_i91ZE
      of
      { (# ipv_ia4Y9, ipv1_ia4Ya #) ->
      case newPinnedByteArray# @ RealWorld 1# ipv_ia4Y9 of
      { (# ipv2_ia4Ye, ipv3_ia4Yf #) ->
      (# ipv2_ia4Ye,
         GHC.IO.Buffer.Buffer
           @ Word8
           (byteArrayContents#
              (ipv3_ia4Yf
               `cast` (UnsafeCo representational (MutableByteArray#
                                                    RealWorld) ByteArray#
                       :: (MutableByteArray# RealWorld :: TYPE 'UnliftedRep)
                          ~R# (ByteArray# :: TYPE 'UnliftedRep))))
           (GHC.ForeignPtr.MallocPtr ipv3_ia4Yf ipv1_ia4Ya)
           GHC.IO.Buffer.ReadBuffer
           1#
           0#
           0# #)
      }
      }
      }

-- RHS size: {terms: 5, types: 33, coercions: 0, joins: 0/0}
noByteBuffer [InlPrag=NOINLINE] :: Buffer Word8
[GblId]
noByteBuffer
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, Buffer Word8 #)
           lvl4_ra7Pk
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$trModule4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Internals.$trModule4 = "base"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$trModule3 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Internals.$trModule3
  = GHC.Types.TrNameS GHC.IO.Handle.Internals.$trModule4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$trModule2 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 70 0}]
GHC.IO.Handle.Internals.$trModule2 = "GHC.IO.Handle.Internals"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$trModule1 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Internals.$trModule1
  = GHC.Types.TrNameS GHC.IO.Handle.Internals.$trModule2

-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$trModule :: Module
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 30}]
GHC.IO.Handle.Internals.$trModule
  = GHC.Types.Module
      GHC.IO.Handle.Internals.$trModule3
      GHC.IO.Handle.Internals.$trModule1

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl5_ra7Pl :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl5_ra7Pl = "handle is finalized"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl6_ra7Pm :: [Char]
[GblId]
lvl6_ra7Pm = unpackCString# lvl5_ra7Pl

-- RHS size: {terms: 11, types: 7, coercions: 0, joins: 0/0}
ioe_finalizedHandle :: FilePath -> Handle__
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
ioe_finalizedHandle
  = \ (fp_aa3I2 :: FilePath) ->
      throw
        @ IOException
        @ Handle__
        GHC.IO.Exception.$fExceptionIOException
        (GHC.IO.Exception.IOError
           (GHC.Base.Nothing @ Handle)
           GHC.IO.Exception.IllegalOperation
           (GHC.Types.[] @ Char)
           lvl6_ra7Pm
           (GHC.Base.Nothing @ CInt)
           (GHC.Base.Just @ FilePath fp_aa3I2))

-- RHS size: {terms: 40, types: 164, coercions: 6, joins: 0/0}
GHC.IO.Handle.Internals.closeTextCodecs1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 140 60}]
GHC.IO.Handle.Internals.closeTextCodecs1
  = \ (ds_da4tC :: Handle__) (eta_X3M :: State# RealWorld) ->
      case ds_da4tC of
      { Handle__ @ dev_aa41h @ enc_state_aa41i @ dec_state_aa41j
                 $dIODevice_aa41k $dBufferedIO_aa41l $dTypeable_aa41m ds1_da4up
                 ds2_da4uq dt_da4Uy ds3_da4us dt1_da4Uz dt2_da4UA dt3_da4UB
                 ds4_da4uw ds5_da4ux ds6_da4uy ds7_da4uz ds8_da4uA ds9_da4uB ->
      case ds5_da4ux of {
        Nothing ->
          case ds4_da4uw of {
            Nothing -> (# eta_X3M, GHC.Tuple.() #);
            Just d_aa3Lr ->
              case d_aa3Lr of
              { BufferCodec ds10_ia4tL ds11_ia4tM ds12_ia4tN ds13_ia4tO
                            ds14_ia4tP ->
              (ds12_ia4tN
               `cast` (GHC.Types.N:IO[0] <()>_R
                       :: (IO () :: *)
                          ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                eta_X3M
              }
          };
        Just d_aa3Lq ->
          case d_aa3Lq of
          { BufferCodec ds10_ia4tL ds11_ia4tM ds12_ia4tN ds13_ia4tO
                        ds14_ia4tP ->
          case (ds12_ia4tN
                `cast` (GHC.Types.N:IO[0] <()>_R
                        :: (IO () :: *)
                           ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                 eta_X3M
          of
          { (# ipv_i7JiK, ipv1_i7JiL #) ->
          case ds4_da4uw of {
            Nothing -> (# ipv_i7JiK, GHC.Tuple.() #);
            Just d1_aa3Lr ->
              case d1_aa3Lr of
              { BufferCodec ds16_Xa4wU ds17_Xa4wW ds18_Xa4wY ds19_Xa4x0
                            ds20_Xa4x2 ->
              (ds18_Xa4wY
               `cast` (GHC.Types.N:IO[0] <()>_R
                       :: (IO () :: *)
                          ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                ipv_i7JiK
              }
          }
          }
          }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
closeTextCodecs :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.closeTextCodecs1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
closeTextCodecs
  = GHC.IO.Handle.Internals.closeTextCodecs1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 80, types: 155, coercions: 25, joins: 1/1}
GHC.IO.Handle.Internals.openTextEncoding1
  :: forall a.
     Maybe TextEncoding
     -> HandleType
     -> (forall es ds.
         Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Caf=NoCafRefs,
 Str=<S,1*U><L,U><L,1*C1(C1(C1(U(U,U))))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [60 278 300 0] 412 0}]
GHC.IO.Handle.Internals.openTextEncoding1
  = \ (@ a_aa430)
      (ds_da4vr :: Maybe TextEncoding)
      (ha_type_aa3KX :: HandleType)
      (cont_aa3KY
         :: forall es ds1.
            Maybe (TextEncoder es) -> Maybe (TextDecoder ds1) -> IO a_aa430)
      (eta_X3R :: State# RealWorld) ->
      case ds_da4vr of {
        Nothing ->
          ((cont_aa3KY
              @ Any
              @ Any
              (GHC.Base.Nothing @ (TextEncoder Any))
              (GHC.Base.Nothing @ (TextDecoder Any)))
           `cast` (GHC.Types.N:IO[0] <a_aa430>_R
                   :: (IO a_aa430 :: *)
                      ~R# (State# RealWorld -> (# State# RealWorld, a_aa430 #) :: *)))
            eta_X3R;
        Just ds1_da4vR ->
          case ds1_da4vR of
          { TextEncoding @ dstate_aa436 @ estate_aa437 ds2_da4vS ds3_da4vT
                         ds4_da4vU ->
          join {
            $j_sa5qP [Dmd=<L,1*C1(C1(U(U,U)))>]
              :: State# RealWorld
                 -> Maybe (TextDecoder dstate_aa436)
                 -> (# State# RealWorld, a_aa430 #)
            [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U>, Unf=OtherCon []]
            $j_sa5qP (ipv_i7IAy [OS=OneShot] :: State# RealWorld)
                     (ipv1_i7IAz [OS=OneShot] :: Maybe (TextDecoder dstate_aa436))
              = case ha_type_aa3KX of {
                  __DEFAULT ->
                    ((cont_aa3KY
                        @ estate_aa437
                        @ dstate_aa436
                        (GHC.Base.Nothing @ (TextEncoder estate_aa437))
                        ipv1_i7IAz)
                     `cast` (GHC.Types.N:IO[0] <a_aa430>_R
                             :: (IO a_aa430 :: *)
                                ~R# (State# RealWorld -> (# State# RealWorld, a_aa430 #) :: *)))
                      ipv_i7IAy;
                  WriteHandle ->
                    case (ds4_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    ((cont_aa3KY
                        @ estate_aa437
                        @ dstate_aa436
                        (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                        ipv1_i7IAz)
                     `cast` (GHC.Types.N:IO[0] <a_aa430>_R
                             :: (IO a_aa430 :: *)
                                ~R# (State# RealWorld -> (# State# RealWorld, a_aa430 #) :: *)))
                      ipv2_X7ICD
                    };
                  AppendHandle ->
                    case (ds4_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    ((cont_aa3KY
                        @ estate_aa437
                        @ dstate_aa436
                        (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                        ipv1_i7IAz)
                     `cast` (GHC.Types.N:IO[0] <a_aa430>_R
                             :: (IO a_aa430 :: *)
                                ~R# (State# RealWorld -> (# State# RealWorld, a_aa430 #) :: *)))
                      ipv2_X7ICD
                    };
                  ReadWriteHandle ->
                    case (ds4_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    ((cont_aa3KY
                        @ estate_aa437
                        @ dstate_aa436
                        (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                        ipv1_i7IAz)
                     `cast` (GHC.Types.N:IO[0] <a_aa430>_R
                             :: (IO a_aa430 :: *)
                                ~R# (State# RealWorld -> (# State# RealWorld, a_aa430 #) :: *)))
                      ipv2_X7ICD
                    }
                } } in
          case ha_type_aa3KX of {
            __DEFAULT ->
              jump $j_sa5qP
                eta_X3R (GHC.Base.Nothing @ (TextDecoder dstate_aa436));
            ReadHandle ->
              case (ds3_da4vT
                    `cast` (GHC.Types.N:IO[0] <TextDecoder dstate_aa436>_R
                            :: (IO (TextDecoder dstate_aa436) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, TextDecoder dstate_aa436 #) :: *)))
                     eta_X3R
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              jump $j_sa5qP
                ipv_i7IAy (GHC.Base.Just @ (TextDecoder dstate_aa436) ipv1_i7IAz)
              };
            ReadWriteHandle ->
              case (ds3_da4vT
                    `cast` (GHC.Types.N:IO[0] <TextDecoder dstate_aa436>_R
                            :: (IO (TextDecoder dstate_aa436) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, TextDecoder dstate_aa436 #) :: *)))
                     eta_X3R
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              jump $j_sa5qP
                ipv_i7IAy (GHC.Base.Just @ (TextDecoder dstate_aa436) ipv1_i7IAz)
              }
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 24, joins: 0/0}
openTextEncoding
  :: forall a.
     Maybe TextEncoding
     -> HandleType
     -> (forall es ds.
         Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
     -> IO a
[GblId,
 Arity=4,
 Caf=NoCafRefs,
 Str=<S,1*U><L,U><L,1*C1(C1(C1(U(U,U))))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.openTextEncoding1
               `cast` (forall (a :: <*>_N).
                       <Maybe TextEncoding>_R
                       ->_R <HandleType>_R
                       ->_R <forall es ds.
                             Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           Maybe TextEncoding
                           -> HandleType
                           -> (forall es ds.
                               Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               Maybe TextEncoding
                               -> HandleType
                               -> (forall es ds.
                                   Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
                               -> IO a :: *))}]
openTextEncoding
  = GHC.IO.Handle.Internals.openTextEncoding1
    `cast` (forall (a :: <*>_N).
            <Maybe TextEncoding>_R
            ->_R <HandleType>_R
            ->_R <forall es ds.
                  Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                Maybe TextEncoding
                -> HandleType
                -> (forall es ds.
                    Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    Maybe TextEncoding
                    -> HandleType
                    -> (forall es ds.
                        Maybe (TextEncoder es) -> Maybe (TextDecoder ds) -> IO a)
                    -> IO a :: *))

-- RHS size: {terms: 38, types: 110, coercions: 3, joins: 0/0}
GHC.IO.Handle.Internals.flushByteWriteBuffer1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 106 60}]
GHC.IO.Handle.Internals.flushByteWriteBuffer1
  = \ (h__aa3Jg :: Handle__) (eta_X3Q :: State# RealWorld) ->
      case h__aa3Jg of
      { Handle__ @ dev_aa43Q @ enc_state_aa43R @ dec_state_aa43S
                 $dIODevice_aa43T $dBufferedIO_aa43U $dTypeable_aa43V ds_da4x7
                 ds1_da4x8 dt_da4UG ds2_da4xa dt1_da4UH dt2_da4UI dt3_da4UJ
                 ds3_da4xe ds4_da4xf ds5_da4xg ds6_da4xh ds7_da4xi ds8_da4xj ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4UG eta_X3Q of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_ia4we
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT ->
          case ((Buffered.flushWriteBuffer
                   @ dev_aa43Q $dBufferedIO_aa43U ds_da4x7 wild1_ia4we)
                `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                        :: (IO (Buffer Word8) :: *)
                           ~R# (State# RealWorld
                                -> (# State# RealWorld, Buffer Word8 #) :: *)))
                 ipv_i7IAy
          of
          { (# ipv2_X7ICO, ipv3_X7ICQ #) ->
          case writeMutVar#
                 @ RealWorld @ (Buffer Word8) dt_da4UG ipv3_X7ICQ ipv2_X7ICO
          of s2#_i7IBe
          { __DEFAULT ->
          (# s2#_i7IBe, GHC.Tuple.() #)
          }
          };
        1# -> (# ipv_i7IAy, GHC.Tuple.() #)
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushByteWriteBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushByteWriteBuffer1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushByteWriteBuffer
  = GHC.IO.Handle.Internals.flushByteWriteBuffer1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 53, types: 142, coercions: 3, joins: 0/0}
GHC.IO.Handle.Internals.flushWriteBuffer1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 137 90}]
GHC.IO.Handle.Internals.flushWriteBuffer1
  = \ (h__aa3J1 :: Handle__) (eta_X3S :: State# RealWorld) ->
      case h__aa3J1 of
      { Handle__ @ dev_aa44j @ enc_state_aa44k @ dec_state_aa44l
                 $dIODevice_aa44m $dBufferedIO_aa44n $dTypeable_aa44o ds_da4y0
                 ds1_da4y1 dt_da4UK ds2_da4y3 dt1_da4UL dt2_da4UM dt3_da4UN
                 ds3_da4y7 ds4_da4y8 ds5_da4y9 ds6_da4ya ds7_da4yb ds8_da4yc ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4UK eta_X3S of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer dt4_ia4xp dt5_ia4xq ds10_ia4xr dt6_ia4xs dt7_ia4xt
               dt8_ia4xu ->
      case ds10_ia4xr of {
        ReadBuffer -> (# ipv_i7IAy, GHC.Tuple.() #);
        WriteBuffer ->
          case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4UK ipv_i7IAy of
          { (# ipv2_X7IFr, ipv3_X7IFt #) ->
          case ipv3_X7IFt of wild3_ia4we
          { Buffer dt9_ia4wr dt10_ia4ws ds12_ia4wz dt11_ia4wA dt12_ia4wB
                   dt13_ia4wC ->
          case ==# dt12_ia4wB dt13_ia4wC of {
            __DEFAULT ->
              case ((Buffered.flushWriteBuffer
                       @ dev_aa44j $dBufferedIO_aa44n ds_da4y0 wild3_ia4we)
                    `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                            :: (IO (Buffer Word8) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, Buffer Word8 #) :: *)))
                     ipv2_X7IFr
              of
              { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
              case writeMutVar#
                     @ RealWorld @ (Buffer Word8) dt_da4UK ipv5_X7ICQ ipv4_X7ICO
              of s2#_i7IBe
              { __DEFAULT ->
              (# s2#_i7IBe, GHC.Tuple.() #)
              }
              };
            1# -> (# ipv2_X7IFr, GHC.Tuple.() #)
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushWriteBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushWriteBuffer1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushWriteBuffer
  = GHC.IO.Handle.Internals.flushWriteBuffer1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl7_ra7Pn :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl7_ra7Pn = "codec_state"#

-- RHS size: {terms: 4, types: 4, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.decodeByteBuf2
  :: forall dec_state. dec_state
[GblId, Str=x]
GHC.IO.Handle.Internals.decodeByteBuf2
  = \ (@ dec_state_aa47A) ->
      errorWithoutStackTrace
        @ 'LiftedRep @ dec_state_aa47A (unpackCString# lvl7_ra7Pn)

-- RHS size: {terms: 76, types: 213, coercions: 2, joins: 0/0}
GHC.IO.Handle.Internals.decodeByteBuf1
  :: Handle__
     -> CharBuffer
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0 0] 217 60}]
GHC.IO.Handle.Internals.decodeByteBuf1
  = \ (h__aa3Na :: Handle__)
      (cbuf_aa3No :: CharBuffer)
      (eta_X3X :: State# RealWorld) ->
      case h__aa3Na of
      { Handle__ @ dev_aa47y @ enc_state_aa47z @ dec_state_aa47A
                 $dIODevice_aa47B $dBufferedIO_aa47C $dTypeable_aa47D ds_da4Bd
                 ds1_da4Be dt_da4UO ds2_da4Bg dt1_da4UP dt2_da4UQ dt3_da4UR
                 ds3_da4Bk ds4_da4Bl ds5_da4Bm ds6_da4Bn ds7_da4Bo ds8_da4Bp ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4UO eta_X3X of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ds4_da4Bl of {
        Nothing ->
          case writeMutVar#
                 @ RealWorld
                 @ (dec_state_aa47A, Buffer Word8)
                 dt1_da4UP
                 (GHC.IO.Handle.Internals.decodeByteBuf2 @ dec_state_aa47A,
                  ipv1_i7IAz)
                 ipv_i7IAy
          of s2#_i7IBe
          { __DEFAULT ->
          case GHC.IO.Encoding.Latin1.latin5 ipv1_i7IAz cbuf_aa3No s2#_i7IBe
          of
          { (# ipv2_ia4Z6, ipv3_ia4Z7 #) ->
          case ipv3_ia4Z7 of { (_why_ia4Zb, input'_ia4Zc, output'_ia4Zd) ->
          case writeMutVar#
                 @ RealWorld @ (Buffer Word8) dt_da4UO input'_ia4Zc ipv2_ia4Z6
          of s2#1_X7IEx
          { __DEFAULT ->
          (# s2#1_X7IEx, output'_ia4Zd #)
          }
          }
          }
          };
        Just decoder_aa3Nq ->
          case decoder_aa3Nq of
          { BufferCodec ds10_ia4Aw ds11_ia4Ax ds12_ia4Ay ds13_ia4Az
                        ds14_ia4AA ->
          case (ds13_ia4Az
                `cast` (GHC.Types.N:IO[0] <dec_state_aa47A>_R
                        :: (IO dec_state_aa47A :: *)
                           ~R# (State# RealWorld
                                -> (# State# RealWorld, dec_state_aa47A #) :: *)))
                 ipv_i7IAy
          of
          { (# ipv2_X7ICV, ipv3_X7ICX #) ->
          case writeMutVar#
                 @ RealWorld
                 @ (dec_state_aa47A, Buffer Word8)
                 dt1_da4UP
                 (ipv3_X7ICX, ipv1_i7IAz)
                 ipv2_X7ICV
          of s2#_i7IBe
          { __DEFAULT ->
          case GHC.IO.Handle.Internals.$wstreamEncode
                 @ Word8
                 @ CharBufElem
                 @ dec_state_aa47A
                 ds10_ia4Aw
                 ds11_ia4Ax
                 ipv1_i7IAz
                 cbuf_aa3No
                 s2#_i7IBe
          of
          { (# ipv4_X7IHV, ipv5_X7IHY #) ->
          case ipv5_X7IHY of { (bbuf2_aa3Ns, cbuf'_aa3Nt) ->
          case writeMutVar#
                 @ RealWorld @ (Buffer Word8) dt_da4UO bbuf2_aa3Ns ipv4_X7IHV
          of s2#1_X7IEJ
          { __DEFAULT ->
          (# s2#1_X7IEJ, cbuf'_aa3Nt #)
          }
          }
          }
          }
          }
          }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
decodeByteBuf :: Handle__ -> CharBuffer -> IO CharBuffer
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.decodeByteBuf1
               `cast` (<Handle__>_R
                       ->_R <CharBuffer>_R
                       ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
                       :: (Handle__
                           -> CharBuffer
                           -> State# RealWorld
                           -> (# State# RealWorld, CharBuffer #) :: *)
                          ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))}]
decodeByteBuf
  = GHC.IO.Handle.Internals.decodeByteBuf1
    `cast` (<Handle__>_R
            ->_R <CharBuffer>_R
            ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
            :: (Handle__
                -> CharBuffer
                -> State# RealWorld
                -> (# State# RealWorld, CharBuffer #) :: *)
               ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))

-- RHS size: {terms: 52, types: 125, coercions: 6, joins: 0/0}
GHC.IO.Handle.Internals.readTextDeviceNonBlocking1
  :: Handle__
     -> CharBuffer
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0 0] 199 0}]
GHC.IO.Handle.Internals.readTextDeviceNonBlocking1
  = \ (h__aa3MS :: Handle__)
      (cbuf_aa3N6 :: CharBuffer)
      (eta_X3Z :: State# RealWorld) ->
      case h__aa3MS of wild_X1G
      { Handle__ @ dev_aa4ab @ enc_state_aa4ac @ dec_state_aa4ad
                 $dIODevice_aa4ae $dBufferedIO_aa4af $dTypeable_aa4ag ds_da4Cc
                 ds1_da4Cd dt_da4US ds2_da4Cf dt1_da4UT dt2_da4UU dt3_da4UV
                 ds3_da4Cj ds4_da4Ck ds5_da4Cl ds6_da4Cm ds7_da4Cn ds8_da4Co ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4US eta_X3Z of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_ia4we
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT ->
          GHC.IO.Handle.Internals.decodeByteBuf1
            wild_X1G cbuf_aa3N6 ipv_i7IAy;
        1# ->
          case ((Buffered.fillReadBuffer0
                   @ dev_aa4ab $dBufferedIO_aa4af ds_da4Cc wild1_ia4we)
                `cast` (GHC.Types.N:IO[0] <(Maybe Int, Buffer Word8)>_R
                        :: (IO (Maybe Int, Buffer Word8) :: *)
                           ~R# (State# RealWorld
                                -> (# State# RealWorld, (Maybe Int, Buffer Word8) #) :: *)))
                 ipv_i7IAy
          of
          { (# ipv2_X7ICS, ipv3_X7ICU #) ->
          case ipv3_X7ICU of { (r_aa3N8, bbuf1_aa3N9) ->
          case r_aa3N8 of {
            Nothing ->
              case raiseIO#
                     @ SomeException
                     @ ()
                     GHC.IO.Handle.Internals.hLookAhead_3
                     ipv2_X7ICS
              of wild4_00 {
              };
            Just ipv4_ia5sh ->
              case writeMutVar#
                     @ RealWorld @ (Buffer Word8) dt_da4US bbuf1_aa3N9 ipv2_X7ICS
              of s2#_i7IBe
              { __DEFAULT ->
              GHC.IO.Handle.Internals.decodeByteBuf1
                wild_X1G cbuf_aa3N6 s2#_i7IBe
              }
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
readTextDeviceNonBlocking
  :: Handle__ -> CharBuffer -> IO CharBuffer
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.readTextDeviceNonBlocking1
               `cast` (<Handle__>_R
                       ->_R <CharBuffer>_R
                       ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
                       :: (Handle__
                           -> CharBuffer
                           -> State# RealWorld
                           -> (# State# RealWorld, CharBuffer #) :: *)
                          ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))}]
readTextDeviceNonBlocking
  = GHC.IO.Handle.Internals.readTextDeviceNonBlocking1
    `cast` (<Handle__>_R
            ->_R <CharBuffer>_R
            ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
            :: (Handle__
                -> CharBuffer
                -> State# RealWorld
                -> (# State# RealWorld, CharBuffer #) :: *)
               ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))

-- RHS size: {terms: 207, types: 316, coercions: 13, joins: 0/0}
GHC.IO.Handle.Internals.wantReadableHandle2
  :: forall a.
     (Handle__ -> IO a)
     -> Handle__ -> State# RealWorld -> (# State# RealWorld, a #)
[GblId,
 Arity=3,
 Str=<L,1*C1(C1(U(U,U)))><S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [60 20 0] 480 0}]
GHC.IO.Handle.Internals.wantReadableHandle2
  = \ (@ a_aa4bf)
      (act_aa3Hy :: Handle__ -> IO a_aa4bf)
      (h__aa3Hz :: Handle__)
      (eta_X42 :: State# RealWorld) ->
      case h__aa3Hz of wild_X1I
      { Handle__ @ dev_aa4bh @ enc_state_aa4bi @ dec_state_aa4bj
                 $dIODevice_aa4bk $dBufferedIO_aa4bl $dTypeable_aa4bm ds_da4EC
                 ds1_da4ED dt_da4V0 ds2_da4EF dt1_da4V1 dt2_da4V2 dt3_da4V3
                 ds3_da4EJ ds4_da4EK ds5_da4EL ds6_da4EM ds7_da4EN ds8_da4EO ->
      case ds1_da4ED of {
        ClosedHandle ->
          raiseIO#
            @ SomeException
            @ a_aa4bf
            GHC.IO.Handle.Internals.wantReadableHandle11
            eta_X42;
        SemiClosedHandle ->
          raiseIO#
            @ SomeException
            @ a_aa4bf
            GHC.IO.Handle.Internals.wantReadableHandle7
            eta_X42;
        ReadHandle ->
          ((act_aa3Hy wild_X1I)
           `cast` (GHC.Types.N:IO[0] <a_aa4bf>_R
                   :: (IO a_aa4bf :: *)
                      ~R# (State# RealWorld -> (# State# RealWorld, a_aa4bf #) :: *)))
            eta_X42;
        WriteHandle ->
          raiseIO#
            @ SomeException
            @ a_aa4bf
            GHC.IO.Handle.Internals.wantReadableHandle3
            eta_X42;
        AppendHandle ->
          raiseIO#
            @ SomeException
            @ a_aa4bf
            GHC.IO.Handle.Internals.wantReadableHandle3
            eta_X42;
        ReadWriteHandle ->
          case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4V0 eta_X42 of
          { (# ipv_i7IAy, ipv1_i7IAz #) ->
          case ipv1_i7IAz of
          { Buffer dt4_ia4xp dt5_ia4xq ds10_ia4xr dt6_ia4xs dt7_ia4xt
                   dt8_ia4xu ->
          case ds10_ia4xr of {
            ReadBuffer ->
              ((act_aa3Hy wild_X1I)
               `cast` (GHC.Types.N:IO[0] <a_aa4bf>_R
                       :: (IO a_aa4bf :: *)
                          ~R# (State# RealWorld -> (# State# RealWorld, a_aa4bf #) :: *)))
                ipv_i7IAy;
            WriteBuffer ->
              case ==# dt7_ia4xt dt8_ia4xu of {
                __DEFAULT ->
                  case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4V0 ipv_i7IAy of
                  { (# ipv2_X7IFO, ipv3_X7IFQ #) ->
                  case ipv3_X7IFQ of wild4_ia4we
                  { Buffer dt9_ia4wr dt10_ia4ws ds12_ia4wz dt11_ia4wA dt12_Xa4C0
                           dt13_Xa4C2 ->
                  case ==# dt12_Xa4C0 dt13_Xa4C2 of {
                    __DEFAULT ->
                      case ((Buffered.flushWriteBuffer
                               @ dev_aa4bh $dBufferedIO_aa4bl ds_da4EC wild4_ia4we)
                            `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                    :: (IO (Buffer Word8) :: *)
                                       ~R# (State# RealWorld
                                            -> (# State# RealWorld, Buffer Word8 #) :: *)))
                             ipv2_X7IFO
                      of
                      { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
                      case writeMutVar#
                             @ RealWorld @ (Buffer Word8) dt_da4V0 ipv5_X7ICQ ipv4_X7ICO
                      of s2#_i7IBe
                      { __DEFAULT ->
                      case readMutVar#
                             @ RealWorld @ (Buffer CharBufElem) dt2_da4V2 s2#_i7IBe
                      of
                      { (# ipv6_X7ID7, ipv7_X7ID9 #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer CharBufElem)
                             dt2_da4V2
                             (case ipv7_X7ID9 of
                              { Buffer dt14_da4V4 dt15_da4V5 ds15_da4Dy dt16_da4V6 dt17_da4V7
                                       dt18_da4V8 ->
                              GHC.IO.Buffer.Buffer
                                @ CharBufElem
                                dt14_da4V4
                                dt15_da4V5
                                GHC.IO.Buffer.ReadBuffer
                                dt16_da4V6
                                dt17_da4V7
                                dt18_da4V8
                              })
                             ipv6_X7ID7
                      of s2#1_X7IF7
                      { __DEFAULT ->
                      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4V0 s2#1_X7IF7
                      of
                      { (# ipv8_X7IDl, ipv9_X7IDn #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer Word8)
                             dt_da4V0
                             (case ipv9_X7IDn of
                              { Buffer dt14_da4V9 dt15_da4Va ds16_da4DN dt16_da4Vb dt17_da4Vc
                                       dt18_da4Vd ->
                              GHC.IO.Buffer.Buffer
                                @ Word8
                                dt14_da4V9
                                dt15_da4Va
                                GHC.IO.Buffer.ReadBuffer
                                dt16_da4Vb
                                dt17_da4Vc
                                dt18_da4Vd
                              })
                             ipv8_X7IDl
                      of s2#2_X7IGD
                      { __DEFAULT ->
                      ((act_aa3Hy wild_X1I)
                       `cast` (GHC.Types.N:IO[0] <a_aa4bf>_R
                               :: (IO a_aa4bf :: *)
                                  ~R# (State# RealWorld -> (# State# RealWorld, a_aa4bf #) :: *)))
                        s2#2_X7IGD
                      }
                      }
                      }
                      }
                      }
                      };
                    1# ->
                      case readMutVar#
                             @ RealWorld @ (Buffer CharBufElem) dt2_da4V2 ipv2_X7IFO
                      of
                      { (# ipv4_X7ID7, ipv5_X7ID9 #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer CharBufElem)
                             dt2_da4V2
                             (case ipv5_X7ID9 of
                              { Buffer dt14_da4V4 dt15_da4V5 ds14_da4Dy dt16_da4V6 dt17_da4V7
                                       dt18_da4V8 ->
                              GHC.IO.Buffer.Buffer
                                @ CharBufElem
                                dt14_da4V4
                                dt15_da4V5
                                GHC.IO.Buffer.ReadBuffer
                                dt16_da4V6
                                dt17_da4V7
                                dt18_da4V8
                              })
                             ipv4_X7ID7
                      of s2#_i7IBe
                      { __DEFAULT ->
                      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4V0 s2#_i7IBe of
                      { (# ipv6_X7IDl, ipv7_X7IDn #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer Word8)
                             dt_da4V0
                             (case ipv7_X7IDn of
                              { Buffer dt14_da4V9 dt15_da4Va ds15_da4DN dt16_da4Vb dt17_da4Vc
                                       dt18_da4Vd ->
                              GHC.IO.Buffer.Buffer
                                @ Word8
                                dt14_da4V9
                                dt15_da4Va
                                GHC.IO.Buffer.ReadBuffer
                                dt16_da4Vb
                                dt17_da4Vc
                                dt18_da4Vd
                              })
                             ipv6_X7IDl
                      of s2#1_X7IGD
                      { __DEFAULT ->
                      ((act_aa3Hy wild_X1I)
                       `cast` (GHC.Types.N:IO[0] <a_aa4bf>_R
                               :: (IO a_aa4bf :: *)
                                  ~R# (State# RealWorld -> (# State# RealWorld, a_aa4bf #) :: *)))
                        s2#1_X7IGD
                      }
                      }
                      }
                      }
                  }
                  }
                  };
                1# ->
                  case readMutVar#
                         @ RealWorld @ (Buffer CharBufElem) dt2_da4V2 ipv_i7IAy
                  of
                  { (# ipv2_X7ID7, ipv3_X7ID9 #) ->
                  case writeMutVar#
                         @ RealWorld
                         @ (Buffer CharBufElem)
                         dt2_da4V2
                         (case ipv3_X7ID9 of
                          { Buffer dt9_da4V4 dt10_da4V5 ds12_da4Dy dt11_da4V6 dt12_da4V7
                                   dt13_da4V8 ->
                          GHC.IO.Buffer.Buffer
                            @ CharBufElem
                            dt9_da4V4
                            dt10_da4V5
                            GHC.IO.Buffer.ReadBuffer
                            dt11_da4V6
                            dt12_da4V7
                            dt13_da4V8
                          })
                         ipv2_X7ID7
                  of s2#_i7IBe
                  { __DEFAULT ->
                  case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4V0 s2#_i7IBe of
                  { (# ipv4_X7IDl, ipv5_X7IDn #) ->
                  case writeMutVar#
                         @ RealWorld
                         @ (Buffer Word8)
                         dt_da4V0
                         (case ipv5_X7IDn of
                          { Buffer dt9_da4V9 dt10_da4Va ds13_da4DN dt11_da4Vb dt12_da4Vc
                                   dt13_da4Vd ->
                          GHC.IO.Buffer.Buffer
                            @ Word8
                            dt9_da4V9
                            dt10_da4Va
                            GHC.IO.Buffer.ReadBuffer
                            dt11_da4Vb
                            dt12_da4Vc
                            dt13_da4Vd
                          })
                         ipv4_X7IDl
                  of s2#1_X7IGD
                  { __DEFAULT ->
                  ((act_aa3Hy wild_X1I)
                   `cast` (GHC.Types.N:IO[0] <a_aa4bf>_R
                           :: (IO a_aa4bf :: *)
                              ~R# (State# RealWorld -> (# State# RealWorld, a_aa4bf #) :: *)))
                    s2#1_X7IGD
                  }
                  }
                  }
                  }
              }
          }
          }
          }
      }
      }

-- RHS size: {terms: 2, types: 1, coercions: 0, joins: 0/0}
lvl8_ra7Po :: BufferMode
[GblId, Caf=NoCafRefs, Str=m3, Unf=OtherCon []]
lvl8_ra7Po
  = GHC.IO.Handle.Types.BlockBuffering (GHC.Base.Nothing @ Int)

-- RHS size: {terms: 260, types: 483, coercions: 41, joins: 3/4}
GHC.IO.Handle.Internals.mkDuplexHandle5
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev
     -> FilePath
     -> HandleType
     -> Bool
     -> Maybe TextEncoding
     -> NewlineMode
     -> Maybe HandleFinalizer
     -> Maybe (MVar Handle__)
     -> State# RealWorld
     -> (# State# RealWorld, Handle #)
[GblId,
 Arity=12,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><L,U><L,1*U><S,U><L,U(1*U,1*U)><L,1*U><L,U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Internals.mkDuplexHandle5
  = \ (@ dev_aa4hm)
      ($dIODevice_aa4ho :: IODevice dev_aa4hm)
      ($dBufferedIO_aa4hp :: BufferedIO dev_aa4hm)
      ($dTypeable_aa4hq :: Typeable dev_aa4hm)
      (dev1_aa3Kt :: dev_aa4hm)
      (filepath_aa3Ku :: FilePath)
      (ha_type_aa3Kv :: HandleType)
      (buffered_aa3Kw :: Bool)
      (mb_codec_aa3Kx :: Maybe TextEncoding)
      (nl_aa3Ky :: NewlineMode)
      (finalizer_aa3Kz :: Maybe HandleFinalizer)
      (other_side_aa3KA :: Maybe (MVar Handle__))
      (eta_X4d :: State# RealWorld) ->
      join {
        cont_sa5o3 [Dmd=<L,1*C1(C1(C1(U(U,U))))>]
          :: forall es ds.
             Maybe (TextEncoder es)
             -> Maybe (TextDecoder ds)
             -> State# RealWorld
             -> (# State# RealWorld, Handle #)
        [LclId[JoinId(5)], Arity=3, Str=<L,U><L,U><S,U>, Unf=OtherCon []]
        cont_sa5o3 (@ es_aa4hv)
                   (@ ds_aa4hw)
                   (mb_encoder_aa3KB [OS=OneShot] :: Maybe (TextEncoder es_aa4hv))
                   (mb_decoder_aa3KC [OS=OneShot] :: Maybe (TextDecoder ds_aa4hw))
                   (eta1_X2d [OS=OneShot] :: State# RealWorld)
          = let {
              buf_state_sa5o5 :: BufferState
              [LclId]
              buf_state_sa5o5
                = case ha_type_aa3Kv of {
                    __DEFAULT -> GHC.IO.Buffer.WriteBuffer;
                    ReadHandle -> GHC.IO.Buffer.ReadBuffer
                  } } in
            case ((Buffered.newBuffer
                     @ dev_aa4hm $dBufferedIO_aa4hp dev1_aa3Kt buf_state_sa5o5)
                  `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                          :: (IO (Buffer Word8) :: *)
                             ~R# (State# RealWorld
                                  -> (# State# RealWorld, Buffer Word8 #) :: *)))
                   eta1_X2d
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            case newMutVar# @ (Buffer Word8) @ RealWorld ipv1_i7IAz ipv_i7IAy
            of
            { (# ipv2_ia4ZV, ipv3_ia4ZW #) ->
            case newMutVar#
                   @ (ds_aa4hw, Buffer Word8)
                   @ RealWorld
                   (GHC.IO.Handle.Internals.decodeByteBuf2 @ ds_aa4hw, ipv1_i7IAz)
                   ipv2_ia4ZV
            of
            { (# ipv4_Xa54S, ipv5_Xa54U #) ->
            join {
              $w$j_sa73T [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(C1(C1(U(U,U))))>]
                :: State# RealWorld
                   -> IORef CharBuffer -> BufferMode -> (# State# RealWorld, Handle #)
              [LclId[JoinId(3)],
               Arity=3,
               Str=<S,U><L,1*U(U)><L,U>,
               Unf=OtherCon []]
              $w$j_sa73T (w_sa73M [OS=OneShot] :: State# RealWorld)
                         (ww_sa73Q [OS=OneShot] :: IORef CharBuffer)
                         (ww1_sa73R [OS=OneShot] :: BufferMode)
                = case newMutVar#
                         @ (BufferList CharBufElem)
                         @ RealWorld
                         (GHC.IO.Handle.Types.BufferListNil @ CharBufElem)
                         w_sa73M
                  of
                  { (# ipv6_Xa55a, ipv7_Xa55c #) ->
                  case newMVar# @ RealWorld @ Handle__ ipv6_Xa55a of
                  { (# ipv8_ia50l, ipv9_ia50m #) ->
                  case putMVar#
                         @ RealWorld
                         @ Handle__
                         ipv9_ia50m
                         (case dev1_aa3Kt of dt_Xa3GW { __DEFAULT ->
                          case ww_sa73Q
                               `cast` (GHC.IORef.N:IORef[0] <Buffer CharBufElem>_N
                                       :: (IORef (Buffer CharBufElem) :: *)
                                          ~R# (GHC.STRef.STRef RealWorld (Buffer CharBufElem) :: *))
                          of
                          { GHC.STRef.STRef dt2_ia3GY ->
                          GHC.IO.Handle.Types.Handle__
                            @ dev_aa4hm
                            @ es_aa4hv
                            @ ds_aa4hw
                            $dIODevice_aa4ho
                            $dBufferedIO_aa4hp
                            $dTypeable_aa4hq
                            dt_Xa3GW
                            ha_type_aa3Kv
                            ipv3_ia4ZW
                            ww1_sa73R
                            ipv5_Xa54U
                            dt2_ia3GY
                            ipv7_Xa55c
                            mb_encoder_aa3KB
                            mb_decoder_aa3KC
                            mb_codec_aa3Kx
                            (inputNL nl_aa3Ky)
                            (outputNL nl_aa3Ky)
                            other_side_aa3KA
                          }
                          })
                         ipv8_ia50l
                  of s2#_ia50o
                  { __DEFAULT ->
                  case finalizer_aa3Kz of {
                    Nothing ->
                      (# s2#_ia50o,
                         GHC.IO.Handle.Types.FileHandle filepath_aa3Ku ipv9_ia50m #);
                    Just finalizer1_aa3Ff ->
                      case mkWeak#
                             @ 'UnliftedRep
                             @ (MVar# RealWorld Handle__)
                             @ ()
                             @ ()
                             ipv9_ia50m
                             GHC.Tuple.()
                             ((finalizer1_aa3Ff
                                 filepath_aa3Ku (GHC.MVar.MVar @ Handle__ ipv9_ia50m))
                              `cast` (GHC.Types.N:IO[0] <()>_R
                                      :: (IO () :: *)
                                         ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                             s2#_ia50o
                      of
                      { (# ipv10_ia50D, ipv11_ia50E #) ->
                      (# ipv10_ia50D,
                         GHC.IO.Handle.Types.FileHandle filepath_aa3Ku ipv9_ia50m #)
                      }
                  }
                  }
                  }
                  } } in
            case buffered_aa3Kw of {
              False ->
                case newMutVar#
                       @ GHC.ForeignPtr.Finalizers
                       @ RealWorld
                       GHC.ForeignPtr.NoFinalizers
                       ipv4_Xa54S
                of
                { (# ipv6_ia4Xw, ipv7_ia4Xx #) ->
                case newPinnedByteArray# @ RealWorld 8192# ipv6_ia4Xw of
                { (# ipv8_ia4XB, ipv9_ia4XC #) ->
                case newMutVar#
                       @ CharBuffer
                       @ RealWorld
                       (GHC.IO.Buffer.Buffer
                          @ Char
                          (byteArrayContents#
                             (ipv9_ia4XC
                              `cast` (UnsafeCo representational (MutableByteArray#
                                                                   RealWorld) ByteArray#
                                      :: (MutableByteArray# RealWorld :: TYPE 'UnliftedRep)
                                         ~R# (ByteArray# :: TYPE 'UnliftedRep))))
                          (GHC.ForeignPtr.MallocPtr ipv9_ia4XC ipv7_ia4Xx)
                          buf_state_sa5o5
                          2048#
                          0#
                          0#)
                       ipv8_ia4XB
                of
                { (# ipv10_Xa55k, ipv11_Xa55m #) ->
                jump $w$j_sa73T
                  ipv10_Xa55k
                  ((GHC.STRef.STRef @ RealWorld @ CharBuffer ipv11_Xa55m)
                   `cast` (Sym (GHC.IORef.N:IORef[0]) <CharBuffer>_N
                           :: (GHC.STRef.STRef RealWorld CharBuffer :: *)
                              ~R# (IORef CharBuffer :: *)))
                  GHC.IO.Handle.Types.NoBuffering
                }
                }
                };
              True ->
                case newMutVar#
                       @ GHC.ForeignPtr.Finalizers
                       @ RealWorld
                       GHC.ForeignPtr.NoFinalizers
                       ipv4_Xa54S
                of
                { (# ipv6_ia4Xw, ipv7_ia4Xx #) ->
                case newPinnedByteArray# @ RealWorld 8192# ipv6_ia4Xw of
                { (# ipv8_ia4XB, ipv9_ia4XC #) ->
                case newMutVar#
                       @ CharBuffer
                       @ RealWorld
                       (GHC.IO.Buffer.Buffer
                          @ Char
                          (byteArrayContents#
                             (ipv9_ia4XC
                              `cast` (UnsafeCo representational (MutableByteArray#
                                                                   RealWorld) ByteArray#
                                      :: (MutableByteArray# RealWorld :: TYPE 'UnliftedRep)
                                         ~R# (ByteArray# :: TYPE 'UnliftedRep))))
                          (GHC.ForeignPtr.MallocPtr ipv9_ia4XC ipv7_ia4Xx)
                          buf_state_sa5o5
                          2048#
                          0#
                          0#)
                       ipv8_ia4XB
                of
                { (# ipv10_Xa55k, ipv11_Xa55m #) ->
                case ((IODevice.isTerminal @ dev_aa4hm $dIODevice_aa4ho dev1_aa3Kt)
                      `cast` (GHC.Types.N:IO[0] <Bool>_R
                              :: (IO Bool :: *)
                                 ~R# (State# RealWorld -> (# State# RealWorld, Bool #) :: *)))
                       ipv10_Xa55k
                of
                { (# ipv12_X7IDd, ipv13_X7IDf #) ->
                jump $w$j_sa73T
                  ipv12_X7IDd
                  ((GHC.STRef.STRef @ RealWorld @ CharBuffer ipv11_Xa55m)
                   `cast` (Sym (GHC.IORef.N:IORef[0]) <CharBuffer>_N
                           :: (GHC.STRef.STRef RealWorld CharBuffer :: *)
                              ~R# (IORef CharBuffer :: *)))
                  (case ipv13_X7IDf of {
                     False -> lvl8_ra7Po;
                     True -> GHC.IO.Handle.Types.LineBuffering
                   })
                }
                }
                }
                }
            }
            }
            }
            } } in
      case mb_codec_aa3Kx of {
        Nothing ->
          jump cont_sa5o3
            @ Any
            @ Any
            (GHC.Base.Nothing @ (TextEncoder Any))
            (GHC.Base.Nothing @ (TextDecoder Any))
            eta_X4d;
        Just ds_da4vR ->
          case ds_da4vR of
          { TextEncoding @ dstate_aa436 @ estate_aa437 ds1_da4vS ds2_da4vT
                         ds3_da4vU ->
          join {
            $j_sa5tj [Dmd=<L,1*C1(C1(U(U,U)))>]
              :: State# RealWorld
                 -> Maybe (TextDecoder dstate_aa436)
                 -> (# State# RealWorld, Handle #)
            [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U>, Unf=OtherCon []]
            $j_sa5tj (ipv_i7IAy [OS=OneShot] :: State# RealWorld)
                     (ipv1_i7IAz [OS=OneShot] :: Maybe (TextDecoder dstate_aa436))
              = case ha_type_aa3Kv of {
                  __DEFAULT ->
                    jump cont_sa5o3
                      @ estate_aa437
                      @ dstate_aa436
                      (GHC.Base.Nothing @ (TextEncoder estate_aa437))
                      ipv1_i7IAz
                      ipv_i7IAy;
                  WriteHandle ->
                    case (ds3_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    jump cont_sa5o3
                      @ estate_aa437
                      @ dstate_aa436
                      (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                      ipv1_i7IAz
                      ipv2_X7ICD
                    };
                  AppendHandle ->
                    case (ds3_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    jump cont_sa5o3
                      @ estate_aa437
                      @ dstate_aa436
                      (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                      ipv1_i7IAz
                      ipv2_X7ICD
                    };
                  ReadWriteHandle ->
                    case (ds3_da4vU
                          `cast` (GHC.Types.N:IO[0] <TextEncoder estate_aa437>_R
                                  :: (IO (TextEncoder estate_aa437) :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld,
                                                TextEncoder estate_aa437 #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7ICD, ipv3_X7ICF #) ->
                    jump cont_sa5o3
                      @ estate_aa437
                      @ dstate_aa436
                      (GHC.Base.Just @ (TextEncoder estate_aa437) ipv3_X7ICF)
                      ipv1_i7IAz
                      ipv2_X7ICD
                    }
                } } in
          case ha_type_aa3Kv of {
            __DEFAULT ->
              jump $j_sa5tj
                eta_X4d (GHC.Base.Nothing @ (TextDecoder dstate_aa436));
            ReadHandle ->
              case (ds2_da4vT
                    `cast` (GHC.Types.N:IO[0] <TextDecoder dstate_aa436>_R
                            :: (IO (TextDecoder dstate_aa436) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, TextDecoder dstate_aa436 #) :: *)))
                     eta_X4d
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              jump $j_sa5tj
                ipv_i7IAy (GHC.Base.Just @ (TextDecoder dstate_aa436) ipv1_i7IAz)
              };
            ReadWriteHandle ->
              case (ds2_da4vT
                    `cast` (GHC.Types.N:IO[0] <TextDecoder dstate_aa436>_R
                            :: (IO (TextDecoder dstate_aa436) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, TextDecoder dstate_aa436 #) :: *)))
                     eta_X4d
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              jump $j_sa5tj
                ipv_i7IAy (GHC.Base.Just @ (TextDecoder dstate_aa436) ipv1_i7IAz)
              }
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 37, joins: 0/0}
mkHandle
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev
     -> FilePath
     -> HandleType
     -> Bool
     -> Maybe TextEncoding
     -> NewlineMode
     -> Maybe HandleFinalizer
     -> Maybe (MVar Handle__)
     -> IO Handle
[GblId,
 Arity=12,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><L,U><L,1*U><S,U><L,U(1*U,1*U)><L,1*U><L,U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.mkDuplexHandle5
               `cast` (forall (dev :: <*>_N).
                       <IODevice dev>_R
                       ->_R <BufferedIO dev>_R
                       ->_R <Typeable dev>_R
                       ->_R <dev>_R
                       ->_R <FilePath>_R
                       ->_R <HandleType>_R
                       ->_R <Bool>_R
                       ->_R <Maybe TextEncoding>_R
                       ->_R <NewlineMode>_R
                       ->_R <Maybe HandleFinalizer>_R
                       ->_R <Maybe (MVar Handle__)>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
                       :: (forall dev.
                           (IODevice dev, BufferedIO dev, Typeable dev) =>
                           dev
                           -> FilePath
                           -> HandleType
                           -> Bool
                           -> Maybe TextEncoding
                           -> NewlineMode
                           -> Maybe HandleFinalizer
                           -> Maybe (MVar Handle__)
                           -> State# RealWorld
                           -> (# State# RealWorld, Handle #) :: *)
                          ~R# (forall dev.
                               (IODevice dev, BufferedIO dev, Typeable dev) =>
                               dev
                               -> FilePath
                               -> HandleType
                               -> Bool
                               -> Maybe TextEncoding
                               -> NewlineMode
                               -> Maybe HandleFinalizer
                               -> Maybe (MVar Handle__)
                               -> IO Handle :: *))}]
mkHandle
  = GHC.IO.Handle.Internals.mkDuplexHandle5
    `cast` (forall (dev :: <*>_N).
            <IODevice dev>_R
            ->_R <BufferedIO dev>_R
            ->_R <Typeable dev>_R
            ->_R <dev>_R
            ->_R <FilePath>_R
            ->_R <HandleType>_R
            ->_R <Bool>_R
            ->_R <Maybe TextEncoding>_R
            ->_R <NewlineMode>_R
            ->_R <Maybe HandleFinalizer>_R
            ->_R <Maybe (MVar Handle__)>_R
            ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
            :: (forall dev.
                (IODevice dev, BufferedIO dev, Typeable dev) =>
                dev
                -> FilePath
                -> HandleType
                -> Bool
                -> Maybe TextEncoding
                -> NewlineMode
                -> Maybe HandleFinalizer
                -> Maybe (MVar Handle__)
                -> State# RealWorld
                -> (# State# RealWorld, Handle #) :: *)
               ~R# (forall dev.
                    (IODevice dev, BufferedIO dev, Typeable dev) =>
                    dev
                    -> FilePath
                    -> HandleType
                    -> Bool
                    -> Maybe TextEncoding
                    -> NewlineMode
                    -> Maybe HandleFinalizer
                    -> Maybe (MVar Handle__)
                    -> IO Handle :: *))

-- RHS size: {terms: 5, types: 10, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.debugIO1
  :: String -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<L,A><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=True)
         Tmpl= \ _ [Occ=Dead] (s1_i7IAV [Occ=Once] :: State# RealWorld) ->
                 (# s1_i7IAV, GHC.Tuple.() #)}]
GHC.IO.Handle.Internals.debugIO1
  = \ _ [Occ=Dead] (s1_i7IAV :: State# RealWorld) ->
      (# s1_i7IAV, GHC.Tuple.() #)

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
debugIO :: String -> IO ()
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<L,A><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.debugIO1
               `cast` (<String>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (String -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (String -> IO () :: *))}]
debugIO
  = GHC.IO.Handle.Internals.debugIO1
    `cast` (<String>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (String -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (String -> IO () :: *))

Rec {
-- RHS size: {terms: 251, types: 319, coercions: 3, joins: 3/4}
GHC.IO.Handle.Internals.$wwriteCharBuffer [InlPrag=NOUSERINLINE[0],
                                           Occ=LoopBreaker]
  :: Handle__
     -> Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> BufferState
     -> Int#
     -> Int#
     -> Int#
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=8,
 Caf=NoCafRefs,
 Str=<S,1*U><L,U><L,U><L,U><L,U><L,U><L,U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Internals.$wwriteCharBuffer
  = \ (w_sa74v :: Handle__)
      (ww_sa74A :: Addr#)
      (ww1_sa74B :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sa74C :: BufferState)
      (ww3_sa74D :: Int#)
      (ww4_sa74E :: Int#)
      (ww5_sa74F :: Int#)
      (w1_sa74x :: State# RealWorld) ->
      case w_sa74v of wild_X1M
      { Handle__ @ dev_aa4jB @ enc_state_aa4jC @ dec_state_aa4jD
                 $dIODevice_aa4jE $dBufferedIO_aa4jF $dTypeable_aa4jG ds_da4Lo
                 ds1_da4Lp dt_da4Vy ds2_da4Lr dt1_da4Vz dt2_da4VA dt3_da4VB
                 ds3_da4Lv ds4_da4Lw ds5_da4Lx ds6_da4Ly ds7_da4Lz ds8_da4LA ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4Vy w1_sa74x of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      join {
        $w$j_sa74u [InlPrag=NOUSERINLINE[0],
                    Dmd=<L,1*C1(C1(C1(C1(C1(C1(C1(C1(U(U,U)))))))))>]
          :: State# RealWorld
             -> CharBuffer
             -> Addr#
             -> GHC.ForeignPtr.ForeignPtrContents
             -> BufferState
             -> Int#
             -> Int#
             -> Int#
             -> (# State# RealWorld, () #)
        [LclId[JoinId(8)],
         Arity=8,
         Str=<S,U><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><S,U><L,U><S,U>,
         Unf=OtherCon []]
        $w$j_sa74u (w2_sa74e [OS=OneShot] :: State# RealWorld)
                   (ww6_sa74i [OS=OneShot] :: CharBuffer)
                   (ww7_sa74m [OS=OneShot] :: Addr#)
                   (ww8_sa74n [OS=OneShot] :: GHC.ForeignPtr.ForeignPtrContents)
                   (ww9_sa74o [OS=OneShot] :: BufferState)
                   (ww10_sa74p [OS=OneShot] :: Int#)
                   (ww11_sa74q [OS=OneShot] :: Int#)
                   (ww12_sa74r [OS=OneShot] :: Int#)
          = let {
              wild1_ia4Kf :: Buffer Word8
              [LclId, Unf=OtherCon []]
              wild1_ia4Kf
                = GHC.IO.Buffer.Buffer
                    @ Word8
                    ww7_sa74m
                    ww8_sa74n
                    ww9_sa74o
                    ww10_sa74p
                    ww11_sa74q
                    ww12_sa74r } in
            join {
              $j_sa5tA [Dmd=<L,1*U(U,U)>] :: (# State# RealWorld, () #)
              [LclId[JoinId(0)]]
              $j_sa5tA
                = case ((Buffered.flushWriteBuffer
                           @ dev_aa4jB $dBufferedIO_aa4jF ds_da4Lo wild1_ia4Kf)
                        `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                :: (IO (Buffer Word8) :: *)
                                   ~R# (State# RealWorld
                                        -> (# State# RealWorld, Buffer Word8 #) :: *)))
                         w2_sa74e
                  of
                  { (# ipv2_X7IDm, ipv3_X7IDo #) ->
                  case writeMutVar#
                         @ RealWorld @ (Buffer Word8) dt_da4Vy ipv3_X7IDo ipv2_X7IDm
                  of s2#_i7IBe
                  { __DEFAULT ->
                  case ww6_sa74i of
                  { Buffer dt4_ia4wr dt5_ia4ws ds11_ia4wz dt6_ia4wA dt7_ia4wB
                           dt8_ia4wC ->
                  case ==# dt7_ia4wB dt8_ia4wC of {
                    __DEFAULT ->
                      GHC.IO.Handle.Internals.$wwriteCharBuffer
                        wild_X1M
                        dt4_ia4wr
                        dt5_ia4ws
                        ds11_ia4wz
                        dt6_ia4wA
                        dt7_ia4wB
                        dt8_ia4wC
                        s2#_i7IBe;
                    1# -> (# s2#_i7IBe, GHC.Tuple.() #)
                  }
                  }
                  }
                  } } in
            case ==# ww10_sa74p ww12_sa74r of {
              __DEFAULT ->
                case ww6_sa74i of
                { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
                         dt8_ia4wC ->
                join {
                  $j1_sa5tG [Dmd=<L,1*U(U,U)>] :: (# State# RealWorld, () #)
                  [LclId[JoinId(0)]]
                  $j1_sa5tG
                    = case ds2_da4Lr of {
                        NoBuffering -> jump $j_sa5tA;
                        LineBuffering ->
                          case writeMutVar#
                                 @ RealWorld @ (Buffer Word8) dt_da4Vy wild1_ia4Kf w2_sa74e
                          of s2#_i7IBe
                          { __DEFAULT ->
                          case ==# dt7_ia4wB dt8_ia4wC of {
                            __DEFAULT ->
                              GHC.IO.Handle.Internals.$wwriteCharBuffer
                                wild_X1M
                                dt4_ia4wr
                                dt5_ia4ws
                                ds10_ia4wz
                                dt6_ia4wA
                                dt7_ia4wB
                                dt8_ia4wC
                                s2#_i7IBe;
                            1# -> (# s2#_i7IBe, GHC.Tuple.() #)
                          }
                          };
                        BlockBuffering ds11_da4KI ->
                          case ds11_da4KI of {
                            Nothing ->
                              case writeMutVar#
                                     @ RealWorld @ (Buffer Word8) dt_da4Vy wild1_ia4Kf w2_sa74e
                              of s2#_i7IBe
                              { __DEFAULT ->
                              case ==# dt7_ia4wB dt8_ia4wC of {
                                __DEFAULT ->
                                  GHC.IO.Handle.Internals.$wwriteCharBuffer
                                    wild_X1M
                                    dt4_ia4wr
                                    dt5_ia4ws
                                    ds10_ia4wz
                                    dt6_ia4wA
                                    dt7_ia4wB
                                    dt8_ia4wC
                                    s2#_i7IBe;
                                1# -> (# s2#_i7IBe, GHC.Tuple.() #)
                              }
                              };
                            Just s_aa3JP ->
                              case s_aa3JP of { I# y_alN2 ->
                              case >=# (-# ww12_sa74r ww11_sa74q) y_alN2 of {
                                __DEFAULT ->
                                  case writeMutVar#
                                         @ RealWorld @ (Buffer Word8) dt_da4Vy wild1_ia4Kf w2_sa74e
                                  of s2#_i7IBe
                                  { __DEFAULT ->
                                  case ==# dt7_ia4wB dt8_ia4wC of {
                                    __DEFAULT ->
                                      GHC.IO.Handle.Internals.$wwriteCharBuffer
                                        wild_X1M
                                        dt4_ia4wr
                                        dt5_ia4ws
                                        ds10_ia4wz
                                        dt6_ia4wA
                                        dt7_ia4wB
                                        dt8_ia4wC
                                        s2#_i7IBe;
                                    1# -> (# s2#_i7IBe, GHC.Tuple.() #)
                                  }
                                  };
                                1# -> jump $j_sa5tA
                              }
                              }
                          }
                      } } in
                case ==# dt7_ia4wB dt8_ia4wC of {
                  __DEFAULT ->
                    case ==# dt7_ia4wB ww4_sa74E of {
                      __DEFAULT -> jump $j1_sa5tG;
                      1# -> jump $j_sa5tA
                    };
                  1# -> jump $j1_sa5tG
                }
                };
              1# -> jump $j_sa5tA
            } } in
      case ds3_da4Lv of {
        Nothing ->
          case GHC.IO.Encoding.Latin1.latin3
                 (GHC.IO.Buffer.Buffer
                    @ Char ww_sa74A ww1_sa74B ww2_sa74C ww3_sa74D ww4_sa74E ww5_sa74F)
                 ipv1_i7IAz
                 ipv_i7IAy
          of
          { (# ipv2_ia51a, ipv3_ia51b #) ->
          case ipv3_ia51b of { (_why_ia51f, input'_ia51g, output'_ia51h) ->
          case output'_ia51h of
          { Buffer ww7_sa74m ww8_sa74n ww9_sa74o ww10_sa74p ww11_sa74q
                   ww12_sa74r ->
          jump $w$j_sa74u
            ipv2_ia51a
            input'_ia51g
            ww7_sa74m
            ww8_sa74n
            ww9_sa74o
            ww10_sa74p
            ww11_sa74q
            ww12_sa74r
          }
          }
          };
        Just encoder_aa3JM ->
          case encoder_aa3JM of
          { BufferCodec ww7_sa73h ww8_sa73i ww9_sa73j ww10_sa73k
                        ww11_sa73l ->
          case GHC.IO.Handle.Internals.$wstreamEncode
                 @ CharBufElem
                 @ Word8
                 @ enc_state_aa4jC
                 ww7_sa73h
                 ww8_sa73i
                 (GHC.IO.Buffer.Buffer
                    @ Char ww_sa74A ww1_sa74B ww2_sa74C ww3_sa74D ww4_sa74E ww5_sa74F)
                 ipv1_i7IAz
                 ipv_i7IAy
          of
          { (# ipv2_X7ID5, ipv3_X7ID7 #) ->
          case ipv3_X7ID7 of { (ww13_sa74i, ww14_sa74j) ->
          case ww14_sa74j of
          { Buffer ww16_sa74m ww17_sa74n ww18_sa74o ww19_sa74p ww20_sa74q
                   ww21_sa74r ->
          jump $w$j_sa74u
            ipv2_X7ID5
            ww13_sa74i
            ww16_sa74m
            ww17_sa74n
            ww18_sa74o
            ww19_sa74p
            ww20_sa74q
            ww21_sa74r
          }
          }
          }
          }
      }
      }
      }
end Rec }

-- RHS size: {terms: 15, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.writeCharBuffer1 [InlPrag=NOUSERINLINE[0]]
  :: Handle__
     -> CharBuffer -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=3,
 Caf=NoCafRefs,
 Str=<S,1*U><S(SLLSSS),1*U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_sa74v [Occ=Once] :: Handle__)
                 (w1_sa74w [Occ=Once!] :: CharBuffer)
                 (w2_sa74x [Occ=Once] :: State# RealWorld) ->
                 case w1_sa74w of
                 { Buffer ww1_sa74A [Occ=Once] ww2_sa74B [Occ=Once]
                          ww3_sa74C [Occ=Once] ww4_sa74D [Occ=Once] ww5_sa74E [Occ=Once]
                          ww6_sa74F [Occ=Once] ->
                 GHC.IO.Handle.Internals.$wwriteCharBuffer
                   w_sa74v
                   ww1_sa74A
                   ww2_sa74B
                   ww3_sa74C
                   ww4_sa74D
                   ww5_sa74E
                   ww6_sa74F
                   w2_sa74x
                 }}]
GHC.IO.Handle.Internals.writeCharBuffer1
  = \ (w_sa74v :: Handle__)
      (w1_sa74w :: CharBuffer)
      (w2_sa74x :: State# RealWorld) ->
      case w1_sa74w of
      { Buffer ww1_sa74A ww2_sa74B ww3_sa74C ww4_sa74D ww5_sa74E
               ww6_sa74F ->
      GHC.IO.Handle.Internals.$wwriteCharBuffer
        w_sa74v
        ww1_sa74A
        ww2_sa74B
        ww3_sa74C
        ww4_sa74D
        ww5_sa74E
        ww6_sa74F
        w2_sa74x
      }

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
writeCharBuffer :: Handle__ -> CharBuffer -> IO ()
[GblId,
 Arity=3,
 Caf=NoCafRefs,
 Str=<S,1*U><S(SLLSSS),1*U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.writeCharBuffer1
               `cast` (<Handle__>_R
                       ->_R <CharBuffer>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> CharBuffer
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> CharBuffer -> IO () :: *))}]
writeCharBuffer
  = GHC.IO.Handle.Internals.writeCharBuffer1
    `cast` (<Handle__>_R
            ->_R <CharBuffer>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> CharBuffer
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> CharBuffer -> IO () :: *))

-- RHS size: {terms: 131, types: 277, coercions: 2, joins: 0/0}
GHC.IO.Handle.Internals.flushCharBuffer3
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 301 150}]
GHC.IO.Handle.Internals.flushCharBuffer3
  = \ (ds_da4LC :: Handle__) (eta_X49 :: State# RealWorld) ->
      case ds_da4LC of
      { Handle__ @ dev_aa4kN @ enc_state_aa4kO @ dec_state_aa4kP
                 $dIODevice_aa4kQ $dBufferedIO_aa4kR $dTypeable_aa4kS ds1_da4Nh
                 ds2_da4Ni dt_da4VC ds3_da4Nk dt1_da4VD dt2_da4VE dt3_da4VF
                 ds4_da4No ds5_da4Np ds6_da4Nq ds7_da4Nr ds8_da4Ns ds9_da4Nt ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_da4VE eta_X49
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer dt4_ia4xp dt5_ia4xq ds11_ia4xr dt6_ia4xs dt7_ia4xt
               dt8_ia4xu ->
      case ds11_ia4xr of {
        ReadBuffer ->
          case ==# dt7_ia4xt dt8_ia4xu of {
            __DEFAULT ->
              case readMutVar#
                     @ RealWorld @ (dec_state_aa4kP, Buffer Word8) dt1_da4VD ipv_i7IAy
              of
              { (# ipv2_X7ID4, ipv3_X7ID6 #) ->
              case ipv3_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
              case readMutVar#
                     @ RealWorld @ (Buffer CharBufElem) dt2_da4VE ipv2_X7ID4
              of
              { (# ipv4_X7IDi, ipv5_X7IDk #) ->
              case writeMutVar#
                     @ RealWorld
                     @ (Buffer CharBufElem)
                     dt2_da4VE
                     (case ipv5_X7IDk of
                      { Buffer dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI dt12_da4VJ
                               dt13_da4VK ->
                      GHC.IO.Buffer.Buffer
                        @ CharBufElem dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI 0# 0#
                      })
                     ipv4_X7IDi
              of s2#_i7IBe
              { __DEFAULT ->
              case ipv5_X7IDk of
              { Buffer dt9_ia4zH dt10_ia4zI ds14_ia4zJ dt11_ia4zK dt12_ia4zL
                       dt13_ia4zM ->
              case dt12_ia4zL of wild5_X3Y {
                __DEFAULT ->
                  case ds5_da4Np of {
                    Nothing ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer Word8)
                             dt_da4VC
                             (case bbuf0_aa3K7 of
                              { Buffer dt14_da4VL dt15_da4VM ds15_da4LW dt16_da4VN dt17_da4VO
                                       dt18_da4VP ->
                              GHC.IO.Buffer.Buffer
                                @ Word8
                                dt14_da4VL
                                dt15_da4VM
                                ds15_da4LW
                                dt16_da4VN
                                (+# dt17_da4VO wild5_X3Y)
                                dt18_da4VP
                              })
                             s2#_i7IBe
                      of s2#1_X7IH7
                      { __DEFAULT ->
                      (# s2#1_X7IH7, GHC.Tuple.() #)
                      };
                    Just decoder_aa3K9 ->
                      case decoder_aa3K9 of
                      { BufferCodec ds15_ia4Mf ds16_ia4Mg ds17_ia4Mh ds18_ia4Mi
                                    ds19_ia4Mj ->
                      case ((ds19_ia4Mj codec_state_aa3K6)
                            `cast` (GHC.Types.N:IO[0] <()>_R
                                    :: (IO () :: *)
                                       ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                             s2#_i7IBe
                      of
                      { (# ipv6_X7JlR, ipv7_X7JlT #) ->
                      case GHC.IO.Handle.Internals.$wstreamEncode
                             @ Word8
                             @ CharBufElem
                             @ dec_state_aa4kP
                             ds15_ia4Mf
                             ds16_ia4Mg
                             bbuf0_aa3K7
                             (GHC.IO.Buffer.Buffer
                                @ CharBufElem dt9_ia4zH dt10_ia4zI ds14_ia4zJ wild5_X3Y 0# 0#)
                             ipv6_X7JlR
                      of
                      { (# ipv8_X7IGW, ipv9_X7IDM #) ->
                      case ipv9_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                      case writeMutVar#
                             @ RealWorld @ (Buffer Word8) dt_da4VC bbuf1_aa3Ka ipv8_X7IGW
                      of s2#1_X7IHx
                      { __DEFAULT ->
                      (# s2#1_X7IHx, GHC.Tuple.() #)
                      }
                      }
                      }
                      }
                      }
                  };
                0# ->
                  case writeMutVar#
                         @ RealWorld @ (Buffer Word8) dt_da4VC bbuf0_aa3K7 s2#_i7IBe
                  of s2#1_X7IH3
                  { __DEFAULT ->
                  (# s2#1_X7IH3, GHC.Tuple.() #)
                  }
              }
              }
              }
              }
              }
              };
            1# -> (# ipv_i7IAy, GHC.Tuple.() #)
          };
        WriteBuffer -> (# ipv_i7IAy, GHC.Tuple.() #)
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushCharReadBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushCharBuffer3
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushCharReadBuffer
  = GHC.IO.Handle.Internals.flushCharBuffer3
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl9_ra7Pp :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl9_ra7Pp = "error"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl10_ra7Pq :: [Char]
[GblId]
lvl10_ra7Pq = unpackCString# lvl9_ra7Pp

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl11_ra7Pr :: [Char]
[GblId]
lvl11_ra7Pr = unpackCString# GHC.IO.Handle.Internals.$trModule4

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl12_ra7Ps :: [Char]
[GblId]
lvl12_ra7Ps = unpackCString# GHC.IO.Handle.Internals.$trModule2

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl13_ra7Pt :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl13_ra7Pt = "./GHC/IO/Handle/Internals.hs"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl14_ra7Pu :: [Char]
[GblId]
lvl14_ra7Pu = unpackCString# lvl13_ra7Pt

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl15_ra7Pv :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl15_ra7Pv = GHC.Types.I# 487#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl16_ra7Pw :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl16_ra7Pw = GHC.Types.I# 12#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl17_ra7Px :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl17_ra7Px = GHC.Types.I# 68#

-- RHS size: {terms: 8, types: 0, coercions: 0, joins: 0/0}
lvl18_ra7Py :: SrcLoc
[GblId, Str=m, Unf=OtherCon []]
lvl18_ra7Py
  = GHC.Stack.Types.SrcLoc
      lvl11_ra7Pr
      lvl12_ra7Ps
      lvl14_ra7Pu
      lvl15_ra7Pv
      lvl16_ra7Pw
      lvl15_ra7Pv
      lvl17_ra7Px

-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
lvl19_ra7Pz :: CallStack
[GblId, Str=m2, Unf=OtherCon []]
lvl19_ra7Pz
  = GHC.Stack.Types.PushCallStack
      lvl10_ra7Pq lvl18_ra7Py GHC.Stack.Types.EmptyCallStack

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl20_ra7PA :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl20_ra7PA = "internal IO library error: Char buffer non-empty"#

-- RHS size: {terms: 4, types: 3, coercions: 4, joins: 0/0}
GHC.IO.Handle.Internals.flushCharBuffer2 :: IO ()
[GblId, Str=x]
GHC.IO.Handle.Internals.flushCharBuffer2
  = error
      @ 'LiftedRep
      @ (IO ())
      (lvl19_ra7Pz
       `cast` (Sym (GHC.Classes.N:IP[0] <"callStack">_N <CallStack>_N)
               :: (CallStack :: *) ~R# (?callStack::CallStack :: Constraint)))
      (unpackCString# lvl20_ra7PA)

-- RHS size: {terms: 31, types: 87, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.flushCharBuffer1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (h__aa3IM [Occ=Once!] :: Handle__)
                 (eta_X4o [Occ=Once] :: State# RealWorld) ->
                 case h__aa3IM of wild_X1N
                 { Handle__ @ dev_aa4mt @ enc_state_aa4mu @ dec_state_aa4mv
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead]
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] dt2_da4VX [Occ=Once]
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead]
                            _ [Occ=Dead] _ [Occ=Dead] ->
                 case readMutVar#
                        @ RealWorld @ (Buffer CharBufElem) dt2_da4VX eta_X4o
                 of
                 { (# ipv_i7IAy [Occ=Once*], ipv1_i7IAz [Occ=Once!] #) ->
                 case ipv1_i7IAz of
                 { Buffer _ [Occ=Dead] _ [Occ=Dead] ds10_ia4NB [Occ=Once!]
                          _ [Occ=Dead] dt7_ia4ND [Occ=Once] dt8_ia4NE [Occ=Once] ->
                 case ds10_ia4NB of {
                   ReadBuffer ->
                     GHC.IO.Handle.Internals.flushCharBuffer3 wild_X1N ipv_i7IAy;
                   WriteBuffer ->
                     case ==# dt7_ia4ND dt8_ia4NE of {
                       __DEFAULT -> case GHC.IO.Handle.Internals.flushCharBuffer2 of { };
                       1# -> (# ipv_i7IAy, GHC.Tuple.() #)
                     }
                 }
                 }
                 }
                 }}]
GHC.IO.Handle.Internals.flushCharBuffer1
  = \ (h__aa3IM :: Handle__) (eta_X4o :: State# RealWorld) ->
      case h__aa3IM of wild_X1N
      { Handle__ @ dev_aa4mt @ enc_state_aa4mu @ dec_state_aa4mv
                 $dIODevice_aa4mw $dBufferedIO_aa4mx $dTypeable_aa4my ds_da4Ob
                 ds1_da4Oc dt_da4VV ds2_da4Oe dt1_da4VW dt2_da4VX dt3_da4VY
                 ds3_da4Oi ds4_da4Oj ds5_da4Ok ds6_da4Ol ds7_da4Om ds8_da4On ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_da4VX eta_X4o
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer dt4_ia4Nz dt5_ia4NA ds10_ia4NB dt6_ia4NC dt7_ia4ND
               dt8_ia4NE ->
      case ds10_ia4NB of {
        ReadBuffer ->
          GHC.IO.Handle.Internals.flushCharBuffer3 wild_X1N ipv_i7IAy;
        WriteBuffer ->
          case ==# dt7_ia4ND dt8_ia4NE of {
            __DEFAULT ->
              case GHC.IO.Handle.Internals.flushCharBuffer2 of wild3_00 { };
            1# -> (# ipv_i7IAy, GHC.Tuple.() #)
          }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushCharBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushCharBuffer1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushCharBuffer
  = GHC.IO.Handle.Internals.flushCharBuffer1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 62, types: 124, coercions: 4, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer2
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 221 60}]
GHC.IO.Handle.Internals.flushBuffer2
  = \ (h__aa3Kc :: Handle__) (eta_X4q :: State# RealWorld) ->
      case h__aa3Kc of
      { Handle__ @ dev_aa4mR @ enc_state_aa4mS @ dec_state_aa4mT
                 $dIODevice_aa4mU $dBufferedIO_aa4mV $dTypeable_aa4mW ds_da4Pj
                 ds1_da4Pk dt_da4VZ ds2_da4Pm dt1_da4W0 dt2_da4W1 dt3_da4W2
                 ds3_da4Pq ds4_da4Pr ds5_da4Ps ds6_da4Pt ds7_da4Pu ds8_da4Pv ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4VZ eta_X4q of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT ->
          case ((IODevice.isSeekable @ dev_aa4mR $dIODevice_aa4mU ds_da4Pj)
                `cast` (GHC.Types.N:IO[0] <Bool>_R
                        :: (IO Bool :: *)
                           ~R# (State# RealWorld -> (# State# RealWorld, Bool #) :: *)))
                 ipv_i7IAy
          of
          { (# ipv2_X7ID0, ipv3_X7ID2 #) ->
          case ipv3_X7ID2 of {
            False ->
              raiseIO#
                @ SomeException
                @ ()
                GHC.IO.Handle.Internals.flushBuffer3
                ipv2_X7ID0;
            True ->
              case ((IODevice.seek
                       @ dev_aa4mR
                       $dIODevice_aa4mU
                       ds_da4Pj
                       GHC.IO.Device.RelativeSeek
                       (integer-simple-0.1.1.1:GHC.Integer.Type.smallInteger
                          (negateInt# (-# dt8_ia4wC dt7_ia4wB))))
                    `cast` (GHC.Types.N:IO[0] <()>_R
                            :: (IO () :: *)
                               ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                     ipv2_X7ID0
              of
              { (# ipv4_X7Jlp, ipv5_X7Jlr #) ->
              case writeMutVar#
                     @ RealWorld
                     @ (Buffer Word8)
                     dt_da4VZ
                     (GHC.IO.Buffer.Buffer
                        @ Word8 dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA 0# 0#)
                     ipv4_X7Jlp
              of s2#_i7IBe
              { __DEFAULT ->
              (# s2#_i7IBe, GHC.Tuple.() #)
              }
              }
          }
          };
        1# -> (# ipv_i7IAy, GHC.Tuple.() #)
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushByteReadBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushBuffer2
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushByteReadBuffer
  = GHC.IO.Handle.Internals.flushBuffer2
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 176, types: 325, coercions: 5, joins: 0/0}
GHC.IO.Handle.Internals.flushBuffer1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 528 60}]
GHC.IO.Handle.Internals.flushBuffer1
  = \ (h__aa3Ix :: Handle__) (eta_X4s :: State# RealWorld) ->
      case h__aa3Ix of wild_X1P
      { Handle__ @ dev_aa4pd @ enc_state_aa4pe @ dec_state_aa4pf
                 $dIODevice_aa4pg $dBufferedIO_aa4ph $dTypeable_aa4pi ds_da4Rs
                 ds1_da4Rt dt_da4Wk ds2_da4Rv dt1_da4Wl dt2_da4Wm dt3_da4Wn
                 ds3_da4Rz ds4_da4RA ds5_da4RB ds6_da4RC ds7_da4RD ds8_da4RE ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_da4Wm eta_X4s
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer dt4_ia4Nz dt5_ia4NA ds10_ia4NB dt6_ia4NC dt7_ia4ND
               dt8_ia4NE ->
      case ds10_ia4NB of {
        ReadBuffer ->
          case readMutVar#
                 @ RealWorld @ (Buffer CharBufElem) dt2_da4Wm ipv_i7IAy
          of
          { (# ipv2_X7IE8, ipv3_X7IEa #) ->
          case ipv3_X7IEa of
          { Buffer dt9_ia4xp dt10_ia4xq ds12_ia4xr dt11_ia4xs dt12_ia4xt
                   dt13_ia4xu ->
          case ds12_ia4xr of {
            ReadBuffer ->
              case ==# dt12_ia4xt dt13_ia4xu of {
                __DEFAULT ->
                  case readMutVar#
                         @ RealWorld @ (dec_state_aa4pf, Buffer Word8) dt1_da4Wl ipv2_X7IE8
                  of
                  { (# ipv4_X7ID4, ipv5_X7ID6 #) ->
                  case ipv5_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
                  case readMutVar#
                         @ RealWorld @ (Buffer CharBufElem) dt2_da4Wm ipv4_X7ID4
                  of
                  { (# ipv6_X7IDi, ipv7_X7IDk #) ->
                  case writeMutVar#
                         @ RealWorld
                         @ (Buffer CharBufElem)
                         dt2_da4Wm
                         (case ipv7_X7IDk of
                          { Buffer dt14_da4VG dt15_da4VH ds15_da4LG dt16_da4VI dt17_da4VJ
                                   dt18_da4VK ->
                          GHC.IO.Buffer.Buffer
                            @ CharBufElem dt14_da4VG dt15_da4VH ds15_da4LG dt16_da4VI 0# 0#
                          })
                         ipv6_X7IDi
                  of s2#_i7IBe
                  { __DEFAULT ->
                  case ipv7_X7IDk of
                  { Buffer dt14_ia4zH dt15_ia4zI ds15_ia4zJ dt16_ia4zK dt17_ia4zL
                           dt18_ia4zM ->
                  case dt17_ia4zL of wild7_X4o {
                    __DEFAULT ->
                      case ds4_da4RA of {
                        Nothing ->
                          case writeMutVar#
                                 @ RealWorld
                                 @ (Buffer Word8)
                                 dt_da4Wk
                                 (case bbuf0_aa3K7 of
                                  { Buffer dt19_da4VL dt20_da4VM ds16_da4LW dt21_da4VN dt22_da4VO
                                           dt23_da4VP ->
                                  GHC.IO.Buffer.Buffer
                                    @ Word8
                                    dt19_da4VL
                                    dt20_da4VM
                                    ds16_da4LW
                                    dt21_da4VN
                                    (+# dt22_da4VO wild7_X4o)
                                    dt23_da4VP
                                  })
                                 s2#_i7IBe
                          of s2#1_X7IH7
                          { __DEFAULT ->
                          GHC.IO.Handle.Internals.flushBuffer2 wild_X1P s2#1_X7IH7
                          };
                        Just decoder_aa3K9 ->
                          case decoder_aa3K9 of
                          { BufferCodec ds16_ia4Mf ds17_ia4Mg ds18_ia4Mh ds19_ia4Mi
                                        ds20_ia4Mj ->
                          case ((ds20_ia4Mj codec_state_aa3K6)
                                `cast` (GHC.Types.N:IO[0] <()>_R
                                        :: (IO () :: *)
                                           ~R# (State# RealWorld
                                                -> (# State# RealWorld, () #) :: *)))
                                 s2#_i7IBe
                          of
                          { (# ipv8_X7JlR, ipv9_X7JlT #) ->
                          case GHC.IO.Handle.Internals.$wstreamEncode
                                 @ Word8
                                 @ CharBufElem
                                 @ dec_state_aa4pf
                                 ds16_ia4Mf
                                 ds17_ia4Mg
                                 bbuf0_aa3K7
                                 (GHC.IO.Buffer.Buffer
                                    @ CharBufElem dt14_ia4zH dt15_ia4zI ds15_ia4zJ wild7_X4o 0# 0#)
                                 ipv8_X7JlR
                          of
                          { (# ipv10_X7IGW, ipv11_X7IDM #) ->
                          case ipv11_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                          case writeMutVar#
                                 @ RealWorld @ (Buffer Word8) dt_da4Wk bbuf1_aa3Ka ipv10_X7IGW
                          of s2#1_X7IHx
                          { __DEFAULT ->
                          GHC.IO.Handle.Internals.flushBuffer2 wild_X1P s2#1_X7IHx
                          }
                          }
                          }
                          }
                          }
                      };
                    0# ->
                      case writeMutVar#
                             @ RealWorld @ (Buffer Word8) dt_da4Wk bbuf0_aa3K7 s2#_i7IBe
                      of s2#1_X7IH3
                      { __DEFAULT ->
                      GHC.IO.Handle.Internals.flushBuffer2 wild_X1P s2#1_X7IH3
                      }
                  }
                  }
                  }
                  }
                  }
                  };
                1# -> GHC.IO.Handle.Internals.flushBuffer2 wild_X1P ipv2_X7IE8
              };
            WriteBuffer ->
              GHC.IO.Handle.Internals.flushBuffer2 wild_X1P ipv2_X7IE8
          }
          }
          };
        WriteBuffer ->
          case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4Wk ipv_i7IAy of
          { (# ipv2_X7IG9, ipv3_X7IGb #) ->
          case ipv3_X7IGb of wild3_ia4we
          { Buffer dt9_ia4wr dt10_ia4ws ds12_ia4wz dt11_ia4wA dt12_ia4wB
                   dt13_ia4wC ->
          case ==# dt12_ia4wB dt13_ia4wC of {
            __DEFAULT ->
              case ((Buffered.flushWriteBuffer
                       @ dev_aa4pd $dBufferedIO_aa4ph ds_da4Rs wild3_ia4we)
                    `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                            :: (IO (Buffer Word8) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, Buffer Word8 #) :: *)))
                     ipv2_X7IG9
              of
              { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
              case writeMutVar#
                     @ RealWorld @ (Buffer Word8) dt_da4Wk ipv5_X7ICQ ipv4_X7ICO
              of s2#_i7IBe
              { __DEFAULT ->
              (# s2#_i7IBe, GHC.Tuple.() #)
              }
              };
            1# -> (# ipv2_X7IG9, GHC.Tuple.() #)
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
flushBuffer :: Handle__ -> IO ()
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.flushBuffer1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *))}]
flushBuffer
  = GHC.IO.Handle.Internals.flushBuffer1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle__ -> IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl21_ra7PB :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl21_ra7PB = "GHC/IO/Handle/Internals.hs:881:7-30|Just decoder"#

-- RHS size: {terms: 3, types: 6, coercions: 0, joins: 0/0}
lvl22_ra7PC :: forall dec_state. (TextDecoder dec_state)
[GblId, Str=x]
lvl22_ra7PC
  = \ (@ dec_state_aa4ra) ->
      Control.Exception.Base.patError
        @ 'LiftedRep @ (TextDecoder dec_state_aa4ra) lvl21_ra7PB

Rec {
-- RHS size: {terms: 165, types: 328, coercions: 7, joins: 1/1}
GHC.IO.Handle.Internals.hLookAhead_2
  :: Handle__
     -> CharBuffer
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 40 0] 641 0}]
GHC.IO.Handle.Internals.hLookAhead_2
  = \ (h__aa3M6 :: Handle__)
      (cbuf_aa3Mk :: CharBuffer)
      (eta_X4x :: State# RealWorld) ->
      case h__aa3M6 of wild_X1R
      { Handle__ @ dev_aa4px @ enc_state_aa4py @ dec_state_aa4pz
                 $dIODevice_aa4pA $dBufferedIO_aa4pB $dTypeable_aa4pC ds_da4So
                 ds1_da4Sp dt_da4Wo ds2_da4Sr dt1_da4Wp dt2_da4Wq dt3_da4Wr
                 ds3_da4Sv ds4_da4Sw ds5_da4Sx ds6_da4Sy ds7_da4Sz ds8_da4SA ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4Wo eta_X4x of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_ia4we
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      join {
        $j_sa5uX [Dmd=<L,1*C1(C1(U(U,U)))>]
          :: State# RealWorld
             -> Buffer Word8 -> (# State# RealWorld, CharBuffer #)
        [LclId[JoinId(2)],
         Arity=2,
         Str=<S,U><L,U(U,U,U,U,U,U)>,
         Unf=OtherCon []]
        $j_sa5uX (ipv2_X7ID2 [OS=OneShot] :: State# RealWorld)
                 (ipv3_X7ID4 [OS=OneShot] :: Buffer Word8)
          = case ds4_da4Sw of {
              Nothing ->
                case writeMutVar#
                       @ RealWorld
                       @ (dec_state_aa4pz, Buffer Word8)
                       dt1_da4Wp
                       (GHC.IO.Handle.Internals.decodeByteBuf2 @ dec_state_aa4pz,
                        ipv3_X7ID4)
                       ipv2_X7ID2
                of s2#_i7IBe
                { __DEFAULT ->
                case GHC.IO.Encoding.Latin1.latin5 ipv3_X7ID4 cbuf_aa3Mk s2#_i7IBe
                of
                { (# ipv4_ia4Z6, ipv5_ia4Z7 #) ->
                case ipv5_ia4Z7 of { (_why_ia4Zb, input'_ia4Zc, output'_ia4Zd) ->
                case writeMutVar#
                       @ RealWorld @ (Buffer Word8) dt_da4Wo input'_ia4Zc ipv4_ia4Z6
                of s2#1_X7IFc
                { __DEFAULT ->
                case output'_ia4Zd of wild4_ia4OH
                { Buffer dt9_ia4OJ dt10_ia4OK ds12_ia4OL dt11_ia4OM dt12_ia4ON
                         dt13_ia4OO ->
                case cbuf_aa3Mk of wild5_Xa4UH
                { Buffer dt14_Xa4UL dt15_Xa4UN ds13_Xa4UP dt16_Xa4UR dt17_Xa4UT
                         dt18_Xa4UV ->
                case ==# dt13_ia4OO dt18_Xa4UV of {
                  __DEFAULT -> (# s2#1_X7IFc, wild4_ia4OH #);
                  1# ->
                    case input'_ia4Zc of
                    { Buffer ww1_sa74Z ww2_sa750 ww3_sa751 ww4_sa752 ww5_sa753
                             ww6_sa754 ->
                    GHC.IO.Handle.Internals.$wreadTextDevice'
                      wild_X1R
                      ww1_sa74Z
                      ww2_sa750
                      ww3_sa751
                      ww4_sa752
                      ww5_sa753
                      ww6_sa754
                      wild5_Xa4UH
                      s2#1_X7IFc
                    }
                }
                }
                }
                }
                }
                }
                };
              Just decoder_aa3Mp ->
                case decoder_aa3Mp of
                { BufferCodec ds11_ia4Aw ds12_ia4Ax ds13_ia4Ay ds14_ia4Az
                              ds15_ia4AA ->
                case (ds14_ia4Az
                      `cast` (GHC.Types.N:IO[0] <dec_state_aa4pz>_R
                              :: (IO dec_state_aa4pz :: *)
                                 ~R# (State# RealWorld
                                      -> (# State# RealWorld, dec_state_aa4pz #) :: *)))
                       ipv2_X7ID2
                of
                { (# ipv4_X7IDf, ipv5_X7IDh #) ->
                case writeMutVar#
                       @ RealWorld
                       @ (dec_state_aa4pz, Buffer Word8)
                       dt1_da4Wp
                       (ipv5_X7IDh, ipv3_X7ID4)
                       ipv4_X7IDf
                of s2#_i7IBe
                { __DEFAULT ->
                case GHC.IO.Handle.Internals.$wstreamEncode
                       @ Word8
                       @ CharBufElem
                       @ dec_state_aa4pz
                       ds11_ia4Aw
                       ds12_ia4Ax
                       ipv3_X7ID4
                       cbuf_aa3Mk
                       s2#_i7IBe
                of
                { (# ipv6_X7IJc, ipv7_X7IJf #) ->
                case ipv7_X7IJf of { (bbuf2_aa3Mr, cbuf'_aa3Ms) ->
                case writeMutVar#
                       @ RealWorld @ (Buffer Word8) dt_da4Wo bbuf2_aa3Mr ipv6_X7IJc
                of s2#1_X7IFh
                { __DEFAULT ->
                case cbuf'_aa3Ms of wild5_ia4OH
                { Buffer dt9_ia4OJ dt10_ia4OK ds18_ia4OL dt11_ia4OM dt12_ia4ON
                         dt13_ia4OO ->
                case cbuf_aa3Mk of wild6_Xa4UH
                { Buffer dt14_Xa4UL dt15_Xa4UN ds19_Xa4UP dt16_Xa4UR dt17_Xa4UT
                         dt18_Xa4UV ->
                case ==# dt13_ia4OO dt18_Xa4UV of {
                  __DEFAULT -> (# s2#1_X7IFh, wild5_ia4OH #);
                  1# ->
                    case bbuf2_aa3Mr of
                    { Buffer ww1_sa74Z ww2_sa750 ww3_sa751 ww4_sa752 ww5_sa753
                             ww6_sa754 ->
                    GHC.IO.Handle.Internals.$wreadTextDevice'
                      wild_X1R
                      ww1_sa74Z
                      ww2_sa750
                      ww3_sa751
                      ww4_sa752
                      ww5_sa753
                      ww6_sa754
                      wild6_Xa4UH
                      s2#1_X7IFh
                    }
                }
                }
                }
                }
                }
                }
                }
                }
                }
            } } in
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT -> jump $j_sa5uX ipv_i7IAy wild1_ia4we;
        1# ->
          case ((Buffered.fillReadBuffer
                   @ dev_aa4px $dBufferedIO_aa4pB ds_da4So wild1_ia4we)
                `cast` (GHC.Types.N:IO[0] <(Int, Buffer Word8)>_R
                        :: (IO (Int, Buffer Word8) :: *)
                           ~R# (State# RealWorld
                                -> (# State# RealWorld, (Int, Buffer Word8) #) :: *)))
                 ipv_i7IAy
          of
          { (# ipv2_X7ID6, ipv3_X7ID8 #) ->
          case ipv3_X7ID8 of { (r_aa3Mm, bbuf1_aa3Mn) ->
          case r_aa3Mm of { I# x_a22G ->
          case x_a22G of {
            __DEFAULT -> jump $j_sa5uX ipv2_X7ID6 bbuf1_aa3Mn;
            0# ->
              case raiseIO#
                     @ SomeException
                     @ (Buffer Word8)
                     GHC.IO.Handle.Internals.hLookAhead_3
                     ipv2_X7ID6
              of wild5_00 {
              }
          }
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 175, types: 331, coercions: 13, joins: 0/1}
GHC.IO.Handle.Internals.$wreadTextDevice' [InlPrag=NOUSERINLINE[0],
                                           Occ=LoopBreaker]
  :: Handle__
     -> Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> BufferState
     -> Int#
     -> Int#
     -> Int#
     -> CharBuffer
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=9,
 Str=<S,1*U><S,U><L,U><L,U><L,U><S,U><S,U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Internals.$wreadTextDevice'
  = \ (w_sa74T :: Handle__)
      (ww_sa74Z :: Addr#)
      (ww1_sa750 :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sa751 :: BufferState)
      (ww3_sa752 :: Int#)
      (ww4_sa753 :: Int#)
      (ww5_sa754 :: Int#)
      (w1_sa74V :: CharBuffer)
      (w2_sa74W :: State# RealWorld) ->
      case w_sa74T of wild_X1T
      { Handle__ @ dev_aa4r8 @ enc_state_aa4r9 @ dec_state_aa4ra
                 $dIODevice_aa4rb $dBufferedIO_aa4rc $dTypeable_aa4rd ds_da4Ts
                 ds1_da4Tt dt_da4Ws ds2_da4Tv dt1_da4Wt dt2_da4Wu dt3_da4Wv
                 ds3_da4Tz ds4_da4TA ds5_da4TB ds6_da4TC ds7_da4TD ds8_da4TE ->
      let {
        elems_ia53N [Dmd=<S,U>] :: Int#
        [LclId]
        elems_ia53N = -# ww5_sa754 ww4_sa753 } in
      case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_ia53V
             ww_sa74Z
             (plusAddr# ww_sa74Z ww4_sa753)
             (int2Word# elems_ia53N)
             w2_sa74W
      of
      { (# ds9_ia53Y, ds10_ia53Z #) ->
      case touch#
             @ 'LiftedRep
             @ GHC.ForeignPtr.ForeignPtrContents
             ww1_sa750
             ds9_ia53Y
      of s'_ia541
      { __DEFAULT ->
      case ((Buffered.fillReadBuffer
               @ dev_aa4r8
               $dBufferedIO_aa4rc
               ds_da4Ts
               (GHC.IO.Buffer.Buffer
                  @ Word8 ww_sa74Z ww1_sa750 ww2_sa751 ww3_sa752 0# elems_ia53N))
            `cast` (GHC.Types.N:IO[0] <(Int, Buffer Word8)>_R
                    :: (IO (Int, Buffer Word8) :: *)
                       ~R# (State# RealWorld
                            -> (# State# RealWorld, (Int, Buffer Word8) #) :: *)))
             s'_ia541
      of
      { (# ipv_X7ID2, ipv1_X7ID4 #) ->
      case ipv1_X7ID4 of { (r_aa3ML, bbuf2_aa3MM) ->
      case r_aa3ML of { I# x_a22G ->
      case x_a22G of {
        __DEFAULT ->
          case ds4_da4TA of {
            Nothing -> case lvl22_ra7PC of wild6_00 { };
            Just decoder_aa4ro ->
              case decoder_aa4ro of
              { BufferCodec ds12_ia4Aw ds13_ia4Ax ds14_ia4Ay ds15_ia4Az
                            ds16_ia4AA ->
              case (ds15_ia4Az
                    `cast` (GHC.Types.N:IO[0] <dec_state_aa4ra>_R
                            :: (IO dec_state_aa4ra :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, dec_state_aa4ra #) :: *)))
                     ipv_X7ID2
              of
              { (# ipv2_X7IDi, ipv3_X7IDk #) ->
              case writeMutVar#
                     @ RealWorld
                     @ (dec_state_aa4ra, Buffer Word8)
                     dt1_da4Wt
                     (ipv3_X7IDk, bbuf2_aa3MM)
                     ipv2_X7IDi
              of s2#_i7IBe
              { __DEFAULT ->
              case GHC.IO.Handle.Internals.$wstreamEncode
                     @ Word8
                     @ CharBufElem
                     @ dec_state_aa4ra
                     ds12_ia4Aw
                     ds13_ia4Ax
                     bbuf2_aa3MM
                     w1_sa74V
                     s2#_i7IBe
              of
              { (# ipv4_X7IJG, ipv5_X7IJJ #) ->
              case ipv5_X7IJJ of { (bbuf3_aa3MQ, cbuf1_aa3MR) ->
              case writeMutVar#
                     @ RealWorld @ (Buffer Word8) dt_da4Ws bbuf3_aa3MQ ipv4_X7IJG
              of s2#1_X7IHL
              { __DEFAULT ->
              case w1_sa74V of
              { Buffer dt4_ia4OJ dt5_ia4OK ds19_ia4OL dt6_ia4OM dt7_ia4ON
                       dt8_ia4OO ->
              case cbuf1_aa3MR of wild9_Xa4Vs
              { Buffer dt9_Xa4Vw dt10_Xa4Vy ds20_Xa4VA dt11_Xa4VC dt12_Xa4VE
                       dt13_Xa4VG ->
              case ==# dt8_ia4OO dt13_Xa4VG of {
                __DEFAULT -> (# s2#1_X7IHL, wild9_Xa4Vs #);
                1# ->
                  case bbuf3_aa3MQ of
                  { Buffer ww7_Xa7a6 ww8_Xa7a8 ww9_Xa7aa ww10_Xa7ac ww11_Xa7ae
                           ww12_Xa7ag ->
                  GHC.IO.Handle.Internals.$wreadTextDevice'
                    wild_X1T
                    ww7_Xa7a6
                    ww8_Xa7a8
                    ww9_Xa7aa
                    ww10_Xa7ac
                    ww11_Xa7ae
                    ww12_Xa7ag
                    wild9_Xa4Vs
                    s2#1_X7IHL
                  }
              }
              }
              }
              }
              }
              }
              }
              }
              }
          };
        0# ->
          case bbuf2_aa3MM of wild5_ia4we
          { Buffer dt4_ia4wr dt5_ia4ws ds12_ia4wz dt6_ia4wA dt7_ia4wB
                   dt8_ia4wC ->
          case ==# dt7_ia4wB dt8_ia4wC of {
            __DEFAULT ->
              case ds4_da4TA of {
                Nothing -> case lvl22_ra7PC of wild7_00 { };
                Just decoder_aa4ro ->
                  case decoder_aa4ro of
                  { BufferCodec ds13_ia4zs ds14_ia4zt ds15_ia4zu ds16_ia4zv
                                ds17_ia4zw ->
                  case ((ds14_ia4zt wild5_ia4we w1_sa74V)
                        `cast` (GHC.Types.N:IO[0] <(Buffer Word8, Buffer CharBufElem)>_R
                                :: (IO (Buffer Word8, Buffer CharBufElem) :: *)
                                   ~R# (State# RealWorld
                                        -> (# State# RealWorld,
                                              (Buffer Word8, Buffer CharBufElem) #) :: *)))
                         ipv_X7ID2
                  of
                  { (# ipv2_X7IDk, ipv3_X7IDm #) ->
                  case ipv3_X7IDm of { (bbuf3_aa3MN, cbuf1_aa3MO) ->
                  case writeMutVar#
                         @ RealWorld @ (Buffer Word8) dt_da4Ws bbuf3_aa3MN ipv2_X7IDk
                  of s2#_i7IBe
                  { __DEFAULT ->
                  case cbuf1_aa3MO of wild9_ia4OH
                  { Buffer dt9_ia4OJ dt10_ia4OK ds19_ia4OL dt11_ia4OM dt12_ia4ON
                           dt13_ia4OO ->
                  case w1_sa74V of
                  { Buffer dt14_Xa4VA dt15_Xa4VC ds20_Xa4VE dt16_Xa4VG dt17_Xa4VI
                           dt18_Xa4VK ->
                  case ==# dt13_ia4OO dt18_Xa4VK of {
                    __DEFAULT -> (# s2#_i7IBe, wild9_ia4OH #);
                    1# ->
                      GHC.IO.Handle.Internals.hLookAhead_2 wild_X1T wild9_ia4OH s2#_i7IBe
                  }
                  }
                  }
                  }
                  }
                  }
                  }
              };
            1# ->
              raiseIO#
                @ SomeException
                @ CharBuffer
                GHC.IO.Handle.Internals.hLookAhead_3
                ipv_X7ID2
          }
          }
      }
      }
      }
      }
      }
      }
      }
end Rec }

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
readTextDevice :: Handle__ -> CharBuffer -> IO CharBuffer
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U,U,U,U,U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.hLookAhead_2
               `cast` (<Handle__>_R
                       ->_R <CharBuffer>_R
                       ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
                       :: (Handle__
                           -> CharBuffer
                           -> State# RealWorld
                           -> (# State# RealWorld, CharBuffer #) :: *)
                          ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))}]
readTextDevice
  = GHC.IO.Handle.Internals.hLookAhead_2
    `cast` (<Handle__>_R
            ->_R <CharBuffer>_R
            ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
            :: (Handle__
                -> CharBuffer
                -> State# RealWorld
                -> (# State# RealWorld, CharBuffer #) :: *)
               ~R# (Handle__ -> CharBuffer -> IO CharBuffer :: *))

-- RHS size: {terms: 67, types: 144, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.hLookAhead_1
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, Char #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 112 60}]
GHC.IO.Handle.Internals.hLookAhead_1
  = \ (handle__aa3LN :: Handle__) (eta_X4z :: State# RealWorld) ->
      case handle__aa3LN of wild_X1S
      { Handle__ @ dev_aa4sR @ enc_state_aa4sS @ dec_state_aa4sT
                 $dIODevice_aa4sU $dBufferedIO_aa4sV $dTypeable_aa4sW ds_da4Uk
                 ds1_da4Ul dt_da4Ww ds2_da4Un dt1_da4Wx dt2_da4Wy dt3_da4Wz
                 ds3_da4Ur ds4_da4Us ds5_da4Ut ds6_da4Uu ds7_da4Uv ds8_da4Uw ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_da4Wy eta_X4z
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_ia4we
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT ->
          case writeMutVar#
                 @ RealWorld @ (Buffer CharBufElem) dt2_da4Wy wild1_ia4we ipv_i7IAy
          of s2#_i7IBe
          { __DEFAULT ->
          case readWideCharOffAddr# @ RealWorld dt4_ia4wr dt7_ia4wB s2#_i7IBe
          of
          { (# ipv2_ia54K, ipv3_ia54L #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_ia4ws
                 ipv2_ia54K
          of s'_ia54N
          { __DEFAULT ->
          (# s'_ia54N, GHC.Types.C# ipv3_ia54L #)
          }
          }
          };
        1# ->
          case GHC.IO.Handle.Internals.hLookAhead_2
                 wild_X1S wild1_ia4we ipv_i7IAy
          of
          { (# ipv2_X7ID0, ipv3_X7ID2 #) ->
          case writeMutVar#
                 @ RealWorld @ (Buffer CharBufElem) dt2_da4Wy ipv3_X7ID2 ipv2_X7ID0
          of s2#_i7IBe
          { __DEFAULT ->
          case readWideCharOffAddr# @ RealWorld dt4_ia4wr dt7_ia4wB s2#_i7IBe
          of
          { (# ipv4_ia54K, ipv5_ia54L #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_ia4ws
                 ipv4_ia54K
          of s'_ia54N
          { __DEFAULT ->
          (# s'_ia54N, GHC.Types.C# ipv5_ia54L #)
          }
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
hLookAhead_ :: Handle__ -> IO Char
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.hLookAhead_1
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
                          ~R# (Handle__ -> IO Char :: *))}]
hLookAhead_
  = GHC.IO.Handle.Internals.hLookAhead_1
    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
            :: (Handle__
                -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
               ~R# (Handle__ -> IO Char :: *))

-- RHS size: {terms: 6, types: 12, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.hClose_help2
  :: SomeException
     -> State# RealWorld -> (# State# RealWorld, Maybe SomeException #)
[GblId,
 Arity=2,
 Caf=NoCafRefs,
 Str=<L,U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (e1_ia54Z [Occ=Once, OS=OneShot] :: SomeException)
                 (s_i7IAV [Occ=Once, OS=OneShot] :: State# RealWorld) ->
                 (# s_i7IAV, GHC.Base.Just @ SomeException e1_ia54Z #)}]
GHC.IO.Handle.Internals.hClose_help2
  = \ (e1_ia54Z [OS=OneShot] :: SomeException)
      (s_i7IAV [OS=OneShot] :: State# RealWorld) ->
      (# s_i7IAV, GHC.Base.Just @ SomeException e1_ia54Z #)

-- RHS size: {terms: 194, types: 396, coercions: 9, joins: 2/2}
GHC.IO.Handle.Internals.hClose_help1
  :: Handle__
     -> State# RealWorld
     -> (# State# RealWorld, (Handle__, Maybe SomeException) #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 469 30}]
GHC.IO.Handle.Internals.hClose_help1
  = \ (handle__aa3Ls :: Handle__) (eta_X4C :: State# RealWorld) ->
      case handle__aa3Ls of wild_ia4yf
      { Handle__ @ dev_ia4yh @ enc_state_ia4yi @ dec_state_ia4yj
                 $dIODevice_ia4yk $dBufferedIO_ia4yl $dTypeable_ia4ym ds1_ia4yn
                 ds2_ia4yo dt_ia4yp ds3_ia4yq dt1_ia4yr dt2_ia4ys dt3_ia4yt
                 ds4_ia4yu ds5_ia4yv ds6_ia4yw ds7_ia4yx ds8_ia4yy ds9_ia4yz ->
      case ds2_ia4yo of {
        __DEFAULT ->
          case catch#
                 @ (Maybe SomeException)
                 @ SomeException
                 (\ (s_i7JiH [OS=OneShot] :: State# RealWorld) ->
                    case readMutVar# @ RealWorld @ (Buffer Word8) dt_ia4yp s_i7JiH of
                    { (# ipv_i7IAy, ipv1_i7IAz #) ->
                    case ipv1_i7IAz of
                    { Buffer dt4_ia4xp dt5_ia4xq ds_ia4xr dt6_ia4xs dt7_ia4xt
                             dt8_ia4xu ->
                    case ds_ia4xr of {
                      ReadBuffer -> (# ipv_i7IAy, GHC.Base.Nothing @ SomeException #);
                      WriteBuffer ->
                        case readMutVar# @ RealWorld @ (Buffer Word8) dt_ia4yp ipv_i7IAy of
                        { (# ipv2_X7IGI, ipv3_X7IGK #) ->
                        case ipv3_X7IGK of wild4_ia4we
                        { Buffer dt9_ia4wr dt10_ia4ws ds13_ia4wz dt11_ia4wA dt12_ia4wB
                                 dt13_ia4wC ->
                        case ==# dt12_ia4wB dt13_ia4wC of {
                          __DEFAULT ->
                            case ((Buffered.flushWriteBuffer
                                     @ dev_ia4yh $dBufferedIO_ia4yl ds1_ia4yn wild4_ia4we)
                                  `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                          :: (IO (Buffer Word8) :: *)
                                             ~R# (State# RealWorld
                                                  -> (# State# RealWorld, Buffer Word8 #) :: *)))
                                   ipv2_X7IGI
                            of
                            { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
                            case writeMutVar#
                                   @ RealWorld @ (Buffer Word8) dt_ia4yp ipv5_X7ICQ ipv4_X7ICO
                            of s2#_i7IBe
                            { __DEFAULT ->
                            (# s2#_i7IBe, GHC.Base.Nothing @ SomeException #)
                            }
                            };
                          1# -> (# ipv2_X7IGI, GHC.Base.Nothing @ SomeException #)
                        }
                        }
                        }
                    }
                    }
                    })
                 GHC.IO.Handle.Internals.hClose_help2
                 eta_X4C
          of
          { (# ipv_i7IAy, ipv1_i7IAz #) ->
          join {
            $j_sa5w6 [Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
              :: State# RealWorld
                 -> Maybe SomeException
                 -> (# State# RealWorld, (Handle__, Maybe SomeException) #)
            [LclId[JoinId(2)], Arity=2, Str=<S,U><L,1*U>, Unf=OtherCon []]
            $j_sa5w6 (ipv2_X7IDc [OS=OneShot] :: State# RealWorld)
                     (ipv3_X7IDe [OS=OneShot] :: Maybe SomeException)
              = case writeMutVar#
                       @ RealWorld
                       @ (BufferList CharBufElem)
                       dt3_ia4yt
                       (GHC.IO.Handle.Types.BufferListNil @ CharBufElem)
                       ipv2_X7IDc
                of s2#_i7IBe
                { __DEFAULT ->
                case writeMutVar#
                       @ RealWorld @ (Buffer CharBufElem) dt2_ia4ys noCharBuffer s2#_i7IBe
                of s2#1_X7IHc
                { __DEFAULT ->
                case writeMutVar#
                       @ RealWorld @ (Buffer Word8) dt_ia4yp noByteBuffer s2#1_X7IHc
                of s2#2_X7IHg
                { __DEFAULT ->
                join {
                  $w$j_sa75b [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
                    :: State# RealWorld
                       -> (# State# RealWorld, (Handle__, Maybe SomeException) #)
                  [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                  $w$j_sa75b (w_sa759 [OS=OneShot] :: State# RealWorld)
                    = case ds4_ia4yu of wild2_XE {
                        Nothing ->
                          (# w_sa759,
                             (GHC.IO.Handle.Types.Handle__
                                @ dev_ia4yh
                                @ enc_state_ia4yi
                                @ dec_state_ia4yj
                                $dIODevice_ia4yk
                                $dBufferedIO_ia4yl
                                $dTypeable_ia4ym
                                ds1_ia4yn
                                GHC.IO.Handle.Types.ClosedHandle
                                dt_ia4yp
                                ds3_ia4yq
                                dt1_ia4yr
                                dt2_ia4ys
                                dt3_ia4yt
                                (GHC.Base.Nothing @ (TextEncoder enc_state_ia4yi))
                                ds5_ia4yv
                                ds6_ia4yw
                                ds7_ia4yx
                                ds8_ia4yy
                                ds9_ia4yz,
                              case ipv1_i7IAz of wild3_i7S9D {
                                Nothing -> ipv3_X7IDe;
                                Just ipv4_i7Ssm -> wild3_i7S9D
                              }) #);
                        Just d_aa3Lr ->
                          case d_aa3Lr of
                          { BufferCodec ds12_ia4tL ds13_ia4tM ds14_ia4tN ds15_ia4tO
                                        ds16_ia4tP ->
                          case (ds14_ia4tN
                                `cast` (GHC.Types.N:IO[0] <()>_R
                                        :: (IO () :: *)
                                           ~R# (State# RealWorld
                                                -> (# State# RealWorld, () #) :: *)))
                                 w_sa759
                          of
                          { (# ipv4_X7Js1, ipv5_X7Js4 #) ->
                          (# ipv4_X7Js1,
                             (GHC.IO.Handle.Types.Handle__
                                @ dev_ia4yh
                                @ enc_state_ia4yi
                                @ dec_state_ia4yj
                                $dIODevice_ia4yk
                                $dBufferedIO_ia4yl
                                $dTypeable_ia4ym
                                ds1_ia4yn
                                GHC.IO.Handle.Types.ClosedHandle
                                dt_ia4yp
                                ds3_ia4yq
                                dt1_ia4yr
                                dt2_ia4ys
                                dt3_ia4yt
                                wild2_XE
                                ds5_ia4yv
                                ds6_ia4yw
                                ds7_ia4yx
                                ds8_ia4yy
                                ds9_ia4yz,
                              case ipv1_i7IAz of wild4_i7S9D {
                                Nothing -> ipv3_X7IDe;
                                Just ipv6_i7Ssm -> wild4_i7S9D
                              }) #)
                          }
                          }
                      } } in
                case ds5_ia4yv of {
                  Nothing -> jump $w$j_sa75b s2#2_X7IHg;
                  Just d_aa3Lq ->
                    case d_aa3Lq of
                    { BufferCodec ds12_ia4tL ds13_ia4tM ds14_ia4tN ds15_ia4tO
                                  ds16_ia4tP ->
                    case (ds14_ia4tN
                          `cast` (GHC.Types.N:IO[0] <()>_R
                                  :: (IO () :: *)
                                     ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                           s2#2_X7IHg
                    of
                    { (# ipv4_X7JlQ, ipv5_X7JlS #) ->
                    jump $w$j_sa75b ipv4_X7JlQ
                    }
                    }
                }
                }
                }
                } } in
          case ds9_ia4yz of {
            Nothing ->
              case catch#
                     @ (Maybe SomeException)
                     @ SomeException
                     (\ (s_i7JiH [OS=OneShot] :: State# RealWorld) ->
                        case ((IODevice.close @ dev_ia4yh $dIODevice_ia4yk ds1_ia4yn)
                              `cast` (GHC.Types.N:IO[0] <()>_R
                                      :: (IO () :: *)
                                         ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                               s_i7JiH
                        of
                        { (# ipv2_i7JiK, ipv3_i7JiL #) ->
                        (# ipv2_i7JiK, GHC.Base.Nothing @ SomeException #)
                        })
                     GHC.IO.Handle.Internals.hClose_help2
                     ipv_i7IAy
              of
              { (# ipv2_X7IDc, ipv3_X7IDe #) ->
              jump $j_sa5w6 ipv2_X7IDc ipv3_X7IDe
              };
            Just ds_da4uL ->
              jump $j_sa5w6 ipv_i7IAy (GHC.Base.Nothing @ SomeException)
          }
          };
        ClosedHandle ->
          (# eta_X4C, (wild_ia4yf, GHC.Base.Nothing @ SomeException) #)
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 8, joins: 0/0}
hClose_help :: Handle__ -> IO (Handle__, Maybe SomeException)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.hClose_help1
               `cast` (<Handle__>_R
                       ->_R Sym (GHC.Types.N:IO[0] <(Handle__, Maybe SomeException)>_R)
                       :: (Handle__
                           -> State# RealWorld
                           -> (# State# RealWorld, (Handle__, Maybe SomeException) #) :: *)
                          ~R# (Handle__ -> IO (Handle__, Maybe SomeException) :: *))}]
hClose_help
  = GHC.IO.Handle.Internals.hClose_help1
    `cast` (<Handle__>_R
            ->_R Sym (GHC.Types.N:IO[0] <(Handle__, Maybe SomeException)>_R)
            :: (Handle__
                -> State# RealWorld
                -> (# State# RealWorld, (Handle__, Maybe SomeException) #) :: *)
               ~R# (Handle__ -> IO (Handle__, Maybe SomeException) :: *))

-- RHS size: {terms: 28, types: 58, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.handleFinalizer1
  :: FilePath
     -> MVar Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=3,
 Str=<L,A><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
         Tmpl= \ _ [Occ=Dead]
                 (m_aa3Il [Occ=Once!] :: MVar Handle__)
                 (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                 case m_aa3Il of { MVar mvar#_i9Dso ->
                 case takeMVar# @ RealWorld @ Handle__ mvar#_i9Dso s_i7IAv of
                 { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once] #) ->
                 case GHC.IO.Handle.Internals.hClose_help1 ipv1_i7IAz ipv_i7IAy of
                 { (# ipv2_X7ICE [Occ=Once], ipv3_X7ICG [Occ=Once!] #) ->
                 case ipv3_X7ICG of { (handle_'_aa3In [Occ=Once], _ [Occ=Dead]) ->
                 case putMVar#
                        @ RealWorld @ Handle__ mvar#_i9Dso handle_'_aa3In ipv2_X7ICE
                 of s2#_i9DsB
                 { __DEFAULT ->
                 (# s2#_i9DsB, GHC.Tuple.() #)
                 }
                 }
                 }
                 }
                 }}]
GHC.IO.Handle.Internals.handleFinalizer1
  = \ _ [Occ=Dead]
      (m_aa3Il :: MVar Handle__)
      (s_i7IAv :: State# RealWorld) ->
      case m_aa3Il of { MVar mvar#_i9Dso ->
      case takeMVar# @ RealWorld @ Handle__ mvar#_i9Dso s_i7IAv of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case GHC.IO.Handle.Internals.hClose_help1 ipv1_i7IAz ipv_i7IAy of
      { (# ipv2_X7ICE, ipv3_X7ICG #) ->
      case ipv3_X7ICG of { (handle_'_aa3In, ds_da4zh) ->
      case putMVar#
             @ RealWorld @ Handle__ mvar#_i9Dso handle_'_aa3In ipv2_X7ICE
      of s2#_i9DsB
      { __DEFAULT ->
      (# s2#_i9DsB, GHC.Tuple.() #)
      }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 8, joins: 0/0}
handleFinalizer :: FilePath -> MVar Handle__ -> IO ()
[GblId,
 Arity=3,
 Str=<L,A><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.handleFinalizer1
               `cast` (<FilePath>_R
                       ->_R <MVar Handle__>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (FilePath
                           -> MVar Handle__
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (FilePath -> MVar Handle__ -> IO () :: *))}]
handleFinalizer
  = GHC.IO.Handle.Internals.handleFinalizer1
    `cast` (<FilePath>_R
            ->_R <MVar Handle__>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (FilePath
                -> MVar Handle__
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (FilePath -> MVar Handle__ -> IO () :: *))

-- RHS size: {terms: 2, types: 5, coercions: 8, joins: 0/0}
GHC.IO.Handle.Internals.mkDuplexHandle4
  :: Maybe (FilePath -> MVar Handle__ -> IO ())
[GblId,
 Str=m2,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Internals.mkDuplexHandle4
  = GHC.Base.Just
      @ (FilePath -> MVar Handle__ -> IO ())
      (GHC.IO.Handle.Internals.handleFinalizer1
       `cast` (<FilePath>_R
               ->_R <MVar Handle__>_R
               ->_R Sym (GHC.Types.N:IO[0] <()>_R)
               :: (FilePath
                   -> MVar Handle__
                   -> State# RealWorld
                   -> (# State# RealWorld, () #) :: *)
                  ~R# (FilePath -> MVar Handle__ -> IO () :: *)))

-- RHS size: {terms: 32, types: 22, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.mkFileHandle1
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev
     -> FilePath
     -> IOMode
     -> Maybe TextEncoding
     -> NewlineMode
     -> State# RealWorld
     -> (# State# RealWorld, Handle #)
[GblId,
 Arity=9,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><L,1*U><S,U><L,U(U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=9,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ dev_aa4il)
                 ($dIODevice_aa4in [Occ=Once] :: IODevice dev_aa4il)
                 ($dBufferedIO_aa4io [Occ=Once] :: BufferedIO dev_aa4il)
                 ($dTypeable_aa4ip [Occ=Once] :: Typeable dev_aa4il)
                 (dev1_aa3KK [Occ=Once] :: dev_aa4il)
                 (filepath_aa3KL [Occ=Once] :: FilePath)
                 (iomode_aa3KM [Occ=Once!] :: IOMode)
                 (mb_codec_aa3KN [Occ=Once] :: Maybe TextEncoding)
                 (tr_newlines_aa3KO [Occ=Once] :: NewlineMode)
                 (eta_X4P [Occ=Once] :: State# RealWorld) ->
                 GHC.IO.Handle.Internals.mkDuplexHandle5
                   @ dev_aa4il
                   $dIODevice_aa4in
                   $dBufferedIO_aa4io
                   $dTypeable_aa4ip
                   dev1_aa3KK
                   filepath_aa3KL
                   (case iomode_aa3KM of {
                      ReadMode -> GHC.IO.Handle.Types.ReadHandle;
                      WriteMode -> GHC.IO.Handle.Types.WriteHandle;
                      AppendMode -> GHC.IO.Handle.Types.AppendHandle;
                      ReadWriteMode -> GHC.IO.Handle.Types.ReadWriteHandle
                    })
                   GHC.Types.True
                   mb_codec_aa3KN
                   tr_newlines_aa3KO
                   GHC.IO.Handle.Internals.mkDuplexHandle4
                   (GHC.Base.Nothing @ (MVar Handle__))
                   eta_X4P}]
GHC.IO.Handle.Internals.mkFileHandle1
  = \ (@ dev_aa4il)
      ($dIODevice_aa4in :: IODevice dev_aa4il)
      ($dBufferedIO_aa4io :: BufferedIO dev_aa4il)
      ($dTypeable_aa4ip :: Typeable dev_aa4il)
      (dev1_aa3KK :: dev_aa4il)
      (filepath_aa3KL :: FilePath)
      (iomode_aa3KM :: IOMode)
      (mb_codec_aa3KN :: Maybe TextEncoding)
      (tr_newlines_aa3KO :: NewlineMode)
      (eta_X4P :: State# RealWorld) ->
      GHC.IO.Handle.Internals.mkDuplexHandle5
        @ dev_aa4il
        $dIODevice_aa4in
        $dBufferedIO_aa4io
        $dTypeable_aa4ip
        dev1_aa3KK
        filepath_aa3KL
        (case iomode_aa3KM of {
           ReadMode -> GHC.IO.Handle.Types.ReadHandle;
           WriteMode -> GHC.IO.Handle.Types.WriteHandle;
           AppendMode -> GHC.IO.Handle.Types.AppendHandle;
           ReadWriteMode -> GHC.IO.Handle.Types.ReadWriteHandle
         })
        GHC.Types.True
        mb_codec_aa3KN
        tr_newlines_aa3KO
        GHC.IO.Handle.Internals.mkDuplexHandle4
        (GHC.Base.Nothing @ (MVar Handle__))
        eta_X4P

-- RHS size: {terms: 1, types: 0, coercions: 28, joins: 0/0}
mkFileHandle
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev
     -> FilePath
     -> IOMode
     -> Maybe TextEncoding
     -> NewlineMode
     -> IO Handle
[GblId,
 Arity=9,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><L,1*U><S,U><L,U(U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.mkFileHandle1
               `cast` (forall (dev :: <*>_N).
                       <IODevice dev>_R
                       ->_R <BufferedIO dev>_R
                       ->_R <Typeable dev>_R
                       ->_R <dev>_R
                       ->_R <FilePath>_R
                       ->_R <IOMode>_R
                       ->_R <Maybe TextEncoding>_R
                       ->_R <NewlineMode>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
                       :: (forall dev.
                           (IODevice dev, BufferedIO dev, Typeable dev) =>
                           dev
                           -> FilePath
                           -> IOMode
                           -> Maybe TextEncoding
                           -> NewlineMode
                           -> State# RealWorld
                           -> (# State# RealWorld, Handle #) :: *)
                          ~R# (forall dev.
                               (IODevice dev, BufferedIO dev, Typeable dev) =>
                               dev
                               -> FilePath
                               -> IOMode
                               -> Maybe TextEncoding
                               -> NewlineMode
                               -> IO Handle :: *))}]
mkFileHandle
  = GHC.IO.Handle.Internals.mkFileHandle1
    `cast` (forall (dev :: <*>_N).
            <IODevice dev>_R
            ->_R <BufferedIO dev>_R
            ->_R <Typeable dev>_R
            ->_R <dev>_R
            ->_R <FilePath>_R
            ->_R <IOMode>_R
            ->_R <Maybe TextEncoding>_R
            ->_R <NewlineMode>_R
            ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
            :: (forall dev.
                (IODevice dev, BufferedIO dev, Typeable dev) =>
                dev
                -> FilePath
                -> IOMode
                -> Maybe TextEncoding
                -> NewlineMode
                -> State# RealWorld
                -> (# State# RealWorld, Handle #) :: *)
               ~R# (forall dev.
                    (IODevice dev, BufferedIO dev, Typeable dev) =>
                    dev
                    -> FilePath
                    -> IOMode
                    -> Maybe TextEncoding
                    -> NewlineMode
                    -> IO Handle :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl23_ra7PD :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl23_ra7PD
  = "Pattern match failure in do expression at GHC/IO/Handle/Internals.hs:686:3-33"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.mkDuplexHandle3
  :: State# RealWorld -> (# State# RealWorld, Handle #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.mkDuplexHandle3
  = \ (eta_X4J :: State# RealWorld) ->
      GHC.IO.failIO1 @ Handle (unpackCString# lvl23_ra7PD) eta_X4J

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl24_ra7PE :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl24_ra7PE
  = "Pattern match failure in do expression at GHC/IO/Handle/Internals.hs:680:3-35"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.mkDuplexHandle2
  :: State# RealWorld -> (# State# RealWorld, Handle #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.mkDuplexHandle2
  = \ (eta_X4L :: State# RealWorld) ->
      GHC.IO.failIO1 @ Handle (unpackCString# lvl24_ra7PE) eta_X4L

-- RHS size: {terms: 59, types: 78, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.mkDuplexHandle1
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev
     -> FilePath
     -> Maybe TextEncoding
     -> NewlineMode
     -> State# RealWorld
     -> (# State# RealWorld, Handle #)
[GblId,
 Arity=8,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><S,U><L,U(U,U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 0 0 0 0 0] 350 30}]
GHC.IO.Handle.Internals.mkDuplexHandle1
  = \ (@ dev_aa4ix)
      ($dIODevice_aa4iz :: IODevice dev_aa4ix)
      ($dBufferedIO_aa4iA :: BufferedIO dev_aa4ix)
      ($dTypeable_aa4iB :: Typeable dev_aa4ix)
      (dev1_aa3KP :: dev_aa4ix)
      (filepath_aa3KQ :: FilePath)
      (mb_codec_aa3KR :: Maybe TextEncoding)
      (tr_newlines_aa3KS :: NewlineMode)
      (s_i7IAv :: State# RealWorld) ->
      case GHC.IO.Handle.Internals.mkDuplexHandle5
             @ dev_aa4ix
             $dIODevice_aa4iz
             $dBufferedIO_aa4iA
             $dTypeable_aa4iB
             dev1_aa3KP
             filepath_aa3KQ
             GHC.IO.Handle.Types.WriteHandle
             GHC.Types.True
             mb_codec_aa3KR
             tr_newlines_aa3KS
             GHC.IO.Handle.Internals.mkDuplexHandle4
             (GHC.Base.Nothing @ (MVar Handle__))
             s_i7IAv
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of {
        FileHandle ds_da4Jh dt_da4Vw ->
          case GHC.IO.Handle.Internals.mkDuplexHandle5
                 @ dev_aa4ix
                 $dIODevice_aa4iz
                 $dBufferedIO_aa4iA
                 $dTypeable_aa4iB
                 dev1_aa3KP
                 filepath_aa3KQ
                 GHC.IO.Handle.Types.ReadHandle
                 GHC.Types.True
                 mb_codec_aa3KR
                 tr_newlines_aa3KS
                 (GHC.Base.Nothing @ HandleFinalizer)
                 (GHC.Base.Just
                    @ (MVar Handle__) (GHC.MVar.MVar @ Handle__ dt_da4Vw))
                 ipv_i7IAy
          of
          { (# ipv2_X7ICY, ipv3_X7ID0 #) ->
          case ipv3_X7ID0 of {
            FileHandle ds3_da4J3 dt1_da4Vx ->
              (# ipv2_X7ICY,
                 GHC.IO.Handle.Types.DuplexHandle
                   filepath_aa3KQ dt1_da4Vx dt_da4Vw #);
            DuplexHandle ipv4_sa55N ipv5_sa55O ipv6_sa55P ->
              GHC.IO.Handle.Internals.mkDuplexHandle3 ipv2_X7ICY
          }
          };
        DuplexHandle ipv2_sa55R ipv3_sa55S ipv4_sa55T ->
          GHC.IO.Handle.Internals.mkDuplexHandle2 ipv_i7IAy
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 26, joins: 0/0}
mkDuplexHandle
  :: forall dev.
     (IODevice dev, BufferedIO dev, Typeable dev) =>
     dev -> FilePath -> Maybe TextEncoding -> NewlineMode -> IO Handle
[GblId,
 Arity=8,
 Str=<L,U(U,U,U,U,U,U,U,U,U,U,U,U,U,U)><L,U(U,U,U,U,U,U)><L,U><L,U><L,U><S,U><L,U(U,U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.mkDuplexHandle1
               `cast` (forall (dev :: <*>_N).
                       <IODevice dev>_R
                       ->_R <BufferedIO dev>_R
                       ->_R <Typeable dev>_R
                       ->_R <dev>_R
                       ->_R <FilePath>_R
                       ->_R <Maybe TextEncoding>_R
                       ->_R <NewlineMode>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
                       :: (forall dev.
                           (IODevice dev, BufferedIO dev, Typeable dev) =>
                           dev
                           -> FilePath
                           -> Maybe TextEncoding
                           -> NewlineMode
                           -> State# RealWorld
                           -> (# State# RealWorld, Handle #) :: *)
                          ~R# (forall dev.
                               (IODevice dev, BufferedIO dev, Typeable dev) =>
                               dev
                               -> FilePath
                               -> Maybe TextEncoding
                               -> NewlineMode
                               -> IO Handle :: *))}]
mkDuplexHandle
  = GHC.IO.Handle.Internals.mkDuplexHandle1
    `cast` (forall (dev :: <*>_N).
            <IODevice dev>_R
            ->_R <BufferedIO dev>_R
            ->_R <Typeable dev>_R
            ->_R <dev>_R
            ->_R <FilePath>_R
            ->_R <Maybe TextEncoding>_R
            ->_R <NewlineMode>_R
            ->_R Sym (GHC.Types.N:IO[0] <Handle>_R)
            :: (forall dev.
                (IODevice dev, BufferedIO dev, Typeable dev) =>
                dev
                -> FilePath
                -> Maybe TextEncoding
                -> NewlineMode
                -> State# RealWorld
                -> (# State# RealWorld, Handle #) :: *)
               ~R# (forall dev.
                    (IODevice dev, BufferedIO dev, Typeable dev) =>
                    dev
                    -> FilePath
                    -> Maybe TextEncoding
                    -> NewlineMode
                    -> IO Handle :: *))

-- RHS size: {terms: 31, types: 32, coercions: 0, joins: 0/0}
$wlvl_ra7PF
  :: forall a.
     IOErrorType
     -> String
     -> Maybe CInt
     -> Maybe FilePath
     -> String
     -> Handle
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=7,
 Str=<B,U><B,U><B,U><B,1*U><B,U><B,U><B,U>x,
 Unf=OtherCon []]
$wlvl_ra7PF
  = \ (@ a_sa75r)
      (ww_sa75z :: IOErrorType)
      (ww1_sa75B :: String)
      (ww2_sa75C :: Maybe CInt)
      (ww3_sa75D :: Maybe FilePath)
      (w_sa75t :: String)
      (w1_sa75u :: Handle)
      (w2_sa75v :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_sa75r
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Just @ Handle w1_sa75u)
              ww_sa75z
              w_sa75t
              ww1_sa75B
              ww2_sa75C
              (case ww3_sa75D of wild_Xi {
                 Nothing ->
                   case w1_sa75u of {
                     FileHandle path_aa3Gd dt_da4Ve ->
                       GHC.Base.Just @ FilePath path_aa3Gd;
                     DuplexHandle path_aa3Ge dt_da4Vf dt1_da4Vg ->
                       GHC.Base.Just @ FilePath path_aa3Ge
                   };
                 Just ds_da4Fx -> wild_Xi
               })))
        w2_sa75v

Rec {
-- RHS size: {terms: 73, types: 94, coercions: 14, joins: 0/0}
GHC.IO.Handle.Internals.$wdo_operation [InlPrag=NOUSERINLINE[0],
                                        Occ=LoopBreaker]
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> MVar# RealWorld Handle__
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><C(S),C(U)><S,U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Internals.$wdo_operation
  = \ (@ a_sa75G)
      (w_sa75H :: String)
      (w1_sa75I :: Handle)
      (w2_sa75J :: Handle__ -> IO a_sa75G)
      (ww_sa75O :: MVar# RealWorld Handle__)
      (w3_sa75L :: State# RealWorld) ->
      case takeMVar# @ RealWorld @ Handle__ ww_sa75O w3_sa75L of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case (w2_sa75J ipv1_i7IAz)
           `cast` (GHC.Types.N:IO[0] <a_sa75G>_R
                   :: (IO a_sa75G :: *)
                      ~R# (State# RealWorld -> (# State# RealWorld, a_sa75G #) :: *))
      of nt_ia54Y
      { __DEFAULT ->
      catch#
        @ a_sa75G
        @ SomeException
        nt_ia54Y
        (\ (e1_ia54Z [OS=OneShot] :: SomeException)
           (s_i7JiH [OS=OneShot] :: State# RealWorld) ->
           case putMVar# @ RealWorld @ Handle__ ww_sa75O ipv1_i7IAz s_i7JiH
           of s2#_i9DsB
           { __DEFAULT ->
           case e1_ia54Z of wild_ia562
           { SomeException @ e2_ia565 $dException1_ia566 e3_ia567 ->
           case Data.Typeable.Internal.sameTypeRep
                  @ *
                  @ *
                  @ e2_ia565
                  @ IOException
                  ((GHC.Exception.$p1Exception @ e2_ia565 $dException1_ia566)
                   `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <e2_ia565>_N
                           :: (Typeable e2_ia565 :: Constraint)
                              ~R# (Data.Typeable.Internal.TypeRep e2_ia565 :: *)))
                  GHC.IO.Exception.$fExceptionIOException4
           of {
             False ->
               case Data.Typeable.Internal.sameTypeRep
                      @ *
                      @ *
                      @ e2_ia565
                      @ SomeAsyncException
                      ((GHC.Exception.$p1Exception @ e2_ia565 $dException1_ia566)
                       `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <e2_ia565>_N
                               :: (Typeable e2_ia565 :: Constraint)
                                  ~R# (Data.Typeable.Internal.TypeRep e2_ia565 :: *)))
                      GHC.IO.Exception.$fExceptionAllocationLimitExceeded6
               of {
                 False -> raiseIO# @ SomeException @ a_sa75G wild_ia562 s2#_i9DsB;
                 True ->
                   case myThreadId# s2#_i9DsB of { (# ipv2_ia56z, ipv3_ia56A #) ->
                   case killThread# @ SomeException ipv3_ia56A wild_ia562 ipv2_ia56z
                   of s1_ia56N
                   { __DEFAULT ->
                   GHC.IO.Handle.Internals.$wdo_operation
                     @ a_sa75G w_sa75H w1_sa75I w2_sa75J ww_sa75O s1_ia56N
                   }
                   }
               };
             True ->
               case e3_ia567
                    `cast` (UnsafeCo representational e2_ia565 IOException
                            :: (e2_ia565 :: *) ~R# (IOException :: *))
               of
               { IOError ww2_sa75y ww3_sa75z ww4_sa75A ww5_sa75B ww6_sa75C
                         ww7_sa75D ->
               $wlvl_ra7PF
                 @ a_sa75G
                 ww3_sa75z
                 ww5_sa75B
                 ww6_sa75C
                 ww7_sa75D
                 w_sa75H
                 w1_sa75I
                 s2#_i9DsB
               }
           }
           }
           })
        ipv_i7IAy
      }
      }
end Rec }

-- RHS size: {terms: 15, types: 17, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.withHandle_1 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> MVar Handle__
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><C(S),C(U)><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sa75G)
                 (w_sa75H [Occ=Once] :: String)
                 (w1_sa75I [Occ=Once] :: Handle)
                 (w2_sa75J [Occ=Once] :: Handle__ -> IO a_sa75G)
                 (w3_sa75K [Occ=Once!] :: MVar Handle__)
                 (w4_sa75L [Occ=Once] :: State# RealWorld) ->
                 case w3_sa75K of { MVar ww1_sa75O [Occ=Once] ->
                 GHC.IO.Handle.Internals.$wdo_operation
                   @ a_sa75G w_sa75H w1_sa75I w2_sa75J ww1_sa75O w4_sa75L
                 }}]
GHC.IO.Handle.Internals.withHandle_1
  = \ (@ a_sa75G)
      (w_sa75H :: String)
      (w1_sa75I :: Handle)
      (w2_sa75J :: Handle__ -> IO a_sa75G)
      (w3_sa75K :: MVar Handle__)
      (w4_sa75L :: State# RealWorld) ->
      case w3_sa75K of { MVar ww1_sa75O ->
      GHC.IO.Handle.Internals.$wdo_operation
        @ a_sa75G w_sa75H w1_sa75I w2_sa75J ww1_sa75O w4_sa75L
      }

-- RHS size: {terms: 50, types: 71, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.$wwithHandle__' [InlPrag=NOUSERINLINE[0]]
  :: String
     -> Handle
     -> MVar# RealWorld Handle__
     -> (Handle__ -> IO Handle__)
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S,U><C(S),C(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 0 0] 183 30}]
GHC.IO.Handle.Internals.$wwithHandle__'
  = \ (w_sa75S :: String)
      (w1_sa75T :: Handle)
      (ww_sa75Z :: MVar# RealWorld Handle__)
      (w2_sa75V :: Handle__ -> IO Handle__)
      (w3_sa75W :: State# RealWorld) ->
      case getMaskingState# w3_sa75W of { (# ipv_ia56X, ipv1_ia56Y #) ->
      case ipv1_ia56Y of {
        __DEFAULT ->
          case GHC.IO.Handle.Internals.$wdo_operation
                 @ Handle__ w_sa75S w1_sa75T w2_sa75V ww_sa75Z ipv_ia56X
          of
          { (# ipv2_i7IAy, ipv3_i7IAz #) ->
          case putMVar# @ RealWorld @ Handle__ ww_sa75Z ipv3_i7IAz ipv2_i7IAy
          of s2#_i9DsB
          { __DEFAULT ->
          (# s2#_i9DsB, GHC.Tuple.() #)
          }
          };
        0# ->
          maskAsyncExceptions#
            @ ()
            (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
               case GHC.IO.Handle.Internals.$wdo_operation
                      @ Handle__ w_sa75S w1_sa75T w2_sa75V ww_sa75Z s_i7IAv
               of
               { (# ipv2_i7IAy, ipv3_i7IAz #) ->
               case putMVar# @ RealWorld @ Handle__ ww_sa75Z ipv3_i7IAz ipv2_i7IAy
               of s2#_i9DsB
               { __DEFAULT ->
               (# s2#_i9DsB, GHC.Tuple.() #)
               }
               })
            ipv_ia56X
      }
      }

-- RHS size: {terms: 14, types: 14, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.withHandle__'1 [InlPrag=NOUSERINLINE[0]]
  :: String
     -> Handle
     -> MVar Handle__
     -> (Handle__ -> IO Handle__)
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_sa75S [Occ=Once] :: String)
                 (w1_sa75T [Occ=Once] :: Handle)
                 (w2_sa75U [Occ=Once!] :: MVar Handle__)
                 (w3_sa75V [Occ=Once] :: Handle__ -> IO Handle__)
                 (w4_sa75W [Occ=Once] :: State# RealWorld) ->
                 case w2_sa75U of { MVar ww1_sa75Z [Occ=Once] ->
                 GHC.IO.Handle.Internals.$wwithHandle__'
                   w_sa75S w1_sa75T ww1_sa75Z w3_sa75V w4_sa75W
                 }}]
GHC.IO.Handle.Internals.withHandle__'1
  = \ (w_sa75S :: String)
      (w1_sa75T :: Handle)
      (w2_sa75U :: MVar Handle__)
      (w3_sa75V :: Handle__ -> IO Handle__)
      (w4_sa75W :: State# RealWorld) ->
      case w2_sa75U of { MVar ww1_sa75Z ->
      GHC.IO.Handle.Internals.$wwithHandle__'
        w_sa75S w1_sa75T ww1_sa75Z w3_sa75V w4_sa75W
      }

-- RHS size: {terms: 1, types: 0, coercions: 14, joins: 0/0}
withHandle__'
  :: String
     -> Handle -> MVar Handle__ -> (Handle__ -> IO Handle__) -> IO ()
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.withHandle__'1
               `cast` (<String>_R
                       ->_R <Handle>_R
                       ->_R <MVar Handle__>_R
                       ->_R <Handle__ -> IO Handle__>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (String
                           -> Handle
                           -> MVar Handle__
                           -> (Handle__ -> IO Handle__)
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (String
                               -> Handle
                               -> MVar Handle__
                               -> (Handle__ -> IO Handle__)
                               -> IO () :: *))}]
withHandle__'
  = GHC.IO.Handle.Internals.withHandle__'1
    `cast` (<String>_R
            ->_R <Handle>_R
            ->_R <MVar Handle__>_R
            ->_R <Handle__ -> IO Handle__>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (String
                -> Handle
                -> MVar Handle__
                -> (Handle__ -> IO Handle__)
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (String
                    -> Handle
                    -> MVar Handle__
                    -> (Handle__ -> IO Handle__)
                    -> IO () :: *))

-- RHS size: {terms: 148, types: 218, coercions: 0, joins: 1/1}
GHC.IO.Handle.Internals.withAllHandles__1
  :: String
     -> Handle
     -> (Handle__ -> IO Handle__)
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><C(S),C(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 213 0 0] 583 30}]
GHC.IO.Handle.Internals.withAllHandles__1
  = \ (fun_aa3FI :: String)
      (h_aa3FJ :: Handle)
      (act_aa3FL :: Handle__ -> IO Handle__)
      (eta_X4X :: State# RealWorld) ->
      case h_aa3FJ of wild_X2m {
        FileHandle ds_da4GP dt_da4Vh ->
          case getMaskingState# eta_X4X of { (# ipv_ia56X, ipv1_ia56Y #) ->
          case ipv1_ia56Y of {
            __DEFAULT ->
              case GHC.IO.Handle.Internals.$wdo_operation
                     @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt_da4Vh ipv_ia56X
              of
              { (# ipv2_i7IAy, ipv3_i7IAz #) ->
              case putMVar# @ RealWorld @ Handle__ dt_da4Vh ipv3_i7IAz ipv2_i7IAy
              of s2#_i9DsB
              { __DEFAULT ->
              (# s2#_i9DsB, GHC.Tuple.() #)
              }
              };
            0# ->
              maskAsyncExceptions#
                @ ()
                (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
                   case GHC.IO.Handle.Internals.$wdo_operation
                          @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt_da4Vh s_i7IAv
                   of
                   { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                   case putMVar# @ RealWorld @ Handle__ dt_da4Vh ipv3_i7IAz ipv2_i7IAy
                   of s2#_i9DsB
                   { __DEFAULT ->
                   (# s2#_i9DsB, GHC.Tuple.() #)
                   }
                   })
                ipv_ia56X
          }
          };
        DuplexHandle ds_da4GQ dt_da4Vi dt1_da4Vj ->
          case getMaskingState# eta_X4X of { (# ipv_ia56X, ipv1_ia56Y #) ->
          join {
            $w$j_sa764 [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, () #)
            [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
            $w$j_sa764 (w_sa762 [OS=OneShot] :: State# RealWorld)
              = case getMaskingState# w_sa762 of
                { (# ipv2_Xa5cM, ipv3_Xa5cO #) ->
                case ipv3_Xa5cO of {
                  __DEFAULT ->
                    case GHC.IO.Handle.Internals.$wdo_operation
                           @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt1_da4Vj ipv2_Xa5cM
                    of
                    { (# ipv4_i7IAy, ipv5_i7IAz #) ->
                    case putMVar#
                           @ RealWorld @ Handle__ dt1_da4Vj ipv5_i7IAz ipv4_i7IAy
                    of s2#_i9DsB
                    { __DEFAULT ->
                    (# s2#_i9DsB, GHC.Tuple.() #)
                    }
                    };
                  0# ->
                    maskAsyncExceptions#
                      @ ()
                      (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
                         case GHC.IO.Handle.Internals.$wdo_operation
                                @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt1_da4Vj s_i7IAv
                         of
                         { (# ipv4_i7IAy, ipv5_i7IAz #) ->
                         case putMVar#
                                @ RealWorld @ Handle__ dt1_da4Vj ipv5_i7IAz ipv4_i7IAy
                         of s2#_i9DsB
                         { __DEFAULT ->
                         (# s2#_i9DsB, GHC.Tuple.() #)
                         }
                         })
                      ipv2_Xa5cM
                }
                } } in
          case ipv1_ia56Y of {
            __DEFAULT ->
              case GHC.IO.Handle.Internals.$wdo_operation
                     @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt_da4Vi ipv_ia56X
              of
              { (# ipv2_i7IAy, ipv3_i7IAz #) ->
              case putMVar# @ RealWorld @ Handle__ dt_da4Vi ipv3_i7IAz ipv2_i7IAy
              of s2#_i9DsB
              { __DEFAULT ->
              jump $w$j_sa764 s2#_i9DsB
              }
              };
            0# ->
              case maskAsyncExceptions#
                     @ ()
                     (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
                        case GHC.IO.Handle.Internals.$wdo_operation
                               @ Handle__ fun_aa3FI wild_X2m act_aa3FL dt_da4Vi s_i7IAv
                        of
                        { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                        case putMVar# @ RealWorld @ Handle__ dt_da4Vi ipv3_i7IAz ipv2_i7IAy
                        of s2#_i9DsB
                        { __DEFAULT ->
                        (# s2#_i9DsB, GHC.Tuple.() #)
                        }
                        })
                     ipv_ia56X
              of
              { (# ipv2_i7JiK, ipv3_i7JiL #) ->
              jump $w$j_sa764 ipv2_i7JiK
              }
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 11, joins: 0/0}
withAllHandles__
  :: String -> Handle -> (Handle__ -> IO Handle__) -> IO ()
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.withAllHandles__1
               `cast` (<String>_R
                       ->_R <Handle>_R
                       ->_R <Handle__ -> IO Handle__>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (String
                           -> Handle
                           -> (Handle__ -> IO Handle__)
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (String
                               -> Handle -> (Handle__ -> IO Handle__) -> IO () :: *))}]
withAllHandles__
  = GHC.IO.Handle.Internals.withAllHandles__1
    `cast` (<String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO Handle__>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (String
                -> Handle
                -> (Handle__ -> IO Handle__)
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (String -> Handle -> (Handle__ -> IO Handle__) -> IO () :: *))

-- RHS size: {terms: 41, types: 73, coercions: 0, joins: 0/1}
GHC.IO.Handle.Internals.$wwithHandle' [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     String
     -> Handle
     -> MVar# RealWorld Handle__
     -> (Handle__ -> IO (Handle__, a))
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S,U><C(S),C(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 0 0] 139 0}]
GHC.IO.Handle.Internals.$wwithHandle'
  = \ (@ a_sa76a)
      (w_sa76b :: String)
      (w1_sa76c :: Handle)
      (ww_sa76i :: MVar# RealWorld Handle__)
      (w2_sa76e :: Handle__ -> IO (Handle__, a_sa76a))
      (w3_sa76f :: State# RealWorld) ->
      case getMaskingState# w3_sa76f of { (# ipv_ia56X, ipv1_ia56Y #) ->
      let {
        io_sa5nV [Dmd=<C(S),C(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, a_sa76a #)
        [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
        io_sa5nV
          = \ (s_i7IAv :: State# RealWorld) ->
              case GHC.IO.Handle.Internals.$wdo_operation
                     @ (Handle__, a_sa76a) w_sa76b w1_sa76c w2_sa76e ww_sa76i s_i7IAv
              of
              { (# ipv2_i7IAy, ipv3_i7IAz #) ->
              case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
              case putMVar# @ RealWorld @ Handle__ ww_sa76i h'_aa3Fs ipv2_i7IAy
              of s2#_i9DsB
              { __DEFAULT ->
              (# s2#_i9DsB, v_aa3Ft #)
              }
              }
              } } in
      case ipv1_ia56Y of {
        __DEFAULT -> io_sa5nV ipv_ia56X;
        0# -> maskAsyncExceptions# @ a_sa76a io_sa5nV ipv_ia56X
      }
      }

-- RHS size: {terms: 15, types: 19, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.withHandle1 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     String
     -> Handle
     -> MVar Handle__
     -> (Handle__ -> IO (Handle__, a))
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sa76a)
                 (w_sa76b [Occ=Once] :: String)
                 (w1_sa76c [Occ=Once] :: Handle)
                 (w2_sa76d [Occ=Once!] :: MVar Handle__)
                 (w3_sa76e [Occ=Once] :: Handle__ -> IO (Handle__, a_sa76a))
                 (w4_sa76f [Occ=Once] :: State# RealWorld) ->
                 case w2_sa76d of { MVar ww1_sa76i [Occ=Once] ->
                 GHC.IO.Handle.Internals.$wwithHandle'
                   @ a_sa76a w_sa76b w1_sa76c ww1_sa76i w3_sa76e w4_sa76f
                 }}]
GHC.IO.Handle.Internals.withHandle1
  = \ (@ a_sa76a)
      (w_sa76b :: String)
      (w1_sa76c :: Handle)
      (w2_sa76d :: MVar Handle__)
      (w3_sa76e :: Handle__ -> IO (Handle__, a_sa76a))
      (w4_sa76f :: State# RealWorld) ->
      case w2_sa76d of { MVar ww1_sa76i ->
      GHC.IO.Handle.Internals.$wwithHandle'
        @ a_sa76a w_sa76b w1_sa76c ww1_sa76i w3_sa76e w4_sa76f
      }

-- RHS size: {terms: 1, types: 0, coercions: 19, joins: 0/0}
withHandle'
  :: forall a.
     String
     -> Handle
     -> MVar Handle__
     -> (Handle__ -> IO (Handle__, a))
     -> IO a
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.withHandle1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <MVar Handle__>_R
                       ->_R <Handle__ -> IO (Handle__, a)>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> MVar Handle__
                           -> (Handle__ -> IO (Handle__, a))
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String
                               -> Handle
                               -> MVar Handle__
                               -> (Handle__ -> IO (Handle__, a))
                               -> IO a :: *))}]
withHandle'
  = GHC.IO.Handle.Internals.withHandle1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <MVar Handle__>_R
            ->_R <Handle__ -> IO (Handle__, a)>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> MVar Handle__
                -> (Handle__ -> IO (Handle__, a))
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String
                    -> Handle
                    -> MVar Handle__
                    -> (Handle__ -> IO (Handle__, a))
                    -> IO a :: *))

-- RHS size: {terms: 26, types: 42, coercions: 9, joins: 0/0}
GHC.IO.Handle.Internals.withHandle_'1
  :: forall a.
     String
     -> Handle
     -> MVar Handle__
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_aa4gi)
                 (fun_aa3FC [Occ=Once] :: String)
                 (h_aa3FD [Occ=Once] :: Handle)
                 (m_aa3FE [Occ=Once] :: MVar Handle__)
                 (act_aa3FF [Occ=OnceL!] :: Handle__ -> IO a_aa4gi)
                 (eta_X54 [Occ=Once] :: State# RealWorld) ->
                 GHC.IO.Handle.Internals.withHandle1
                   @ a_aa4gi
                   fun_aa3FC
                   h_aa3FD
                   m_aa3FE
                   ((\ (h__aa3FG :: Handle__)
                       (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                       case ((act_aa3FF h__aa3FG)
                             `cast` (GHC.Types.N:IO[0] <a_aa4gi>_R
                                     :: (IO a_aa4gi :: *)
                                        ~R# (State# RealWorld
                                             -> (# State# RealWorld, a_aa4gi #) :: *)))
                              s_i7IAv
                       of
                       { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once] #) ->
                       (# ipv_i7IAy, (h__aa3FG, ipv1_i7IAz) #)
                       })
                    `cast` (<Handle__>_R
                            ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gi)>_R)
                            :: (Handle__
                                -> State# RealWorld
                                -> (# State# RealWorld, (Handle__, a_aa4gi) #) :: *)
                               ~R# (Handle__ -> IO (Handle__, a_aa4gi) :: *)))
                   eta_X54}]
GHC.IO.Handle.Internals.withHandle_'1
  = \ (@ a_aa4gi)
      (fun_aa3FC :: String)
      (h_aa3FD :: Handle)
      (m_aa3FE :: MVar Handle__)
      (act_aa3FF :: Handle__ -> IO a_aa4gi)
      (eta_X54 :: State# RealWorld) ->
      case m_aa3FE of { MVar ww1_sa76i ->
      GHC.IO.Handle.Internals.$wwithHandle'
        @ a_aa4gi
        fun_aa3FC
        h_aa3FD
        ww1_sa76i
        ((\ (h__aa3FG :: Handle__) (s_i7IAv :: State# RealWorld) ->
            case ((act_aa3FF h__aa3FG)
                  `cast` (GHC.Types.N:IO[0] <a_aa4gi>_R
                          :: (IO a_aa4gi :: *)
                             ~R# (State# RealWorld -> (# State# RealWorld, a_aa4gi #) :: *)))
                   s_i7IAv
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            (# ipv_i7IAy, (h__aa3FG, ipv1_i7IAz) #)
            })
         `cast` (<Handle__>_R
                 ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gi)>_R)
                 :: (Handle__
                     -> State# RealWorld
                     -> (# State# RealWorld, (Handle__, a_aa4gi) #) :: *)
                    ~R# (Handle__ -> IO (Handle__, a_aa4gi) :: *)))
        eta_X54
      }

-- RHS size: {terms: 1, types: 0, coercions: 17, joins: 0/0}
withHandle_'
  :: forall a.
     String -> Handle -> MVar Handle__ -> (Handle__ -> IO a) -> IO a
[GblId,
 Arity=5,
 Str=<L,U><L,U><S(S),1*U(U)><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.withHandle_'1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <MVar Handle__>_R
                       ->_R <Handle__ -> IO a>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> MVar Handle__
                           -> (Handle__ -> IO a)
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String
                               -> Handle -> MVar Handle__ -> (Handle__ -> IO a) -> IO a :: *))}]
withHandle_'
  = GHC.IO.Handle.Internals.withHandle_'1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <MVar Handle__>_R
            ->_R <Handle__ -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> MVar Handle__
                -> (Handle__ -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String
                    -> Handle -> MVar Handle__ -> (Handle__ -> IO a) -> IO a :: *))

-- RHS size: {terms: 101, types: 189, coercions: 18, joins: 0/2}
withHandle_2_ra7PG
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=OtherCon []]
withHandle_2_ra7PG
  = \ (@ a_aa4gx)
      (fun_aa3Fu :: String)
      (h_aa3Fv :: Handle)
      (act_aa3Fx :: Handle__ -> IO a_aa4gx)
      (eta_X55 :: State# RealWorld) ->
      case h_aa3Fv of wild_X2q {
        FileHandle ds_da4Hf dt_da4Vk ->
          case getMaskingState# eta_X55 of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gx #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gx)
                         fun_aa3Fu
                         wild_X2q
                         ((\ (h__aa3FG :: Handle__) (s1_X7IGb :: State# RealWorld) ->
                             case ((act_aa3Fx h__aa3FG)
                                   `cast` (GHC.Types.N:IO[0] <a_aa4gx>_R
                                           :: (IO a_aa4gx :: *)
                                              ~R# (State# RealWorld
                                                   -> (# State# RealWorld, a_aa4gx #) :: *)))
                                    s1_X7IGb
                             of
                             { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                             (# ipv2_i7IAy, (h__aa3FG, ipv3_i7IAz) #)
                             })
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gx)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gx) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gx) :: *)))
                         dt_da4Vk
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vk h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gx io_sa5nV ipv_ia56X
          }
          };
        DuplexHandle ds_da4Hg dt_da4Vl dt1_da4Vm ->
          case getMaskingState# eta_X55 of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gx #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gx)
                         fun_aa3Fu
                         wild_X2q
                         ((\ (h__aa3FG :: Handle__) (s1_X7IGc :: State# RealWorld) ->
                             case ((act_aa3Fx h__aa3FG)
                                   `cast` (GHC.Types.N:IO[0] <a_aa4gx>_R
                                           :: (IO a_aa4gx :: *)
                                              ~R# (State# RealWorld
                                                   -> (# State# RealWorld, a_aa4gx #) :: *)))
                                    s1_X7IGc
                             of
                             { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                             (# ipv2_i7IAy, (h__aa3FG, ipv3_i7IAz) #)
                             })
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gx)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gx) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gx) :: *)))
                         dt_da4Vl
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vl h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gx io_sa5nV ipv_ia56X
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 14, joins: 0/0}
withHandle_ [InlPrag=INLINE (sat-args=3)]
  :: forall a. String -> Handle -> (Handle__ -> IO a) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=False,boring_ok=False)
         Tmpl= \ (@ a_Xa4jX)
                 (fun_Xa3IV [Occ=Once*] :: String)
                 (h_Xa3IX [Occ=Once!] :: Handle)
                 (act_Xa3J0 [Occ=OnceL*!] :: Handle__ -> IO a_Xa4jX) ->
                 case h_Xa3IX of wild_X2q {
                   FileHandle _ [Occ=Dead] dt_da4Vk ->
                     (\ (eta_X5c [Occ=Once] :: State# RealWorld) ->
                        let {
                          io_sa5nV [Occ=Once*]
                            :: State# RealWorld -> (# State# RealWorld, a_Xa4jX #)
                          [LclId, Arity=1, Unf=OtherCon []]
                          io_sa5nV
                            = \ (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                                case GHC.IO.Handle.Internals.withHandle_1
                                       @ (Handle__, a_Xa4jX)
                                       fun_Xa3IV
                                       wild_X2q
                                       ((\ (h__aa3FG :: Handle__)
                                           (s1_X7IGc [Occ=Once] :: State# RealWorld) ->
                                           case ((act_Xa3J0 h__aa3FG)
                                                 `cast` (GHC.Types.N:IO[0] <a_Xa4jX>_R
                                                         :: (IO a_Xa4jX :: *)
                                                            ~R# (State# RealWorld
                                                                 -> (# State# RealWorld,
                                                                       a_Xa4jX #) :: *)))
                                                  s1_X7IGc
                                           of
                                           { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once] #) ->
                                           (# ipv_i7IAy, (h__aa3FG, ipv1_i7IAz) #)
                                           })
                                        `cast` (<Handle__>_R
                                                ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_Xa4jX)>_R)
                                                :: (Handle__
                                                    -> State# RealWorld
                                                    -> (# State# RealWorld,
                                                          (Handle__, a_Xa4jX) #) :: *)
                                                   ~R# (Handle__ -> IO (Handle__, a_Xa4jX) :: *)))
                                       (GHC.MVar.MVar @ Handle__ dt_da4Vk)
                                       s_i7IAv
                                of
                                { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once!] #) ->
                                case ipv1_i7IAz of { (h'_aa3Fs [Occ=Once], v_aa3Ft [Occ=Once]) ->
                                case putMVar# @ RealWorld @ Handle__ dt_da4Vk h'_aa3Fs ipv_i7IAy
                                of s2#_i9DsB
                                { __DEFAULT ->
                                (# s2#_i9DsB, v_aa3Ft #)
                                }
                                }
                                } } in
                        case getMaskingState# eta_X5c of
                        { (# ipv_ia56X [Occ=Once*], ipv1_ia56Y [Occ=Once!] #) ->
                        case ipv1_ia56Y of {
                          __DEFAULT -> io_sa5nV ipv_ia56X;
                          0# -> maskAsyncExceptions# @ a_Xa4jX io_sa5nV ipv_ia56X
                        }
                        })
                     `cast` (Sym (GHC.Types.N:IO[0] <a_Xa4jX>_R)
                             :: (State# RealWorld -> (# State# RealWorld, a_Xa4jX #) :: *)
                                ~R# (IO a_Xa4jX :: *));
                   DuplexHandle _ [Occ=Dead] dt_da4Vl _ [Occ=Dead] ->
                     (\ (eta_X5d [Occ=Once] :: State# RealWorld) ->
                        let {
                          io_sa5nV [Occ=Once*]
                            :: State# RealWorld -> (# State# RealWorld, a_Xa4jX #)
                          [LclId, Arity=1, Unf=OtherCon []]
                          io_sa5nV
                            = \ (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                                case GHC.IO.Handle.Internals.withHandle_1
                                       @ (Handle__, a_Xa4jX)
                                       fun_Xa3IV
                                       wild_X2q
                                       ((\ (h__aa3FG :: Handle__)
                                           (s1_X7IGd [Occ=Once] :: State# RealWorld) ->
                                           case ((act_Xa3J0 h__aa3FG)
                                                 `cast` (GHC.Types.N:IO[0] <a_Xa4jX>_R
                                                         :: (IO a_Xa4jX :: *)
                                                            ~R# (State# RealWorld
                                                                 -> (# State# RealWorld,
                                                                       a_Xa4jX #) :: *)))
                                                  s1_X7IGd
                                           of
                                           { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once] #) ->
                                           (# ipv_i7IAy, (h__aa3FG, ipv1_i7IAz) #)
                                           })
                                        `cast` (<Handle__>_R
                                                ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_Xa4jX)>_R)
                                                :: (Handle__
                                                    -> State# RealWorld
                                                    -> (# State# RealWorld,
                                                          (Handle__, a_Xa4jX) #) :: *)
                                                   ~R# (Handle__ -> IO (Handle__, a_Xa4jX) :: *)))
                                       (GHC.MVar.MVar @ Handle__ dt_da4Vl)
                                       s_i7IAv
                                of
                                { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once!] #) ->
                                case ipv1_i7IAz of { (h'_aa3Fs [Occ=Once], v_aa3Ft [Occ=Once]) ->
                                case putMVar# @ RealWorld @ Handle__ dt_da4Vl h'_aa3Fs ipv_i7IAy
                                of s2#_i9DsB
                                { __DEFAULT ->
                                (# s2#_i9DsB, v_aa3Ft #)
                                }
                                }
                                } } in
                        case getMaskingState# eta_X5d of
                        { (# ipv_ia56X [Occ=Once*], ipv1_ia56Y [Occ=Once!] #) ->
                        case ipv1_ia56Y of {
                          __DEFAULT -> io_sa5nV ipv_ia56X;
                          0# -> maskAsyncExceptions# @ a_Xa4jX io_sa5nV ipv_ia56X
                        }
                        })
                     `cast` (Sym (GHC.Types.N:IO[0] <a_Xa4jX>_R)
                             :: (State# RealWorld -> (# State# RealWorld, a_Xa4jX #) :: *)
                                ~R# (IO a_Xa4jX :: *))
                 }}]
withHandle_
  = withHandle_2_ra7PG
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO a) -> IO a :: *))

-- RHS size: {terms: 103, types: 191, coercions: 14, joins: 0/2}
GHC.IO.Handle.Internals.wantReadableHandle_1
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 229 0 0] 418 0}]
GHC.IO.Handle.Internals.wantReadableHandle_1
  = \ (@ a_aa4gF)
      (fun_aa3Hm :: String)
      (h_aa3Hn :: Handle)
      (act_aa3Hp :: Handle__ -> IO a_aa4gF)
      (eta_X57 :: State# RealWorld) ->
      case h_aa3Hn of wild_X2y {
        FileHandle ds_da4Hy dt_da4Vn ->
          case getMaskingState# eta_X57 of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gF #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gF)
                         fun_aa3Hm
                         wild_X2y
                         ((\ (h__aa3FG :: Handle__) (s1_X7IGd :: State# RealWorld) ->
                             case GHC.IO.Handle.Internals.wantReadableHandle2
                                    @ a_aa4gF act_aa3Hp h__aa3FG s1_X7IGd
                             of
                             { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                             (# ipv2_i7IAy, (h__aa3FG, ipv3_i7IAz) #)
                             })
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gF)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gF) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gF) :: *)))
                         dt_da4Vn
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vn h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gF io_sa5nV ipv_ia56X
          }
          };
        DuplexHandle ds_da4Hz dt_da4Vo dt1_da4Vp ->
          case getMaskingState# eta_X57 of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gF #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gF)
                         fun_aa3Hm
                         wild_X2y
                         ((\ (h__aa3FG :: Handle__) (s1_X7IGe :: State# RealWorld) ->
                             case GHC.IO.Handle.Internals.wantReadableHandle2
                                    @ a_aa4gF act_aa3Hp h__aa3FG s1_X7IGe
                             of
                             { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                             (# ipv2_i7IAy, (h__aa3FG, ipv3_i7IAz) #)
                             })
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gF)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gF) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gF) :: *)))
                         dt_da4Vo
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vo h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gF io_sa5nV ipv_ia56X
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 14, joins: 0/0}
wantReadableHandle_
  :: forall a. String -> Handle -> (Handle__ -> IO a) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.wantReadableHandle_1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <Handle__ -> IO a>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> (Handle__ -> IO a)
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String -> Handle -> (Handle__ -> IO a) -> IO a :: *))}]
wantReadableHandle_
  = GHC.IO.Handle.Internals.wantReadableHandle_1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO a) -> IO a :: *))

-- RHS size: {terms: 15, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantSeekableHandle2
  :: forall a.
     String -> Handle -> State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=3, Str=<B,U><B,U><B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Internals.wantSeekableHandle2
  = \ (@ a_aa4gJ)
      (fun_aa3HR :: String)
      (h_aa3HS :: Handle)
      (eta_X58 :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_aa4gJ
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Just @ Handle h_aa3HS)
              GHC.IO.Exception.IllegalOperation
              fun_aa3HR
              GHC.IO.Handle.Internals.wantSeekableHandle5
              (GHC.Base.Nothing @ CInt)
              (GHC.Base.Nothing @ FilePath)))
        eta_X58

-- RHS size: {terms: 94, types: 209, coercions: 11, joins: 0/1}
GHC.IO.Handle.Internals.wantSeekableHandle1
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 60 60 0] 371 0}]
GHC.IO.Handle.Internals.wantSeekableHandle1
  = \ (@ a_aa4gJ)
      (fun_aa3HR :: String)
      (h_aa3HS :: Handle)
      (_act_aa3HT :: Handle__ -> IO a_aa4gJ)
      (eta_X5a :: State# RealWorld) ->
      case h_aa3HS of wild_X2z {
        FileHandle ds_da4HU dt_da4Vq ->
          case getMaskingState# eta_X5a of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gJ #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gJ)
                         fun_aa3HR
                         wild_X2z
                         ((\ (h__aa3FG :: Handle__) (s1_X7IGh :: State# RealWorld) ->
                             case h__aa3FG of wild1_X2I
                             { Handle__ @ dev_aa4aV @ enc_state_aa4aW @ dec_state_aa4aX
                                        $dIODevice_aa4aY $dBufferedIO_aa4aZ $dTypeable_aa4b0
                                        ds2_da4Dh ds3_da4Di dt1_da4UW ds4_da4Dk dt2_da4UX dt3_da4UY
                                        dt4_da4UZ ds5_da4Do ds6_da4Dp ds7_da4Dq ds8_da4Dr ds9_da4Ds
                                        ds10_da4Dt ->
                             case ds3_da4Di of {
                               __DEFAULT ->
                                 case ((IODevice.isSeekable @ dev_aa4aV $dIODevice_aa4aY ds2_da4Dh)
                                       `cast` (GHC.Types.N:IO[0] <Bool>_R
                                               :: (IO Bool :: *)
                                                  ~R# (State# RealWorld
                                                       -> (# State# RealWorld, Bool #) :: *)))
                                        s1_X7IGh
                                 of
                                 { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                                 case ipv3_i7IAz of {
                                   False ->
                                     case raiseIO#
                                            @ SomeException
                                            @ a_aa4gJ
                                            GHC.IO.Handle.Internals.wantSeekableHandle3
                                            ipv2_i7IAy
                                     of wild4_00 {
                                     };
                                   True ->
                                     case ((_act_aa3HT wild1_X2I)
                                           `cast` (GHC.Types.N:IO[0] <a_aa4gJ>_R
                                                   :: (IO a_aa4gJ :: *)
                                                      ~R# (State# RealWorld
                                                           -> (# State# RealWorld,
                                                                 a_aa4gJ #) :: *)))
                                            ipv2_i7IAy
                                     of
                                     { (# ipv4_X7IGR, ipv5_X7IGT #) ->
                                     (# ipv4_X7IGR, (wild1_X2I, ipv5_X7IGT) #)
                                     }
                                 }
                                 };
                               ClosedHandle ->
                                 case raiseIO#
                                        @ SomeException
                                        @ a_aa4gJ
                                        GHC.IO.Handle.Internals.wantReadableHandle11
                                        s1_X7IGh
                                 of wild3_00 {
                                 };
                               SemiClosedHandle ->
                                 case raiseIO#
                                        @ SomeException
                                        @ a_aa4gJ
                                        GHC.IO.Handle.Internals.wantReadableHandle7
                                        s1_X7IGh
                                 of wild3_00 {
                                 };
                               AppendHandle ->
                                 case raiseIO#
                                        @ SomeException
                                        @ a_aa4gJ
                                        GHC.IO.Handle.Internals.wantSeekableHandle3
                                        s1_X7IGh
                                 of wild3_00 {
                                 }
                             }
                             })
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gJ)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gJ) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gJ) :: *)))
                         dt_da4Vq
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vq h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gJ io_sa5nV ipv_ia56X
          }
          };
        DuplexHandle ds_da4HR dt_da4Vr dt1_da4Vs ->
          GHC.IO.Handle.Internals.wantSeekableHandle2
            @ a_aa4gJ fun_aa3HR wild_X2z eta_X5a
      }

-- RHS size: {terms: 1, types: 0, coercions: 14, joins: 0/0}
wantSeekableHandle
  :: forall a. String -> Handle -> (Handle__ -> IO a) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.wantSeekableHandle1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <Handle__ -> IO a>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> (Handle__ -> IO a)
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String -> Handle -> (Handle__ -> IO a) -> IO a :: *))}]
wantSeekableHandle
  = GHC.IO.Handle.Internals.wantSeekableHandle1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO a) -> IO a :: *))

-- RHS size: {terms: 243, types: 467, coercions: 18, joins: 1/1}
GHC.IO.Handle.Internals.$wwantWritableHandle' [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     String
     -> Handle
     -> MVar# RealWorld Handle__
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=5,
 Str=<L,U><L,U><S,U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 60 0] 701 0}]
GHC.IO.Handle.Internals.$wwantWritableHandle'
  = \ (@ a_sa76M)
      (w_sa76N :: String)
      (w1_sa76O :: Handle)
      (ww_sa76U :: MVar# RealWorld Handle__)
      (w2_sa76Q :: Handle__ -> IO a_sa76M)
      (w3_sa76R :: State# RealWorld) ->
      GHC.IO.Handle.Internals.$wwithHandle'
        @ a_sa76M
        w_sa76N
        w1_sa76O
        ww_sa76U
        ((\ (h__aa3FG :: Handle__) (s_i7IAv :: State# RealWorld) ->
            case h__aa3FG of wild_X2E
            { Handle__ @ dev_aa4o6 @ enc_state_aa4o7 @ dec_state_aa4o8
                       $dIODevice_aa4o9 $dBufferedIO_aa4oa $dTypeable_aa4ob ds_da4Qq
                       ds1_da4Qr dt_da4W8 ds2_da4Qt dt1_da4W9 dt2_da4Wa dt3_da4Wb
                       ds3_da4Qx ds4_da4Qy ds5_da4Qz ds6_da4QA ds7_da4QB ds8_da4QC ->
            case ds1_da4Qr of {
              __DEFAULT ->
                case ((w2_sa76Q wild_X2E)
                      `cast` (GHC.Types.N:IO[0] <a_sa76M>_R
                              :: (IO a_sa76M :: *)
                                 ~R# (State# RealWorld -> (# State# RealWorld, a_sa76M #) :: *)))
                       s_i7IAv
                of
                { (# ipv_i7IAy, ipv1_i7IAz #) ->
                (# ipv_i7IAy, (wild_X2E, ipv1_i7IAz) #)
                };
              ClosedHandle ->
                case raiseIO#
                       @ SomeException
                       @ a_sa76M
                       GHC.IO.Handle.Internals.wantReadableHandle11
                       s_i7IAv
                of wild2_00 {
                };
              SemiClosedHandle ->
                case raiseIO#
                       @ SomeException
                       @ a_sa76M
                       GHC.IO.Handle.Internals.wantReadableHandle7
                       s_i7IAv
                of wild2_00 {
                };
              ReadHandle ->
                case raiseIO#
                       @ SomeException
                       @ a_sa76M
                       GHC.IO.Handle.Internals.wantWritableHandle2
                       s_i7IAv
                of wild2_00 {
                };
              ReadWriteHandle ->
                case readMutVar#
                       @ RealWorld @ (Buffer CharBufElem) dt2_da4Wa s_i7IAv
                of
                { (# ipv_i7IAy, ipv1_i7IAz #) ->
                case ipv1_i7IAz of
                { Buffer dt4_ia4xp dt5_ia4xq ds10_ia4xr dt6_ia4xs dt7_ia4xt
                         dt8_ia4xu ->
                case ds10_ia4xr of {
                  ReadBuffer ->
                    case readMutVar#
                           @ RealWorld @ (Buffer CharBufElem) dt2_da4Wa ipv_i7IAy
                    of
                    { (# ipv2_X7IF2, ipv3_X7IF4 #) ->
                    case ipv3_X7IF4 of
                    { Buffer dt9_Xa4BY dt10_Xa4C0 ds12_Xa4C2 dt11_Xa4C4 dt12_Xa4C6
                             dt13_Xa4C8 ->
                    join {
                      $w$j_sa76L [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U)>]
                        :: State# RealWorld -> (# State# RealWorld, (Handle__, a_sa76M) #)
                      [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                      $w$j_sa76L (w4_sa76J [OS=OneShot] :: State# RealWorld)
                        = case GHC.IO.Handle.Internals.flushBuffer2 wild_X2E w4_sa76J of
                          { (# ipv4_X7Jmc, ipv5_X7Jme #) ->
                          case readMutVar#
                                 @ RealWorld @ (Buffer CharBufElem) dt2_da4Wa ipv4_X7Jmc
                          of
                          { (# ipv6_X7IE7, ipv7_X7IE9 #) ->
                          case writeMutVar#
                                 @ RealWorld
                                 @ (Buffer CharBufElem)
                                 dt2_da4Wa
                                 (case ipv7_X7IE9 of
                                  { Buffer dt14_da4Wc dt15_da4Wd ds15_da4PA dt16_da4We dt17_da4Wf
                                           dt18_da4Wg ->
                                  GHC.IO.Buffer.Buffer
                                    @ CharBufElem
                                    dt14_da4Wc
                                    dt15_da4Wd
                                    GHC.IO.Buffer.WriteBuffer
                                    dt16_da4We
                                    dt17_da4Wf
                                    dt18_da4Wg
                                  })
                                 ipv6_X7IE7
                          of s2#_i7IBe
                          { __DEFAULT ->
                          case readMutVar# @ RealWorld @ (Buffer Word8) dt_da4W8 s2#_i7IBe of
                          { (# ipv8_X7IEl, ipv9_X7IEn #) ->
                          case ((Buffered.emptyWriteBuffer
                                   @ dev_aa4o6 $dBufferedIO_aa4oa ds_da4Qq ipv9_X7IEn)
                                `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                        :: (IO (Buffer Word8) :: *)
                                           ~R# (State# RealWorld
                                                -> (# State# RealWorld, Buffer Word8 #) :: *)))
                                 ipv8_X7IEl
                          of
                          { (# ipv10_X7IEq, ipv11_X7IEs #) ->
                          case writeMutVar#
                                 @ RealWorld @ (Buffer Word8) dt_da4W8 ipv11_X7IEs ipv10_X7IEq
                          of s2#1_X7II9
                          { __DEFAULT ->
                          case ((w2_sa76Q wild_X2E)
                                `cast` (GHC.Types.N:IO[0] <a_sa76M>_R
                                        :: (IO a_sa76M :: *)
                                           ~R# (State# RealWorld
                                                -> (# State# RealWorld, a_sa76M #) :: *)))
                                 s2#1_X7II9
                          of
                          { (# ipv12_X7IH2, ipv13_X7IH4 #) ->
                          (# ipv12_X7IH2, (wild_X2E, ipv13_X7IH4) #)
                          }
                          }
                          }
                          }
                          }
                          }
                          } } in
                    case ds12_Xa4C2 of {
                      ReadBuffer ->
                        case ==# dt12_Xa4C6 dt13_Xa4C8 of {
                          __DEFAULT ->
                            case readMutVar#
                                   @ RealWorld
                                   @ (dec_state_aa4o8, Buffer Word8)
                                   dt1_da4W9
                                   ipv2_X7IF2
                            of
                            { (# ipv4_X7ID4, ipv5_X7ID6 #) ->
                            case ipv5_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
                            case readMutVar#
                                   @ RealWorld @ (Buffer CharBufElem) dt2_da4Wa ipv4_X7ID4
                            of
                            { (# ipv6_X7IDi, ipv7_X7IDk #) ->
                            case writeMutVar#
                                   @ RealWorld
                                   @ (Buffer CharBufElem)
                                   dt2_da4Wa
                                   (case ipv7_X7IDk of
                                    { Buffer dt14_da4VG dt15_da4VH ds15_da4LG dt16_da4VI dt17_da4VJ
                                             dt18_da4VK ->
                                    GHC.IO.Buffer.Buffer
                                      @ CharBufElem
                                      dt14_da4VG
                                      dt15_da4VH
                                      ds15_da4LG
                                      dt16_da4VI
                                      0#
                                      0#
                                    })
                                   ipv6_X7IDi
                            of s2#_i7IBe
                            { __DEFAULT ->
                            case ipv7_X7IDk of
                            { Buffer dt14_ia4zH dt15_ia4zI ds15_ia4zJ dt16_ia4zK dt17_ia4zL
                                     dt18_ia4zM ->
                            case dt17_ia4zL of wild8_X5i {
                              __DEFAULT ->
                                case ds4_da4Qy of {
                                  Nothing ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_da4W8
                                           (case bbuf0_aa3K7 of
                                            { Buffer dt19_da4VL dt20_da4VM ds16_da4LW dt21_da4VN
                                                     dt22_da4VO dt23_da4VP ->
                                            GHC.IO.Buffer.Buffer
                                              @ Word8
                                              dt19_da4VL
                                              dt20_da4VM
                                              ds16_da4LW
                                              dt21_da4VN
                                              (+# dt22_da4VO wild8_X5i)
                                              dt23_da4VP
                                            })
                                           s2#_i7IBe
                                    of s2#1_X7IH7
                                    { __DEFAULT ->
                                    jump $w$j_sa76L s2#1_X7IH7
                                    };
                                  Just decoder_aa3K9 ->
                                    case decoder_aa3K9 of
                                    { BufferCodec ds16_ia4Mf ds17_ia4Mg ds18_ia4Mh ds19_ia4Mi
                                                  ds20_ia4Mj ->
                                    case ((ds20_ia4Mj codec_state_aa3K6)
                                          `cast` (GHC.Types.N:IO[0] <()>_R
                                                  :: (IO () :: *)
                                                     ~R# (State# RealWorld
                                                          -> (# State# RealWorld, () #) :: *)))
                                           s2#_i7IBe
                                    of
                                    { (# ipv8_X7JlR, ipv9_X7JlT #) ->
                                    case GHC.IO.Handle.Internals.$wstreamEncode
                                           @ Word8
                                           @ CharBufElem
                                           @ dec_state_aa4o8
                                           ds16_ia4Mf
                                           ds17_ia4Mg
                                           bbuf0_aa3K7
                                           (GHC.IO.Buffer.Buffer
                                              @ CharBufElem
                                              dt14_ia4zH
                                              dt15_ia4zI
                                              ds15_ia4zJ
                                              wild8_X5i
                                              0#
                                              0#)
                                           ipv8_X7JlR
                                    of
                                    { (# ipv10_X7IGW, ipv11_X7IDM #) ->
                                    case ipv11_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_da4W8
                                           bbuf1_aa3Ka
                                           ipv10_X7IGW
                                    of s2#1_X7IHx
                                    { __DEFAULT ->
                                    jump $w$j_sa76L s2#1_X7IHx
                                    }
                                    }
                                    }
                                    }
                                    }
                                };
                              0# ->
                                case writeMutVar#
                                       @ RealWorld @ (Buffer Word8) dt_da4W8 bbuf0_aa3K7 s2#_i7IBe
                                of s2#1_X7IH3
                                { __DEFAULT ->
                                jump $w$j_sa76L s2#1_X7IH3
                                }
                            }
                            }
                            }
                            }
                            }
                            };
                          1# -> jump $w$j_sa76L ipv2_X7IF2
                        };
                      WriteBuffer -> jump $w$j_sa76L ipv2_X7IF2
                    }
                    }
                    };
                  WriteBuffer ->
                    case ((w2_sa76Q wild_X2E)
                          `cast` (GHC.Types.N:IO[0] <a_sa76M>_R
                                  :: (IO a_sa76M :: *)
                                     ~R# (State# RealWorld
                                          -> (# State# RealWorld, a_sa76M #) :: *)))
                           ipv_i7IAy
                    of
                    { (# ipv2_X7IH2, ipv3_X7IH4 #) ->
                    (# ipv2_X7IH2, (wild_X2E, ipv3_X7IH4) #)
                    }
                }
                }
                }
            }
            })
         `cast` (<Handle__>_R
                 ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_sa76M)>_R)
                 :: (Handle__
                     -> State# RealWorld
                     -> (# State# RealWorld, (Handle__, a_sa76M) #) :: *)
                    ~R# (Handle__ -> IO (Handle__, a_sa76M) :: *)))
        w3_sa76R

-- RHS size: {terms: 21, types: 23, coercions: 0, joins: 0/0}
GHC.IO.Handle.Internals.wantWritableHandle1
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO a)
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0 80 0 0] 120 0}]
GHC.IO.Handle.Internals.wantWritableHandle1
  = \ (@ a_aa4p8)
      (fun_aa3Gf :: String)
      (h_aa3Gg :: Handle)
      (act_aa3Gi :: Handle__ -> IO a_aa4p8)
      (eta_X5d :: State# RealWorld) ->
      case h_aa3Gg of wild_X2B {
        FileHandle ds_da4QS dt_da4Wh ->
          GHC.IO.Handle.Internals.$wwantWritableHandle'
            @ a_aa4p8 fun_aa3Gf wild_X2B dt_da4Wh act_aa3Gi eta_X5d;
        DuplexHandle ds_da4QT dt_da4Wi dt1_da4Wj ->
          GHC.IO.Handle.Internals.$wwantWritableHandle'
            @ a_aa4p8 fun_aa3Gf wild_X2B dt1_da4Wj act_aa3Gi eta_X5d
      }

-- RHS size: {terms: 1, types: 0, coercions: 14, joins: 0/0}
wantWritableHandle
  :: forall a. String -> Handle -> (Handle__ -> IO a) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.wantWritableHandle1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <Handle__ -> IO a>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> (Handle__ -> IO a)
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String -> Handle -> (Handle__ -> IO a) -> IO a :: *))}]
wantWritableHandle
  = GHC.IO.Handle.Internals.wantWritableHandle1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO a>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO a)
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO a) -> IO a :: *))

-- RHS size: {terms: 79, types: 141, coercions: 0, joins: 0/2}
withHandle2_ra7PH
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO (Handle__, a))
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId, Arity=4, Str=<L,U><S,1*U><C(S),C(U)><S,U>, Unf=OtherCon []]
withHandle2_ra7PH
  = \ (@ a_aa4gR)
      (fun_aa3Fg :: String)
      (h_aa3Fh :: Handle)
      (act_aa3Fj :: Handle__ -> IO (Handle__, a_aa4gR))
      (eta_X5f :: State# RealWorld) ->
      case h_aa3Fh of wild_X2C {
        FileHandle ds_da4Ia dt_da4Vt ->
          case getMaskingState# eta_X5f of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gR #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gR) fun_aa3Fg wild_X2C act_aa3Fj dt_da4Vt s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vt h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gR io_sa5nV ipv_ia56X
          }
          };
        DuplexHandle ds_da4Ib dt_da4Vu dt1_da4Vv ->
          case getMaskingState# eta_X5f of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gR #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gR) fun_aa3Fg wild_X2C act_aa3Fj dt_da4Vu s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vu h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gR io_sa5nV ipv_ia56X
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 16, joins: 0/0}
withHandle [InlPrag=INLINE (sat-args=3)]
  :: forall a.
     String -> Handle -> (Handle__ -> IO (Handle__, a)) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><C(S),C(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=False,boring_ok=False)
         Tmpl= \ (@ a_Xa4kM)
                 (fun_Xa3Jc [Occ=Once*] :: String)
                 (h_Xa3Je [Occ=Once!] :: Handle)
                 (act_Xa3Jh [Occ=Once*] :: Handle__ -> IO (Handle__, a_Xa4kM)) ->
                 case h_Xa3Je of wild_X2C {
                   FileHandle _ [Occ=Dead] dt_da4Vt [Occ=Once] ->
                     (GHC.IO.Handle.Internals.withHandle1
                        @ a_Xa4kM
                        fun_Xa3Jc
                        wild_X2C
                        (GHC.MVar.MVar @ Handle__ dt_da4Vt)
                        act_Xa3Jh)
                     `cast` (Sym (GHC.Types.N:IO[0] <a_Xa4kM>_R)
                             :: (State# RealWorld -> (# State# RealWorld, a_Xa4kM #) :: *)
                                ~R# (IO a_Xa4kM :: *));
                   DuplexHandle _ [Occ=Dead] dt_da4Vu [Occ=Once] _ [Occ=Dead] ->
                     (GHC.IO.Handle.Internals.withHandle1
                        @ a_Xa4kM
                        fun_Xa3Jc
                        wild_X2C
                        (GHC.MVar.MVar @ Handle__ dt_da4Vu)
                        act_Xa3Jh)
                     `cast` (Sym (GHC.Types.N:IO[0] <a_Xa4kM>_R)
                             :: (State# RealWorld -> (# State# RealWorld, a_Xa4kM #) :: *)
                                ~R# (IO a_Xa4kM :: *))
                 }}]
withHandle
  = withHandle2_ra7PH
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO (Handle__, a)>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO (Handle__, a))
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO (Handle__, a)) -> IO a :: *))

-- RHS size: {terms: 81, types: 147, coercions: 14, joins: 0/2}
GHC.IO.Handle.Internals.wantReadableHandle1
  :: forall a.
     String
     -> Handle
     -> (Handle__ -> IO (Handle__, a))
     -> State# RealWorld
     -> (# State# RealWorld, a #)
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 189 0 0] 338 0}]
GHC.IO.Handle.Internals.wantReadableHandle1
  = \ (@ a_aa4gV)
      (fun_aa3Hj :: String)
      (h_aa3Hk :: Handle)
      (act_aa3Hl :: Handle__ -> IO (Handle__, a_aa4gV))
      (eta_X5h :: State# RealWorld) ->
      case h_aa3Hk of wild_X2C {
        FileHandle ds_da4Ia dt_da4Vt ->
          case getMaskingState# eta_X5h of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gV #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gV)
                         fun_aa3Hj
                         wild_X2C
                         ((GHC.IO.Handle.Internals.wantReadableHandle2
                             @ (Handle__, a_aa4gV) act_aa3Hl)
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gV)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gV) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gV) :: *)))
                         dt_da4Vt
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vt h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gV io_sa5nV ipv_ia56X
          }
          };
        DuplexHandle ds_da4Ib dt_da4Vu dt1_da4Vv ->
          case getMaskingState# eta_X5h of { (# ipv_ia56X, ipv1_ia56Y #) ->
          let {
            io_sa5nV [Dmd=<C(S),C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, a_aa4gV #)
            [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
            io_sa5nV
              = \ (s_i7IAv :: State# RealWorld) ->
                  case GHC.IO.Handle.Internals.$wdo_operation
                         @ (Handle__, a_aa4gV)
                         fun_aa3Hj
                         wild_X2C
                         ((GHC.IO.Handle.Internals.wantReadableHandle2
                             @ (Handle__, a_aa4gV) act_aa3Hl)
                          `cast` (<Handle__>_R
                                  ->_R Sym (GHC.Types.N:IO[0] <(Handle__, a_aa4gV)>_R)
                                  :: (Handle__
                                      -> State# RealWorld
                                      -> (# State# RealWorld, (Handle__, a_aa4gV) #) :: *)
                                     ~R# (Handle__ -> IO (Handle__, a_aa4gV) :: *)))
                         dt_da4Vu
                         s_i7IAv
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of { (h'_aa3Fs, v_aa3Ft) ->
                  case putMVar# @ RealWorld @ Handle__ dt_da4Vu h'_aa3Fs ipv2_i7IAy
                  of s2#_i9DsB
                  { __DEFAULT ->
                  (# s2#_i9DsB, v_aa3Ft #)
                  }
                  }
                  } } in
          case ipv1_ia56Y of {
            __DEFAULT -> io_sa5nV ipv_ia56X;
            0# -> maskAsyncExceptions# @ a_aa4gV io_sa5nV ipv_ia56X
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 16, joins: 0/0}
wantReadableHandle
  :: forall a.
     String -> Handle -> (Handle__ -> IO (Handle__, a)) -> IO a
[GblId,
 Arity=4,
 Str=<L,U><S,1*U><L,C(C1(U(U,U)))><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Internals.wantReadableHandle1
               `cast` (forall (a :: <*>_N).
                       <String>_R
                       ->_R <Handle>_R
                       ->_R <Handle__ -> IO (Handle__, a)>_R
                       ->_R Sym (GHC.Types.N:IO[0] <a>_R)
                       :: (forall a.
                           String
                           -> Handle
                           -> (Handle__ -> IO (Handle__, a))
                           -> State# RealWorld
                           -> (# State# RealWorld, a #) :: *)
                          ~R# (forall a.
                               String -> Handle -> (Handle__ -> IO (Handle__, a)) -> IO a :: *))}]
wantReadableHandle
  = GHC.IO.Handle.Internals.wantReadableHandle1
    `cast` (forall (a :: <*>_N).
            <String>_R
            ->_R <Handle>_R
            ->_R <Handle__ -> IO (Handle__, a)>_R
            ->_R Sym (GHC.Types.N:IO[0] <a>_R)
            :: (forall a.
                String
                -> Handle
                -> (Handle__ -> IO (Handle__, a))
                -> State# RealWorld
                -> (# State# RealWorld, a #) :: *)
               ~R# (forall a.
                    String -> Handle -> (Handle__ -> IO (Handle__, a)) -> IO a :: *))


