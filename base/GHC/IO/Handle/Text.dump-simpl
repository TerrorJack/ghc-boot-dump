
==================== Tidy Core ====================
2018-03-16 16:06:02.437358526 UTC

Result size of Tidy Core
  = {terms: 4,520, types: 6,664, coercions: 442, joins: 29/51}

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl_rb6WB :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl_rb6WB = "illegal buffer size "#

-- RHS size: {terms: 26, types: 23, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$willegalBufferSize [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> String -> Int# -> State# RealWorld -> (# State# RealWorld, a #)
[GblId, Arity=4, Str=<B,U><B,U><B,U><B,U>x, Unf=OtherCon []]
GHC.IO.Handle.Text.$willegalBufferSize
  = \ (@ a_sb666)
      (w_sb667 :: Handle)
      (w1_sb668 :: String)
      (ww_sb66d :: Int#)
      (w2_sb66a :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ a_sb666
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Just @ Handle w_sb667)
              GHC.IO.Exception.InvalidArgument
              w1_sb668
              (unpackAppendCString#
                 lvl_rb6WB
                 (case GHC.Show.$wshowSignedInt 9# ww_sb66d (GHC.Types.[] @ Char) of
                  { (# ww5_i7NVe, ww6_i7NVf #) ->
                  GHC.Types.: @ Char ww5_i7NVe ww6_i7NVf
                  }))
              (GHC.Base.Nothing @ CInt)
              (GHC.Base.Nothing @ FilePath)))
        w2_sb66a

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$trModule4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.$trModule4 = "base"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$trModule3 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Text.$trModule3
  = GHC.Types.TrNameS GHC.IO.Handle.Text.$trModule4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$trModule2 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 60 0}]
GHC.IO.Handle.Text.$trModule2 = "GHC.IO.Handle.Text"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$trModule1 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Text.$trModule1
  = GHC.Types.TrNameS GHC.IO.Handle.Text.$trModule2

-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.$trModule :: Module
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 30}]
GHC.IO.Handle.Text.$trModule
  = GHC.Types.Module
      GHC.IO.Handle.Text.$trModule3 GHC.IO.Handle.Text.$trModule1

-- RHS size: {terms: 25, types: 37, coercions: 0, joins: 0/0}
memcpy1_rb6WC
  :: forall a.
     Ptr a
     -> Ptr a
     -> Word64
     -> State# RealWorld
     -> (# State# RealWorld, Ptr () #)
[GblId,
 Arity=4,
 Caf=NoCafRefs,
 Str=<S(S),1*U(U)><S(S),1*U(U)><S(S),1*U(U)><S,U>,
 Unf=OtherCon []]
memcpy1_rb6WC
  = \ (@ a_ab2jG)
      (ds_db3r6 :: Ptr a_ab2jG)
      (ds1_db3r7 :: Ptr a_ab2jG)
      (ds2_db3r8 :: Word64)
      (eta_B1 :: State# RealWorld) ->
      case ds_db3r6 of { GHC.Ptr.Ptr ds4_db3ra ->
      case ds1_db3r7 of { GHC.Ptr.Ptr ds6_db3rc ->
      case ds2_db3r8 of { GHC.Word.W64# ds8_db3re ->
      case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
             ds4_db3ra ds6_db3rc ds8_db3re eta_B1
      of
      { (# ds9_db3rg, ds10_db3rf #) ->
      (# ds9_db3rg, GHC.Ptr.Ptr @ () ds10_db3rf #)
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 16, joins: 0/0}
memcpy :: forall a. Ptr a -> Ptr a -> CSize -> IO (Ptr ())
[GblId,
 Arity=4,
 Caf=NoCafRefs,
 Str=<S(S),1*U(U)><S(S),1*U(U)><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=False,boring_ok=False)
         Tmpl= (\ (@ a_Xb2kE)
                  (ds_Xb3s5 [Occ=Once!] :: Ptr a_Xb2kE)
                  (ds1_Xb3s7 [Occ=Once!] :: Ptr a_Xb2kE)
                  (ds2_Xb3s9 [Occ=Once!] :: Word64) ->
                  case ds_Xb3s5 of { GHC.Ptr.Ptr ds4_db3ra [Occ=Once] ->
                  case ds1_Xb3s7 of { GHC.Ptr.Ptr ds6_db3rc [Occ=Once] ->
                  case ds2_Xb3s9 of { GHC.Word.W64# ds8_db3re [Occ=Once] ->
                  (\ (ds9_db3rh [Occ=Once] :: State# RealWorld) ->
                     case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                            ds4_db3ra ds6_db3rc ds8_db3re ds9_db3rh
                     of
                     { (# ds10_db3rg [Occ=Once], ds11_db3rf [Occ=Once] #) ->
                     (# ds10_db3rg, GHC.Ptr.Ptr @ () ds11_db3rf #)
                     })
                  `cast` (Sym (GHC.Types.N:IO[0] <Ptr ()>_R)
                          :: (State# RealWorld -> (# State# RealWorld, Ptr () #) :: *)
                             ~R# (IO (Ptr ()) :: *))
                  }
                  }
                  })
               `cast` (forall (a :: <*>_N).
                       <Ptr a>_R
                       ->_R <Ptr a>_R
                       ->_R Sym (Foreign.C.Types.N:CSize[0])
                       ->_R <IO (Ptr ())>_R
                       :: (forall a. Ptr a -> Ptr a -> Word64 -> IO (Ptr ()) :: *)
                          ~R# (forall a. Ptr a -> Ptr a -> CSize -> IO (Ptr ()) :: *))}]
memcpy
  = memcpy1_rb6WC
    `cast` (forall (a :: <*>_N).
            <Ptr a>_R
            ->_R <Ptr a>_R
            ->_R Sym (Foreign.C.Types.N:CSize[0])
            ->_R Sym (GHC.Types.N:IO[0] <Ptr ()>_R)
            :: (forall a.
                Ptr a
                -> Ptr a
                -> Word64
                -> State# RealWorld
                -> (# State# RealWorld, Ptr () #) :: *)
               ~R# (forall a. Ptr a -> Ptr a -> CSize -> IO (Ptr ()) :: *))

-- RHS size: {terms: 233, types: 342, coercions: 3, joins: 0/0}
GHC.IO.Handle.Text.$wcommitBuffer' [InlPrag=NOUSERINLINE[0]]
  :: Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> Int#
     -> Int#
     -> Bool
     -> Bool
     -> Handle__
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=8,
 Caf=NoCafRefs,
 Str=<S,U><L,U><S,U><S,U><L,1*U><L,1*U><S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 0 137 120 20 0] 537 270}]
GHC.IO.Handle.Text.$wcommitBuffer'
  = \ (ww_sb66p :: Addr#)
      (ww1_sb66q :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sb66u :: Int#)
      (ww3_sb66y :: Int#)
      (w_sb66j :: Bool)
      (w1_sb66k :: Bool)
      (w2_sb66l :: Handle__)
      (w3_sb66m :: State# RealWorld) ->
      case w2_sb66l of wild_Xk
      { Handle__ @ dev_ab2Ev @ enc_state_ab2Ew @ dec_state_ab2Ex
                 $dIODevice_ab2Ey $dBufferedIO_ab2Ez $dTypeable_ab2EA ds_db3c7
                 ds1_db3c8 dt_db3t9 ds2_db3ca dt1_db3ta dt2_db3tb dt3_db3tc
                 ds3_db3ce ds4_db3cf ds5_db3cg ds6_db3ch ds7_db3ci ds8_db3cj ->
      case GHC.IO.Handle.Internals.$wwriteCharBuffer
             wild_Xk
             ww_sb66p
             ww1_sb66q
             GHC.IO.Buffer.WriteBuffer
             ww2_sb66u
             0#
             ww3_sb66y
             w3_sb66m
      of
      { (# ipv_X7JkB, ipv1_i7JiL #) ->
      case w_sb66j of {
        False ->
          case w1_sb66k of {
            False ->
              (# ipv_X7JkB,
                 GHC.IO.Buffer.Buffer
                   @ CharBufElem
                   ww_sb66p
                   ww1_sb66q
                   GHC.IO.Buffer.WriteBuffer
                   ww2_sb66u
                   0#
                   ww3_sb66y #);
            True ->
              case readMutVar#
                     @ RealWorld @ (Buffer CharBufElem) dt2_db3tb ipv_X7JkB
              of
              { (# ipv2_i7IAy, ipv3_i7IAz #) ->
              case ipv3_i7IAz of
              { Buffer dt4_db3td dt5_db3te ds11_db3br dt6_db3tf dt7_db3tg
                       dt8_db3th ->
              case ==# ww2_sb66u dt6_db3tf of {
                __DEFAULT ->
                  (# ipv2_i7IAy,
                     GHC.IO.Buffer.Buffer
                       @ CharBufElem
                       ww_sb66p
                       ww1_sb66q
                       GHC.IO.Buffer.WriteBuffer
                       ww2_sb66u
                       0#
                       ww3_sb66y #);
                1# ->
                  case readMutVar#
                         @ RealWorld @ (BufferList CharBufElem) dt3_db3tc ipv2_i7IAy
                  of
                  { (# ipv4_X7ID2, ipv5_X7ID4 #) ->
                  case writeMutVar#
                         @ RealWorld
                         @ (BufferList CharBufElem)
                         dt3_db3tc
                         (GHC.IO.Handle.Types.BufferListCons
                            @ CharBufElem
                            (GHC.ForeignPtr.ForeignPtr @ CharBufElem ww_sb66p ww1_sb66q)
                            ipv5_X7ID4)
                         ipv4_X7ID2
                  of s2#_i7IBe
                  { __DEFAULT ->
                  (# s2#_i7IBe,
                     GHC.IO.Buffer.Buffer
                       @ CharBufElem
                       ww_sb66p
                       ww1_sb66q
                       GHC.IO.Buffer.WriteBuffer
                       ww2_sb66u
                       0#
                       ww3_sb66y #)
                  }
                  }
              }
              }
              }
          };
        True ->
          case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3t9 ipv_X7JkB of
          { (# ipv2_i7IAy, ipv3_i7IAz #) ->
          case ipv3_i7IAz of wild2_ia4we
          { Buffer dt4_ia4wr dt5_ia4ws ds11_ia4wz dt6_ia4wA dt7_ia4wB
                   dt8_ia4wC ->
          case ==# dt7_ia4wB dt8_ia4wC of {
            __DEFAULT ->
              case ((Buffered.flushWriteBuffer
                       @ dev_ab2Ev $dBufferedIO_ab2Ez ds_db3c7 wild2_ia4we)
                    `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                            :: (IO (Buffer Word8) :: *)
                               ~R# (State# RealWorld
                                    -> (# State# RealWorld, Buffer Word8 #) :: *)))
                     ipv2_i7IAy
              of
              { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
              case writeMutVar#
                     @ RealWorld @ (Buffer Word8) dt_db3t9 ipv5_X7ICQ ipv4_X7ICO
              of s2#_i7IBe
              { __DEFAULT ->
              case w1_sb66k of {
                False ->
                  (# s2#_i7IBe,
                     GHC.IO.Buffer.Buffer
                       @ CharBufElem
                       ww_sb66p
                       ww1_sb66q
                       GHC.IO.Buffer.WriteBuffer
                       ww2_sb66u
                       0#
                       ww3_sb66y #);
                True ->
                  case readMutVar#
                         @ RealWorld @ (Buffer CharBufElem) dt2_db3tb s2#_i7IBe
                  of
                  { (# ipv6_X7IEj, ipv7_X7IEl #) ->
                  case ipv7_X7IEl of
                  { Buffer dt10_db3td dt11_db3te ds14_db3br dt12_db3tf dt13_db3tg
                           dt14_db3th ->
                  case ==# ww2_sb66u dt12_db3tf of {
                    __DEFAULT ->
                      (# ipv6_X7IEj,
                         GHC.IO.Buffer.Buffer
                           @ CharBufElem
                           ww_sb66p
                           ww1_sb66q
                           GHC.IO.Buffer.WriteBuffer
                           ww2_sb66u
                           0#
                           ww3_sb66y #);
                    1# ->
                      case readMutVar#
                             @ RealWorld @ (BufferList CharBufElem) dt3_db3tc ipv6_X7IEj
                      of
                      { (# ipv8_X7ID2, ipv9_X7ID4 #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (BufferList CharBufElem)
                             dt3_db3tc
                             (GHC.IO.Handle.Types.BufferListCons
                                @ CharBufElem
                                (GHC.ForeignPtr.ForeignPtr @ CharBufElem ww_sb66p ww1_sb66q)
                                ipv9_X7ID4)
                             ipv8_X7ID2
                      of s2#1_X7IFk
                      { __DEFAULT ->
                      (# s2#1_X7IFk,
                         GHC.IO.Buffer.Buffer
                           @ CharBufElem
                           ww_sb66p
                           ww1_sb66q
                           GHC.IO.Buffer.WriteBuffer
                           ww2_sb66u
                           0#
                           ww3_sb66y #)
                      }
                      }
                  }
                  }
                  }
              }
              }
              };
            1# ->
              case w1_sb66k of {
                False ->
                  (# ipv2_i7IAy,
                     GHC.IO.Buffer.Buffer
                       @ CharBufElem
                       ww_sb66p
                       ww1_sb66q
                       GHC.IO.Buffer.WriteBuffer
                       ww2_sb66u
                       0#
                       ww3_sb66y #);
                True ->
                  case readMutVar#
                         @ RealWorld @ (Buffer CharBufElem) dt2_db3tb ipv2_i7IAy
                  of
                  { (# ipv4_X7IEb, ipv5_X7IEd #) ->
                  case ipv5_X7IEd of
                  { Buffer dt10_db3td dt11_db3te ds13_db3br dt12_db3tf dt13_db3tg
                           dt14_db3th ->
                  case ==# ww2_sb66u dt12_db3tf of {
                    __DEFAULT ->
                      (# ipv4_X7IEb,
                         GHC.IO.Buffer.Buffer
                           @ CharBufElem
                           ww_sb66p
                           ww1_sb66q
                           GHC.IO.Buffer.WriteBuffer
                           ww2_sb66u
                           0#
                           ww3_sb66y #);
                    1# ->
                      case readMutVar#
                             @ RealWorld @ (BufferList CharBufElem) dt3_db3tc ipv4_X7IEb
                      of
                      { (# ipv6_X7ID2, ipv7_X7ID4 #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (BufferList CharBufElem)
                             dt3_db3tc
                             (GHC.IO.Handle.Types.BufferListCons
                                @ CharBufElem
                                (GHC.ForeignPtr.ForeignPtr @ CharBufElem ww_sb66p ww1_sb66q)
                                ipv7_X7ID4)
                             ipv6_X7ID2
                      of s2#_i7IBe
                      { __DEFAULT ->
                      (# s2#_i7IBe,
                         GHC.IO.Buffer.Buffer
                           @ CharBufElem
                           ww_sb66p
                           ww1_sb66q
                           GHC.IO.Buffer.WriteBuffer
                           ww2_sb66u
                           0#
                           ww3_sb66y #)
                      }
                      }
                  }
                  }
                  }
              }
          }
          }
          }
      }
      }
      }

-- RHS size: {terms: 25, types: 15, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.commitBuffer'1 [InlPrag=NOUSERINLINE[0]]
  :: RawCharBuffer
     -> Int
     -> Int
     -> Bool
     -> Bool
     -> Handle__
     -> State# RealWorld
     -> (# State# RealWorld, CharBuffer #)
[GblId,
 Arity=7,
 Caf=NoCafRefs,
 Str=<S(SL),1*U(U,U)><S(S),1*U(U)><S(S),1*U(U)><L,1*U><L,1*U><S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=7,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_sb66g [Occ=Once!] :: RawCharBuffer)
                 (w1_sb66h [Occ=Once!] :: Int)
                 (w2_sb66i [Occ=Once!] :: Int)
                 (w3_sb66j [Occ=Once] :: Bool)
                 (w4_sb66k [Occ=Once] :: Bool)
                 (w5_sb66l [Occ=Once] :: Handle__)
                 (w6_sb66m [Occ=Once] :: State# RealWorld) ->
                 case w_sb66g of
                 { GHC.ForeignPtr.ForeignPtr ww1_sb66p [Occ=Once]
                                             ww2_sb66q [Occ=Once] ->
                 case w1_sb66h of { I# ww4_sb66u [Occ=Once] ->
                 case w2_sb66i of { I# ww6_sb66y [Occ=Once] ->
                 GHC.IO.Handle.Text.$wcommitBuffer'
                   ww1_sb66p
                   ww2_sb66q
                   ww4_sb66u
                   ww6_sb66y
                   w3_sb66j
                   w4_sb66k
                   w5_sb66l
                   w6_sb66m
                 }
                 }
                 }}]
GHC.IO.Handle.Text.commitBuffer'1
  = \ (w_sb66g :: RawCharBuffer)
      (w1_sb66h :: Int)
      (w2_sb66i :: Int)
      (w3_sb66j :: Bool)
      (w4_sb66k :: Bool)
      (w5_sb66l :: Handle__)
      (w6_sb66m :: State# RealWorld) ->
      case w_sb66g of { GHC.ForeignPtr.ForeignPtr ww1_sb66p ww2_sb66q ->
      case w1_sb66h of { I# ww4_sb66u ->
      case w2_sb66i of { I# ww6_sb66y ->
      GHC.IO.Handle.Text.$wcommitBuffer'
        ww1_sb66p
        ww2_sb66q
        ww4_sb66u
        ww6_sb66y
        w3_sb66j
        w4_sb66k
        w5_sb66l
        w6_sb66m
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 15, joins: 0/0}
commitBuffer'
  :: RawCharBuffer
     -> Int -> Int -> Bool -> Bool -> Handle__ -> IO CharBuffer
[GblId,
 Arity=7,
 Caf=NoCafRefs,
 Str=<S(SL),1*U(U,U)><S(S),1*U(U)><S(S),1*U(U)><L,1*U><L,1*U><S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.commitBuffer'1
               `cast` (<RawCharBuffer>_R
                       ->_R <Int>_R
                       ->_R <Int>_R
                       ->_R <Bool>_R
                       ->_R <Bool>_R
                       ->_R <Handle__>_R
                       ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
                       :: (RawCharBuffer
                           -> Int
                           -> Int
                           -> Bool
                           -> Bool
                           -> Handle__
                           -> State# RealWorld
                           -> (# State# RealWorld, CharBuffer #) :: *)
                          ~R# (RawCharBuffer
                               -> Int -> Int -> Bool -> Bool -> Handle__ -> IO CharBuffer :: *))}]
commitBuffer'
  = GHC.IO.Handle.Text.commitBuffer'1
    `cast` (<RawCharBuffer>_R
            ->_R <Int>_R
            ->_R <Int>_R
            ->_R <Bool>_R
            ->_R <Bool>_R
            ->_R <Handle__>_R
            ->_R Sym (GHC.Types.N:IO[0] <CharBuffer>_R)
            :: (RawCharBuffer
                -> Int
                -> Int
                -> Bool
                -> Bool
                -> Handle__
                -> State# RealWorld
                -> (# State# RealWorld, CharBuffer #) :: *)
               ~R# (RawCharBuffer
                    -> Int -> Int -> Bool -> Bool -> Handle__ -> IO CharBuffer :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl1_rb6WD :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl1_rb6WD = "commitBuffer"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl2_rb6WE :: [Char]
[GblId]
lvl2_rb6WE = unpackCString# lvl1_rb6WD

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutChar3 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hPutChar3 = "hPutChar"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutChar2 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hPutChar2
  = unpackCString# GHC.IO.Handle.Text.hPutChar3

-- RHS size: {terms: 194, types: 271, coercions: 13, joins: 1/3}
GHC.IO.Handle.Text.$whPutChar [InlPrag=NOUSERINLINE[0]]
  :: Handle
     -> Char# -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=3,
 Str=<S,1*U><L,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [80 132 0] 553 0}]
GHC.IO.Handle.Text.$whPutChar
  = \ (w_sb66P :: Handle)
      (ww_sb66U :: Char#)
      (w1_sb66R :: State# RealWorld) ->
      let {
        act_sb41h [Dmd=<L,C(C1(U(U,U)))>]
          :: Handle__ -> State# RealWorld -> (# State# RealWorld, () #)
        [LclId, Arity=2, Str=<S,1*U><S,U>, Unf=OtherCon []]
        act_sb41h
          = \ (handle__ab2d4 :: Handle__)
              (eta_B1 [OS=OneShot] :: State# RealWorld) ->
              case handle__ab2d4 of wild_X1j
              { Handle__ @ dev_ab2Iw @ enc_state_ab2Ix @ dec_state_ab2Iy
                         $dIODevice_ab2Iz $dBufferedIO_ab2IA $dTypeable_ab2IB ds_db3gi
                         ds1_db3gj dt_db3tA ds2_db3gl dt1_db3tB dt2_db3tC dt3_db3tD
                         ds3_db3gp ds4_db3gq ds5_db3gr ds6_db3gs ds7_db3gt ds8_db3gu ->
              case readMutVar#
                     @ RealWorld @ (Buffer CharBufElem) dt2_db3tC eta_B1
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              case ww_sb66U of wild1_X2H {
                __DEFAULT ->
                  case ipv1_i7IAz of
                  { Buffer dt4_db3tE dt5_db3tF ds10_db3h8 dt6_db3tG dt7_db3tH
                           dt8_db3tI ->
                  case writeWideCharOffAddr#
                         @ RealWorld dt4_db3tE dt8_db3tI wild1_X2H ipv_i7IAy
                  of s2_ib3dC
                  { __DEFAULT ->
                  case touch#
                         @ 'LiftedRep @ GHC.ForeignPtr.ForeignPtrContents dt5_db3tF s2_ib3dC
                  of s'_ib3dD
                  { __DEFAULT ->
                  case GHC.IO.Handle.Internals.$wwriteCharBuffer
                         wild_X1j
                         dt4_db3tE
                         dt5_db3tF
                         ds10_db3h8
                         dt6_db3tG
                         dt7_db3tH
                         (+# dt8_db3tI 1#)
                         s'_ib3dD
                  of
                  { (# ipv2_X7JkP, ipv3_X7JkR #) ->
                  (# ipv2_X7JkP, GHC.Tuple.() #)
                  }
                  }
                  }
                  };
                '\n'# ->
                  join {
                    $w$j_sb66M [InlPrag=NOUSERINLINE[0],
                                Dmd=<C(C(C(C(C(C(C(S))))))),1*C1(C1(C1(C1(C1(C1(C1(U(U,U))))))))>]
                      :: State# RealWorld
                         -> Addr#
                         -> GHC.ForeignPtr.ForeignPtrContents
                         -> BufferState
                         -> Int#
                         -> Int#
                         -> Int#
                         -> (# State# RealWorld, () #)
                    [LclId[JoinId(7)],
                     Arity=7,
                     Str=<S,U><S,U><L,U><L,U><S,U><S,U><S,U>,
                     Unf=OtherCon []]
                    $w$j_sb66M (w2_sb66B [OS=OneShot] :: State# RealWorld)
                               (ww1_sb66F [OS=OneShot] :: Addr#)
                               (ww2_sb66G [OS=OneShot] :: GHC.ForeignPtr.ForeignPtrContents)
                               (ww3_sb66H [OS=OneShot] :: BufferState)
                               (ww4_sb66I [OS=OneShot] :: Int#)
                               (ww5_sb66J [OS=OneShot] :: Int#)
                               (ww6_sb66K [OS=OneShot] :: Int#)
                      = case GHC.IO.Handle.Internals.$wwriteCharBuffer
                               wild_X1j
                               ww1_sb66F
                               ww2_sb66G
                               ww3_sb66H
                               ww4_sb66I
                               ww5_sb66J
                               ww6_sb66K
                               w2_sb66B
                        of
                        { (# ipv2_X7JkQ, ipv3_X7JkS #) ->
                        case ds2_db3gl of {
                          __DEFAULT -> (# ipv2_X7JkQ, GHC.Tuple.() #);
                          LineBuffering ->
                            case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3tA ipv2_X7JkQ
                            of
                            { (# ipv4_X7ICR, ipv5_X7ICT #) ->
                            case ipv5_X7ICT of wild3_ia4we
                            { Buffer dt4_ia4wr dt5_ia4ws ds12_ia4wz dt6_ia4wA dt7_ia4wB
                                     dt8_ia4wC ->
                            case ==# dt7_ia4wB dt8_ia4wC of {
                              __DEFAULT ->
                                case ((Buffered.flushWriteBuffer
                                         @ dev_ab2Iw $dBufferedIO_ab2IA ds_db3gi wild3_ia4we)
                                      `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                              :: (IO (Buffer Word8) :: *)
                                                 ~R# (State# RealWorld
                                                      -> (# State# RealWorld,
                                                            Buffer Word8 #) :: *)))
                                       ipv4_X7ICR
                                of
                                { (# ipv6_X7ICO, ipv7_X7ICQ #) ->
                                case writeMutVar#
                                       @ RealWorld @ (Buffer Word8) dt_db3tA ipv7_X7ICQ ipv6_X7ICO
                                of s2#_i7IBe
                                { __DEFAULT ->
                                (# s2#_i7IBe, GHC.Tuple.() #)
                                }
                                };
                              1# -> (# ipv4_X7ICR, GHC.Tuple.() #)
                            }
                            }
                            }
                        }
                        } } in
                  case ds7_db3gt of {
                    LF ->
                      case ipv1_i7IAz of
                      { Buffer dt4_db3tE dt5_db3tF ds10_db3h8 dt6_db3tG dt7_db3tH
                               dt8_db3tI ->
                      case writeWideCharOffAddr#
                             @ RealWorld dt4_db3tE dt8_db3tI '\n'# ipv_i7IAy
                      of s2_ib3dC
                      { __DEFAULT ->
                      case touch#
                             @ 'LiftedRep @ GHC.ForeignPtr.ForeignPtrContents dt5_db3tF s2_ib3dC
                      of s'_ib3dD
                      { __DEFAULT ->
                      jump $w$j_sb66M
                        s'_ib3dD
                        dt4_db3tE
                        dt5_db3tF
                        ds10_db3h8
                        dt6_db3tG
                        dt7_db3tH
                        (+# dt8_db3tI 1#)
                      }
                      }
                      };
                    CRLF ->
                      case ipv1_i7IAz of
                      { Buffer dt4_db3tE dt5_db3tF ds10_db3h8 dt6_db3tG dt7_db3tH
                               dt8_db3tI ->
                      case writeWideCharOffAddr#
                             @ RealWorld dt4_db3tE dt8_db3tI '\r'# ipv_i7IAy
                      of s2_ib3dC
                      { __DEFAULT ->
                      case touch#
                             @ 'LiftedRep @ GHC.ForeignPtr.ForeignPtrContents dt5_db3tF s2_ib3dC
                      of s'_ib3dD
                      { __DEFAULT ->
                      let {
                        ipv2_sb46E [Dmd=<S,U>] :: Int#
                        [LclId]
                        ipv2_sb46E = +# dt8_db3tI 1# } in
                      case writeWideCharOffAddr#
                             @ RealWorld dt4_db3tE ipv2_sb46E '\n'# s'_ib3dD
                      of s1_Xb3jU
                      { __DEFAULT ->
                      case touch#
                             @ 'LiftedRep @ GHC.ForeignPtr.ForeignPtrContents dt5_db3tF s1_Xb3jU
                      of s'1_Xb3jY
                      { __DEFAULT ->
                      jump $w$j_sb66M
                        s'1_Xb3jY
                        dt4_db3tE
                        dt5_db3tF
                        ds10_db3h8
                        dt6_db3tG
                        dt7_db3tH
                        (+# ipv2_sb46E 1#)
                      }
                      }
                      }
                      }
                      }
                  }
              }
              }
              } } in
      case w_sb66P of wild_X2B {
        FileHandle ds_da4QS dt_da4Wh ->
          GHC.IO.Handle.Internals.$wwantWritableHandle'
            @ ()
            GHC.IO.Handle.Text.hPutChar2
            wild_X2B
            dt_da4Wh
            (act_sb41h
             `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                     :: (Handle__
                         -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                        ~R# (Handle__ -> IO () :: *)))
            w1_sb66R;
        DuplexHandle ds_da4QT dt_da4Wi dt1_da4Wj ->
          GHC.IO.Handle.Internals.$wwantWritableHandle'
            @ ()
            GHC.IO.Handle.Text.hPutChar2
            wild_X2B
            dt1_da4Wj
            (act_sb41h
             `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                     :: (Handle__
                         -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                        ~R# (Handle__ -> IO () :: *)))
            w1_sb66R
      }

-- RHS size: {terms: 10, types: 6, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutChar1 [InlPrag=NOUSERINLINE[0]]
  :: Handle -> Char -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=3,
 Str=<S,1*U><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_sb66P [Occ=Once] :: Handle)
                 (w1_sb66Q [Occ=Once!] :: Char)
                 (w2_sb66R [Occ=Once] :: State# RealWorld) ->
                 case w1_sb66Q of { C# ww1_sb66U [Occ=Once] ->
                 GHC.IO.Handle.Text.$whPutChar w_sb66P ww1_sb66U w2_sb66R
                 }}]
GHC.IO.Handle.Text.hPutChar1
  = \ (w_sb66P :: Handle)
      (w1_sb66Q :: Char)
      (w2_sb66R :: State# RealWorld) ->
      case w1_sb66Q of { C# ww1_sb66U ->
      GHC.IO.Handle.Text.$whPutChar w_sb66P ww1_sb66U w2_sb66R
      }

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
hPutChar :: Handle -> Char -> IO ()
[GblId,
 Arity=3,
 Str=<S,1*U><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hPutChar1
               `cast` (<Handle>_R
                       ->_R <Char>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle
                           -> Char -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle -> Char -> IO () :: *))}]
hPutChar
  = GHC.IO.Handle.Text.hPutChar1
    `cast` (<Handle>_R
            ->_R <Char>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle
                -> Char -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Handle -> Char -> IO () :: *))

Rec {
-- RHS size: {terms: 23, types: 30, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutStr7 [Occ=LoopBreaker]
  :: Handle
     -> [Char] -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=3, Str=<L,U><S,1*U><S,U>, Unf=OtherCon []]
GHC.IO.Handle.Text.hPutStr7
  = \ (ds_db3hg :: Handle)
      (ds1_db3hh :: [Char])
      (eta_B1 :: State# RealWorld) ->
      case ds1_db3hh of {
        [] -> (# eta_B1, GHC.Tuple.() #);
        : c_ab2dJ cs_ab2dK ->
          case c_ab2dJ of { C# ww1_sb66U ->
          case GHC.IO.Handle.Text.$whPutChar ds_db3hg ww1_sb66U eta_B1 of
          { (# ipv_i7JiK, ipv1_i7JiL #) ->
          GHC.IO.Handle.Text.hPutStr7 ds_db3hg cs_ab2dK ipv_i7JiK
          }
          }
      }
end Rec }

-- RHS size: {terms: 29, types: 43, coercions: 8, joins: 0/0}
GHC.IO.Handle.Text.hGetChar3
  :: SomeException
     -> State# RealWorld -> (# State# RealWorld, Maybe CharBuffer #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 136 30}]
GHC.IO.Handle.Text.hGetChar3
  = \ (e1_ia54Z [OS=OneShot] :: SomeException)
      (eta_B1 [OS=OneShot] :: State# RealWorld) ->
      case e1_ia54Z of wild_ia562
      { SomeException @ e2_ia565 $dException1_ia566 e3_ia567 ->
      case Data.Typeable.Internal.sameTypeRep
             @ *
             @ *
             @ e2_ia565
             @ IOException
             ((GHC.Exception.$p1Exception @ e2_ia565 $dException1_ia566)
              `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <e2_ia565>_N
                      :: (Typeable e2_ia565 :: Constraint)
                         ~R# (Data.Typeable.Internal.TypeRep e2_ia565 :: *)))
             GHC.IO.Exception.$fExceptionIOException4
      of {
        False ->
          raiseIO# @ SomeException @ (Maybe CharBuffer) wild_ia562 eta_B1;
        True ->
          case e3_ia567
               `cast` (UnsafeCo representational e2_ia565 IOException
                       :: (e2_ia565 :: *) ~R# (IOException :: *))
          of wild2_ib3la
          { IOError ds1_ib3lc ds2_ib3ld ds3_ib3le ds4_ib3lf ds5_ib3lg
                    ds6_ib3lh ->
          case ds2_ib3ld of {
            __DEFAULT ->
              raiseIO#
                @ SomeException
                @ (Maybe CharBuffer)
                (GHC.IO.Exception.$fExceptionIOException_$ctoException wild2_ib3la)
                eta_B1;
            EOF -> (# eta_B1, GHC.Base.Nothing @ CharBuffer #)
          }
          }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetChar7 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hGetChar7 = "hGetChar"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetChar6 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hGetChar6
  = unpackCString# GHC.IO.Handle.Text.hGetChar7

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetChar5 :: Char
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Text.hGetChar5 = GHC.Types.C# '\r'#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetChar4 :: Char
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Text.hGetChar4 = GHC.Types.C# '\n'#

-- RHS size: {terms: 383, types: 411, coercions: 0, joins: 2/5}
GHC.IO.Handle.Text.hGetChar2
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, Char #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 739 0}]
GHC.IO.Handle.Text.hGetChar2
  = \ (handle__ab2av :: Handle__) (eta_B1 :: State# RealWorld) ->
      case handle__ab2av of wild_X1k
      { Handle__ @ dev_ab2Td @ enc_state_ab2Te @ dec_state_ab2Tf
                 $dIODevice_ab2Tg $dBufferedIO_ab2Th $dTypeable_ab2Ti ds_db3q5
                 ds1_db3q6 dt_db3ux ds2_db3q8 dt1_db3uy dt2_db3uz dt3_db3uA
                 ds3_db3qc ds4_db3qd ds5_db3qe ds6_db3qf ds7_db3qg ds8_db3qh ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_db3uz eta_B1
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_ia4we
      { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
               dt8_ia4wC ->
      join {
        $w$j_sb67k [InlPrag=NOUSERINLINE[0],
                    Dmd=<L,1*C1(C1(C1(C1(C1(C1(C1(U(U,U))))))))>]
          :: State# RealWorld
             -> Addr#
             -> GHC.ForeignPtr.ForeignPtrContents
             -> BufferState
             -> Int#
             -> Int#
             -> Int#
             -> (# State# RealWorld, Char #)
        [LclId[JoinId(7)],
         Arity=7,
         Str=<S,U><S,U><L,U><L,U><L,U><S,U><L,U>,
         Unf=OtherCon []]
        $w$j_sb67k (w_sb679 [OS=OneShot] :: State# RealWorld)
                   (ww_sb67d [OS=OneShot] :: Addr#)
                   (ww1_sb67e [OS=OneShot] :: GHC.ForeignPtr.ForeignPtrContents)
                   (ww2_sb67f [OS=OneShot] :: BufferState)
                   (ww3_sb67g [OS=OneShot] :: Int#)
                   (ww4_sb67h [OS=OneShot] :: Int#)
                   (ww5_sb67i [OS=OneShot] :: Int#)
          = case readWideCharOffAddr# @ RealWorld ww_sb67d ww4_sb67h w_sb679
            of
            { (# ipv2_ib3iK, ipv3_ib3iL #) ->
            case touch#
                   @ 'LiftedRep
                   @ GHC.ForeignPtr.ForeignPtrContents
                   ww1_sb67e
                   ipv2_ib3iK
            of s'_ib3iN
            { __DEFAULT ->
            let {
              ipv4_sb472 :: Int#
              [LclId]
              ipv4_sb472 = +# ww4_sb67h 1# } in
            case ds6_db3qf of {
              LF ->
                case writeMutVar#
                       @ RealWorld
                       @ (Buffer CharBufElem)
                       dt2_db3uz
                       (case ==# ipv4_sb472 ww5_sb67i of {
                          __DEFAULT ->
                            GHC.IO.Buffer.Buffer
                              @ Char ww_sb67d ww1_sb67e ww2_sb67f ww3_sb67g ipv4_sb472 ww5_sb67i;
                          1# ->
                            GHC.IO.Buffer.Buffer
                              @ Char ww_sb67d ww1_sb67e ww2_sb67f ww3_sb67g 0# 0#
                        })
                       s'_ib3iN
                of s2#_i7IBe
                { __DEFAULT ->
                (# s2#_i7IBe, GHC.Types.C# ipv3_ib3iL #)
                };
              CRLF ->
                case ipv3_ib3iL of wild3_X3T {
                  __DEFAULT ->
                    case writeMutVar#
                           @ RealWorld
                           @ (Buffer CharBufElem)
                           dt2_db3uz
                           (case ==# ipv4_sb472 ww5_sb67i of {
                              __DEFAULT ->
                                GHC.IO.Buffer.Buffer
                                  @ Char
                                  ww_sb67d
                                  ww1_sb67e
                                  ww2_sb67f
                                  ww3_sb67g
                                  ipv4_sb472
                                  ww5_sb67i;
                              1# ->
                                GHC.IO.Buffer.Buffer
                                  @ Char ww_sb67d ww1_sb67e ww2_sb67f ww3_sb67g 0# 0#
                            })
                           s'_ib3iN
                    of s2#_i7IBe
                    { __DEFAULT ->
                    (# s2#_i7IBe, GHC.Types.C# wild3_X3T #)
                    };
                  '\r'# ->
                    join {
                      $j_sb4vv [Dmd=<C(C(C(C(C(C(C(S))))))),1*C1(C1(C1(C1(C1(C1(C1(U(U,U))))))))>]
                        :: Addr#
                           -> GHC.ForeignPtr.ForeignPtrContents
                           -> BufferState
                           -> Int#
                           -> Int#
                           -> Int#
                           -> Buffer Char
                           -> (# State# RealWorld, Char #)
                      [LclId[JoinId(7)],
                       Arity=7,
                       Str=<L,U><L,U><L,U><L,U><S,U><S,U><L,U(U,U,U,U,U,U)>,
                       Unf=OtherCon []]
                      $j_sb4vv (dt9_Xa4CW [OS=OneShot] :: Addr#)
                               (dt10_Xa4CY [OS=OneShot] :: GHC.ForeignPtr.ForeignPtrContents)
                               (ds12_Xa4D6 [OS=OneShot] :: BufferState)
                               (dt11_Xa4D8 [OS=OneShot] :: Int#)
                               (dt12_Xa4Da [OS=OneShot] :: Int#)
                               (dt13_Xa4Dc [OS=OneShot] :: Int#)
                               (wild4_Xa4CH [OS=OneShot]
                                  :: Buffer Char
                                  Unf=OtherCon [])
                        = case ==# dt12_Xa4Da dt13_Xa4Dc of {
                            __DEFAULT ->
                              case readWideCharOffAddr# @ RealWorld dt9_Xa4CW dt12_Xa4Da s'_ib3iN
                              of
                              { (# ipv5_Xb3pF, ipv6_Xb3pH #) ->
                              case touch#
                                     @ 'LiftedRep
                                     @ GHC.ForeignPtr.ForeignPtrContents
                                     dt10_Xa4CY
                                     ipv5_Xb3pF
                              of s'1_Xb3pL
                              { __DEFAULT ->
                              case ipv6_Xb3pH of {
                                __DEFAULT ->
                                  case writeMutVar#
                                         @ RealWorld
                                         @ (Buffer CharBufElem)
                                         dt2_db3uz
                                         wild4_Xa4CH
                                         s'1_Xb3pL
                                  of s2#_i7IBe
                                  { __DEFAULT ->
                                  (# s2#_i7IBe, GHC.IO.Handle.Text.hGetChar5 #)
                                  };
                                '\n'# ->
                                  case writeMutVar#
                                         @ RealWorld
                                         @ (Buffer CharBufElem)
                                         dt2_db3uz
                                         (let {
                                            ipv7_sb47c [Dmd=<S,U>] :: Int#
                                            [LclId]
                                            ipv7_sb47c = +# dt12_Xa4Da 1# } in
                                          case ==# ipv7_sb47c dt13_Xa4Dc of {
                                            __DEFAULT ->
                                              GHC.IO.Buffer.Buffer
                                                @ Char
                                                dt9_Xa4CW
                                                dt10_Xa4CY
                                                ds12_Xa4D6
                                                dt11_Xa4D8
                                                ipv7_sb47c
                                                dt13_Xa4Dc;
                                            1# ->
                                              GHC.IO.Buffer.Buffer
                                                @ Char
                                                dt9_Xa4CW
                                                dt10_Xa4CY
                                                ds12_Xa4D6
                                                dt11_Xa4D8
                                                0#
                                                0#
                                          })
                                         s'1_Xb3pL
                                  of s2#_i7IBe
                                  { __DEFAULT ->
                                  (# s2#_i7IBe, GHC.IO.Handle.Text.hGetChar4 #)
                                  }
                              }
                              }
                              };
                            1# ->
                              case catch#
                                     @ (Maybe CharBuffer)
                                     @ SomeException
                                     (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
                                        case -# dt13_Xa4Dc dt12_Xa4Da of {
                                          __DEFAULT ->
                                            (# s_i7IAv, GHC.Base.Just @ CharBuffer wild4_Xa4CH #);
                                          0# ->
                                            case GHC.IO.Handle.Internals.hLookAhead_2
                                                   wild_X1k wild4_Xa4CH s_i7IAv
                                            of
                                            { (# ipv5_X7IHF, ipv6_X7IHH #) ->
                                            (# ipv5_X7IHF, GHC.Base.Just @ CharBuffer ipv6_X7IHH #)
                                            };
                                          1# ->
                                            case readWideCharOffAddr#
                                                   @ RealWorld dt9_Xa4CW dt12_Xa4Da s_i7IAv
                                            of
                                            { (# ipv5_Xb3pZ, ipv6_Xb3q1 #) ->
                                            case touch#
                                                   @ 'LiftedRep
                                                   @ GHC.ForeignPtr.ForeignPtrContents
                                                   dt10_Xa4CY
                                                   ipv5_Xb3pZ
                                            of s'1_Xb3q5
                                            { __DEFAULT ->
                                            case ipv6_Xb3q1 of {
                                              __DEFAULT ->
                                                (# s'1_Xb3q5,
                                                   GHC.Base.Just @ CharBuffer wild4_Xa4CH #);
                                              '\r'# ->
                                                case writeWideCharOffAddr#
                                                       @ RealWorld dt9_Xa4CW 0# '\r'# s'1_Xb3q5
                                                of s2_ib3dC
                                                { __DEFAULT ->
                                                case touch#
                                                       @ 'LiftedRep
                                                       @ GHC.ForeignPtr.ForeignPtrContents
                                                       dt10_Xa4CY
                                                       s2_ib3dC
                                                of s'2_ib3dD
                                                { __DEFAULT ->
                                                case GHC.IO.Handle.Internals.hLookAhead_2
                                                       wild_X1k
                                                       (GHC.IO.Buffer.Buffer
                                                          @ Char
                                                          dt9_Xa4CW
                                                          dt10_Xa4CY
                                                          ds12_Xa4D6
                                                          dt11_Xa4D8
                                                          0#
                                                          1#)
                                                       s'2_ib3dD
                                                of
                                                { (# ipv7_X7IHF, ipv8_X7IHH #) ->
                                                (# ipv7_X7IHF,
                                                   GHC.Base.Just @ CharBuffer ipv8_X7IHH #)
                                                }
                                                }
                                                }
                                            }
                                            }
                                            }
                                        })
                                     GHC.IO.Handle.Text.hGetChar3
                                     s'_ib3iN
                              of
                              { (# ipv5_X7ICQ, ipv6_X7ICS #) ->
                              case ipv6_X7ICS of {
                                Nothing ->
                                  case writeMutVar#
                                         @ RealWorld
                                         @ (Buffer CharBufElem)
                                         dt2_db3uz
                                         wild4_Xa4CH
                                         ipv5_X7ICQ
                                  of s2#_i7IBe
                                  { __DEFAULT ->
                                  (# s2#_i7IBe, GHC.IO.Handle.Text.hGetChar5 #)
                                  };
                                Just buf3_ab2aP ->
                                  case readWideCharOffAddr#
                                         @ RealWorld dt9_Xa4CW dt12_Xa4Da ipv5_X7ICQ
                                  of
                                  { (# ipv7_Xb3pF, ipv8_Xb3pH #) ->
                                  case touch#
                                         @ 'LiftedRep
                                         @ GHC.ForeignPtr.ForeignPtrContents
                                         dt10_Xa4CY
                                         ipv7_Xb3pF
                                  of s'1_Xb3pL
                                  { __DEFAULT ->
                                  case ipv8_Xb3pH of {
                                    __DEFAULT ->
                                      case writeMutVar#
                                             @ RealWorld
                                             @ (Buffer CharBufElem)
                                             dt2_db3uz
                                             buf3_ab2aP
                                             s'1_Xb3pL
                                      of s2#_i7IBe
                                      { __DEFAULT ->
                                      (# s2#_i7IBe, GHC.IO.Handle.Text.hGetChar5 #)
                                      };
                                    '\n'# ->
                                      case writeMutVar#
                                             @ RealWorld
                                             @ (Buffer CharBufElem)
                                             dt2_db3uz
                                             (case buf3_ab2aP of
                                              { Buffer dt14_ib3kC dt15_ib3kD ds15_ib3kE dt16_ib3kF
                                                       dt17_ib3kG dt18_ib3kH ->
                                              let {
                                                ipv9_sb47c [Dmd=<S,U>] :: Int#
                                                [LclId]
                                                ipv9_sb47c = +# dt12_Xa4Da 1# } in
                                              case ==# ipv9_sb47c dt18_ib3kH of {
                                                __DEFAULT ->
                                                  GHC.IO.Buffer.Buffer
                                                    @ Char
                                                    dt14_ib3kC
                                                    dt15_ib3kD
                                                    ds15_ib3kE
                                                    dt16_ib3kF
                                                    ipv9_sb47c
                                                    dt18_ib3kH;
                                                1# ->
                                                  GHC.IO.Buffer.Buffer
                                                    @ Char
                                                    dt14_ib3kC
                                                    dt15_ib3kD
                                                    ds15_ib3kE
                                                    dt16_ib3kF
                                                    0#
                                                    0#
                                              }
                                              })
                                             s'1_Xb3pL
                                      of s2#_i7IBe
                                      { __DEFAULT ->
                                      (# s2#_i7IBe, GHC.IO.Handle.Text.hGetChar4 #)
                                      }
                                  }
                                  }
                                  }
                              }
                              }
                          } } in
                    case ==# ipv4_sb472 ww5_sb67i of {
                      __DEFAULT ->
                        jump $j_sb4vv
                          ww_sb67d
                          ww1_sb67e
                          ww2_sb67f
                          ww3_sb67g
                          ipv4_sb472
                          ww5_sb67i
                          (GHC.IO.Buffer.Buffer
                             @ Char
                             ww_sb67d
                             ww1_sb67e
                             ww2_sb67f
                             ww3_sb67g
                             ipv4_sb472
                             ww5_sb67i);
                      1# ->
                        jump $j_sb4vv
                          ww_sb67d
                          ww1_sb67e
                          ww2_sb67f
                          ww3_sb67g
                          0#
                          0#
                          (GHC.IO.Buffer.Buffer
                             @ Char ww_sb67d ww1_sb67e ww2_sb67f ww3_sb67g 0# 0#)
                    }
                }
            }
            }
            } } in
      case ==# dt7_ia4wB dt8_ia4wC of {
        __DEFAULT ->
          jump $w$j_sb67k
            ipv_i7IAy
            dt4_ia4wr
            dt5_ia4ws
            ds10_ia4wz
            dt6_ia4wA
            dt7_ia4wB
            dt8_ia4wC;
        1# ->
          case GHC.IO.Handle.Internals.hLookAhead_2
                 wild_X1k wild1_ia4we ipv_i7IAy
          of
          { (# ipv2_X7ICs, ipv3_X7ICu #) ->
          case ipv3_X7ICu of
          { Buffer ww1_sb67d ww2_sb67e ww3_sb67f ww4_sb67g ww5_sb67h
                   ww6_sb67i ->
          jump $w$j_sb67k
            ipv2_X7ICs
            ww1_sb67d
            ww2_sb67e
            ww3_sb67f
            ww4_sb67g
            ww5_sb67h
            ww6_sb67i
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 5, types: 2, coercions: 5, joins: 0/0}
GHC.IO.Handle.Text.hGetChar1
  :: Handle -> State# RealWorld -> (# State# RealWorld, Char #)
[GblId,
 Arity=2,
 Str=<L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (handle_ab2au [Occ=Once] :: Handle) ->
                 GHC.IO.Handle.Internals.wantReadableHandle_1
                   @ Char
                   GHC.IO.Handle.Text.hGetChar6
                   handle_ab2au
                   (GHC.IO.Handle.Text.hGetChar2
                    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
                            :: (Handle__
                                -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
                               ~R# (Handle__ -> IO Char :: *)))}]
GHC.IO.Handle.Text.hGetChar1
  = \ (handle_ab2au :: Handle) ->
      GHC.IO.Handle.Internals.wantReadableHandle_1
        @ Char
        GHC.IO.Handle.Text.hGetChar6
        handle_ab2au
        (GHC.IO.Handle.Text.hGetChar2
         `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
                 :: (Handle__
                     -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
                    ~R# (Handle__ -> IO Char :: *)))

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
hGetChar :: Handle -> IO Char
[GblId,
 Arity=2,
 Str=<L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetChar1
               `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
                       :: (Handle
                           -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
                          ~R# (Handle -> IO Char :: *))}]
hGetChar
  = GHC.IO.Handle.Text.hGetChar1
    `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <Char>_R)
            :: (Handle
                -> State# RealWorld -> (# State# RealWorld, Char #) :: *)
               ~R# (Handle -> IO Char :: *))

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBuf3 :: Int
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.IO.Handle.Text.hGetBuf3 = GHC.Types.I# 0#

-- RHS size: {terms: 143, types: 154, coercions: 0, joins: 0/1}
$wunpack_nl_rb6WF
  :: Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> Int#
     -> Int#
     -> [Char]
     -> State# RealWorld
     -> (# State# RealWorld, ([Char], Int) #)
[GblId,
 Arity=6,
 Caf=NoCafRefs,
 Str=<L,U><L,U><S,U><S,U><L,U><S,U>,
 Unf=OtherCon []]
$wunpack_nl_rb6WF
  = \ (ww_sb67C :: Addr#)
      (ww1_sb67D :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sb67H :: Int#)
      (ww3_sb67L :: Int#)
      (w_sb67y :: [Char])
      (w1_sb67z :: State# RealWorld) ->
      case ==# ww2_sb67H ww3_sb67L of {
        __DEFAULT ->
          case readWideCharOffAddr#
                 @ RealWorld ww_sb67C (-# ww3_sb67L 1#) w1_sb67z
          of
          { (# ipv_i7O62, ipv1_i7O63 #) ->
          letrec {
            $wunpackRB_sb67u [InlPrag=NOUSERINLINE[0], Occ=LoopBreaker]
              :: [Char]
                 -> Int# -> State# RealWorld -> (# State# RealWorld, [Char] #)
            [LclId, Arity=3, Str=<L,U><S,U><S,U>, Unf=OtherCon []]
            $wunpackRB_sb67u
              = \ (w2_sb67n :: [Char])
                  (ww4_sb67s :: Int#)
                  (w3_sb67p :: State# RealWorld) ->
                  case <# ww4_sb67s ww2_sb67H of {
                    __DEFAULT ->
                      case readWideCharOffAddr# @ RealWorld ww_sb67C ww4_sb67s w3_sb67p
                      of
                      { (# ipv2_X7O9s, ipv3_X7O9u #) ->
                      case ipv3_X7O9u of wild_X3G {
                        __DEFAULT ->
                          $wunpackRB_sb67u
                            (GHC.Types.: @ CharBufElem (GHC.Types.C# wild_X3G) w2_sb67n)
                            (-# ww4_sb67s 1#)
                            ipv2_X7O9s;
                        '\n'# ->
                          case ># ww4_sb67s ww2_sb67H of {
                            __DEFAULT ->
                              $wunpackRB_sb67u
                                (GHC.Types.: @ CharBufElem GHC.IO.Handle.Text.hGetChar4 w2_sb67n)
                                (-# ww4_sb67s 1#)
                                ipv2_X7O9s;
                            1# ->
                              case readWideCharOffAddr#
                                     @ RealWorld ww_sb67C (-# ww4_sb67s 1#) ipv2_X7O9s
                              of
                              { (# ipv4_X7Ocd, ipv5_X7Ocf #) ->
                              case ipv5_X7Ocf of {
                                __DEFAULT ->
                                  $wunpackRB_sb67u
                                    (GHC.Types.: @ Char GHC.IO.Handle.Text.hGetChar4 w2_sb67n)
                                    (-# ww4_sb67s 1#)
                                    ipv4_X7Ocd;
                                '\r'# ->
                                  $wunpackRB_sb67u
                                    (GHC.Types.: @ Char GHC.IO.Handle.Text.hGetChar4 w2_sb67n)
                                    (-# ww4_sb67s 2#)
                                    ipv4_X7Ocd
                              }
                              }
                          }
                      }
                      };
                    1# -> (# w3_sb67p, w2_sb67n #)
                  }; } in
          case ipv1_i7O63 of {
            __DEFAULT ->
              case $wunpackRB_sb67u w_sb67y (-# ww3_sb67L 1#) ipv_i7O62 of
              { (# ipv2_X7ICC, ipv3_X7ICE #) ->
              case touch#
                     @ 'LiftedRep
                     @ GHC.ForeignPtr.ForeignPtrContents
                     ww1_sb67D
                     ipv2_X7ICC
              of s'_ib3va
              { __DEFAULT ->
              (# s'_ib3va, (ipv3_X7ICE, GHC.Types.I# ww3_sb67L) #)
              }
              };
            '\r'# ->
              case $wunpackRB_sb67u w_sb67y (-# ww3_sb67L 2#) ipv_i7O62 of
              { (# ipv2_X7ICC, ipv3_X7ICE #) ->
              case touch#
                     @ 'LiftedRep
                     @ GHC.ForeignPtr.ForeignPtrContents
                     ww1_sb67D
                     ipv2_X7ICC
              of s'_ib3va
              { __DEFAULT ->
              (# s'_ib3va, (ipv3_X7ICE, GHC.Types.I# (-# ww3_sb67L 1#)) #)
              }
              }
          }
          };
        1# -> (# w1_sb67z, (w_sb67y, GHC.IO.Handle.Text.hGetBuf3) #)
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetContents4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 40 0}]
GHC.IO.Handle.Text.hGetContents4 = "hGetContents"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetContents3 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hGetContents3
  = unpackCString# GHC.IO.Handle.Text.hGetContents4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl3_rb6WG :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl3_rb6WG = "\r"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl4_rb6WH :: [Char]
[GblId]
lvl4_rb6WH = unpackCString# lvl3_rb6WG

-- RHS size: {terms: 27, types: 28, coercions: 0, joins: 0/0}
$wlvl_rb6WI
  :: Handle
     -> IOErrorType -> String -> Maybe CInt -> Maybe FilePath -> [Char]
[GblId, Arity=5, Str=<B,U><B,U><B,U><B,U><B,1*U>x, Unf=OtherCon []]
$wlvl_rb6WI
  = \ (w_sb67O :: Handle)
      (ww_sb67T :: IOErrorType)
      (ww1_sb67V :: String)
      (ww2_sb67W :: Maybe CInt)
      (ww3_sb67X :: Maybe FilePath) ->
      throw
        @ IOException
        @ [Char]
        GHC.IO.Exception.$fExceptionIOException
        (GHC.IO.Exception.IOError
           (GHC.Base.Just @ Handle w_sb67O)
           ww_sb67T
           GHC.IO.Handle.Text.hGetContents3
           ww1_sb67V
           ww2_sb67W
           (case ww3_sb67X of wild1_Xi {
              Nothing ->
                case w_sb67O of {
                  FileHandle path_aa3Gd dt_da4Ve ->
                    GHC.Base.Just @ FilePath path_aa3Gd;
                  DuplexHandle path_aa3Ge dt_da4Vf dt1_da4Vg ->
                    GHC.Base.Just @ FilePath path_aa3Ge
                };
              Just ds6_da4Fx -> wild1_Xi
            }))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl5_rb6WJ :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl5_rb6WJ = "delayed read on closed handle"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl6_rb6WK :: [Char]
[GblId]
lvl6_rb6WK = unpackCString# lvl5_rb6WJ

-- RHS size: {terms: 13, types: 11, coercions: 0, joins: 0/0}
lvl7_rb6WL
  :: Handle
     -> State# RealWorld -> (# State# RealWorld, (Handle__, [Char]) #)
[GblId, Arity=2, Str=<B,U><B,U>x, Unf=OtherCon []]
lvl7_rb6WL
  = \ (handle_ab2ca :: Handle) (eta_X6 :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ (Handle__, [Char])
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Just @ Handle handle_ab2ca)
              GHC.IO.Exception.IllegalOperation
              GHC.IO.Handle.Text.hGetContents3
              lvl6_rb6WK
              (GHC.Base.Nothing @ CInt)
              (GHC.Base.Nothing @ FilePath)))
        eta_X6

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl8_rb6WM :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl8_rb6WM = "illegal handle type"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl9_rb6WN :: [Char]
[GblId]
lvl9_rb6WN = unpackCString# lvl8_rb6WM

-- RHS size: {terms: 13, types: 11, coercions: 0, joins: 0/0}
lvl10_rb6WO
  :: Handle
     -> State# RealWorld -> (# State# RealWorld, (Handle__, [Char]) #)
[GblId, Arity=2, Str=<B,U><B,U>x, Unf=OtherCon []]
lvl10_rb6WO
  = \ (handle_ab2ca :: Handle) (eta_X6 :: State# RealWorld) ->
      raiseIO#
        @ SomeException
        @ (Handle__, [Char])
        (GHC.IO.Exception.$fExceptionIOException_$ctoException
           (GHC.IO.Exception.IOError
              (GHC.Base.Just @ Handle handle_ab2ca)
              GHC.IO.Exception.IllegalOperation
              GHC.IO.Handle.Text.hGetContents3
              lvl9_rb6WN
              (GHC.Base.Nothing @ CInt)
              (GHC.Base.Nothing @ FilePath)))
        eta_X6

Rec {
-- RHS size: {terms: 350, types: 449, coercions: 31, joins: 3/4}
GHC.IO.Handle.Text.hGetContents2 [Occ=LoopBreaker]
  :: Handle -> State# RealWorld -> (# State# RealWorld, [Char] #)
[GblId, Arity=2, Str=<L,U><S,U>, Unf=OtherCon []]
GHC.IO.Handle.Text.hGetContents2
  = \ (handle_ab2ca :: Handle) (eta_B1 :: State# RealWorld) ->
      ((unsafeDupableInterleaveIO
          @ [Char]
          ((\ (s_ib3kc [OS=OneShot] :: State# RealWorld) ->
              case noDuplicate# @ RealWorld s_ib3kc of s'_ib3kd { __DEFAULT ->
              let {
                act_sb417 [Dmd=<C(S),C(U)>]
                  :: Handle__
                     -> State# RealWorld -> (# State# RealWorld, (Handle__, [Char]) #)
                [LclId, Arity=2, Str=<S,1*U><S,U>, Unf=OtherCon []]
                act_sb417
                  = \ (handle__ab2cb :: Handle__) (eta1_X6 :: State# RealWorld) ->
                      case handle__ab2cb of wild_ia4yf
                      { Handle__ @ dev_ia4yh @ enc_state_ia4yi @ dec_state_ia4yj
                                 $dIODevice_ia4yk $dBufferedIO_ia4yl $dTypeable_ia4ym ds1_ia4yn
                                 ds2_ia4yo dt_ia4yp ds3_ia4yq dt1_ia4yr dt2_ia4ys dt3_ia4yt
                                 ds4_ia4yu ds5_ia4yv ds6_ia4yw ds7_ia4yx ds8_ia4yy ds9_ia4yz ->
                      case ds2_ia4yo of {
                        __DEFAULT -> lvl10_rb6WO handle_ab2ca eta1_X6;
                        ClosedHandle -> lvl7_rb6WL handle_ab2ca eta1_X6;
                        SemiClosedHandle ->
                          case readMutVar#
                                 @ RealWorld @ (Buffer CharBufElem) dt2_ia4ys eta1_X6
                          of
                          { (# ipv_i7IAy, ipv1_i7IAz #) ->
                          catch#
                            @ (Handle__, [Char])
                            @ SomeException
                            (\ (s1_X7ICC [OS=OneShot] :: State# RealWorld) ->
                               case ipv1_i7IAz of wild2_XA
                               { Buffer dt4_db3tS dt5_db3tT ds_db3jK dt6_db3tU dt7_db3tV
                                        dt8_db3tW ->
                               join {
                                 $w$j_sb68p [InlPrag=NOUSERINLINE[0],
                                             Dmd=<L,1*C1(C1(C1(C1(C1(C1(C1(U)))))))>]
                                   :: State# RealWorld
                                      -> Addr#
                                      -> GHC.ForeignPtr.ForeignPtrContents
                                      -> BufferState
                                      -> Int#
                                      -> Int#
                                      -> Int#
                                      -> (# State# RealWorld, (Handle__, [Char]) #)
                                 [LclId[JoinId(7)],
                                  Arity=7,
                                  Str=<S,U><L,U><L,U><L,U><L,U><L,U><L,U>,
                                  Unf=OtherCon []]
                                 $w$j_sb68p (w_sb68e [OS=OneShot] :: State# RealWorld)
                                            (ww_sb68i [OS=OneShot] :: Addr#)
                                            (ww1_sb68j [OS=OneShot]
                                               :: GHC.ForeignPtr.ForeignPtrContents)
                                            (ww2_sb68k [OS=OneShot] :: BufferState)
                                            (ww3_sb68l [OS=OneShot] :: Int#)
                                            (ww4_sb68m [OS=OneShot] :: Int#)
                                            (ww5_sb68n [OS=OneShot] :: Int#)
                                   = case GHC.IO.Handle.Text.hGetContents2 handle_ab2ca w_sb68e of
                                     { (# ipv2_X7ID4, ipv3_X7ID6 #) ->
                                     case ds7_ia4yx of {
                                       LF ->
                                         case ==# ww4_sb68m ww5_sb68n of {
                                           __DEFAULT ->
                                             join {
                                               $j_sb5Jq [Dmd=<C(C(S)),C(C1(U))>]
                                                 :: State# RealWorld
                                                    -> [CharBufElem]
                                                    -> (# State# RealWorld, (Handle__, [Char]) #)
                                               [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U>]
                                               $j_sb5Jq (ipv4_ib3v2 [OS=OneShot]
                                                           :: State# RealWorld)
                                                        (ipv5_ib3v3 [OS=OneShot] :: [CharBufElem])
                                                 = case touch#
                                                          @ 'LiftedRep
                                                          @ GHC.ForeignPtr.ForeignPtrContents
                                                          ww1_sb68j
                                                          ipv4_ib3v2
                                                   of s'1_ib3va
                                                   { __DEFAULT ->
                                                   case writeMutVar#
                                                          @ RealWorld
                                                          @ (Buffer CharBufElem)
                                                          dt2_ia4ys
                                                          (GHC.IO.Buffer.Buffer
                                                             @ Char
                                                             ww_sb68i
                                                             ww1_sb68j
                                                             ww2_sb68k
                                                             ww3_sb68l
                                                             0#
                                                             0#)
                                                          s'1_ib3va
                                                   of s2#_i7IBe
                                                   { __DEFAULT ->
                                                   (# s2#_i7IBe, (wild_ia4yf, ipv5_ib3v3) #)
                                                   }
                                                   } } in
                                             joinrec {
                                               $wunpackRB_sb68d [InlPrag=NOUSERINLINE[0],
                                                                 Occ=LoopBreaker]
                                                 :: [CharBufElem]
                                                    -> Int#
                                                    -> State# RealWorld
                                                    -> (# State# RealWorld, (Handle__, [Char]) #)
                                               [LclId[JoinId(3)],
                                                Arity=3,
                                                Str=<L,U><S,U><S,U>,
                                                Unf=OtherCon []]
                                               $wunpackRB_sb68d (w1_sb686 :: [CharBufElem])
                                                                (ww6_sb68b :: Int#)
                                                                (w2_sb688 :: State# RealWorld)
                                                 = case <# ww6_sb68b ww4_sb68m of {
                                                     __DEFAULT ->
                                                       case readWideCharOffAddr#
                                                              @ RealWorld
                                                              ww_sb68i
                                                              ww6_sb68b
                                                              w2_sb688
                                                       of
                                                       { (# ipv4_i7O62, ipv5_i7O63 #) ->
                                                       jump $wunpackRB_sb68d
                                                         (GHC.Types.:
                                                            @ CharBufElem
                                                            (GHC.Types.C# ipv5_i7O63)
                                                            w1_sb686)
                                                         (-# ww6_sb68b 1#)
                                                         ipv4_i7O62
                                                       };
                                                     1# -> jump $j_sb5Jq w2_sb688 w1_sb686
                                                   }; } in
                                             jump $wunpackRB_sb68d
                                               ipv3_X7ID6 (-# ww5_sb68n 1#) ipv2_X7ID4;
                                           1# ->
                                             case writeMutVar#
                                                    @ RealWorld
                                                    @ (Buffer CharBufElem)
                                                    dt2_ia4ys
                                                    (GHC.IO.Buffer.Buffer
                                                       @ Char
                                                       ww_sb68i
                                                       ww1_sb68j
                                                       ww2_sb68k
                                                       ww3_sb68l
                                                       0#
                                                       0#)
                                                    ipv2_X7ID4
                                             of s2#_i7IBe
                                             { __DEFAULT ->
                                             (# s2#_i7IBe, (wild_ia4yf, ipv3_X7ID6) #)
                                             }
                                         };
                                       CRLF ->
                                         case $wunpack_nl_rb6WF
                                                ww_sb68i
                                                ww1_sb68j
                                                ww4_sb68m
                                                ww5_sb68n
                                                ipv3_X7ID6
                                                ipv2_X7ID4
                                         of
                                         { (# ipv4_X7IDb, ipv5_X7IDd #) ->
                                         case ipv5_X7IDd of { (s2_ab2cA, r_ab2cB) ->
                                         case writeMutVar#
                                                @ RealWorld
                                                @ (Buffer CharBufElem)
                                                dt2_ia4ys
                                                (case r_ab2cB of { I# x_ib3kL ->
                                                 case ==# x_ib3kL ww5_sb68n of {
                                                   __DEFAULT ->
                                                     GHC.IO.Buffer.Buffer
                                                       @ Char
                                                       ww_sb68i
                                                       ww1_sb68j
                                                       ww2_sb68k
                                                       ww3_sb68l
                                                       x_ib3kL
                                                       ww5_sb68n;
                                                   1# ->
                                                     GHC.IO.Buffer.Buffer
                                                       @ Char
                                                       ww_sb68i
                                                       ww1_sb68j
                                                       ww2_sb68k
                                                       ww3_sb68l
                                                       0#
                                                       0#
                                                 }
                                                 })
                                                ipv4_X7IDb
                                         of s2#_i7IBe
                                         { __DEFAULT ->
                                         (# s2#_i7IBe, (wild_ia4yf, s2_ab2cA) #)
                                         }
                                         }
                                         }
                                     }
                                     } } in
                               case -# dt8_db3tW dt7_db3tV of {
                                 __DEFAULT ->
                                   jump $w$j_sb68p
                                     s1_X7ICC
                                     dt4_db3tS
                                     dt5_db3tT
                                     ds_db3jK
                                     dt6_db3tU
                                     dt7_db3tV
                                     dt8_db3tW;
                                 0# ->
                                   case GHC.IO.Handle.Internals.hLookAhead_2
                                          wild_ia4yf wild2_XA s1_X7ICC
                                   of
                                   { (# ipv2_X7ICI, ipv3_X7ICK #) ->
                                   case ipv3_X7ICK of
                                   { Buffer ww1_sb68i ww2_sb68j ww3_sb68k ww4_sb68l ww5_sb68m
                                            ww6_sb68n ->
                                   jump $w$j_sb68p
                                     ipv2_X7ICI
                                     ww1_sb68i
                                     ww2_sb68j
                                     ww3_sb68k
                                     ww4_sb68l
                                     ww5_sb68m
                                     ww6_sb68n
                                   }
                                   };
                                 1# ->
                                   case ds7_ia4yx of {
                                     LF ->
                                       jump $w$j_sb68p
                                         s1_X7ICC
                                         dt4_db3tS
                                         dt5_db3tT
                                         ds_db3jK
                                         dt6_db3tU
                                         dt7_db3tV
                                         dt8_db3tW;
                                     CRLF ->
                                       case readWideCharOffAddr#
                                              @ RealWorld dt4_db3tS dt7_db3tV s1_X7ICC
                                       of
                                       { (# ipv2_ib3iK, ipv3_ib3iL #) ->
                                       case touch#
                                              @ 'LiftedRep
                                              @ GHC.ForeignPtr.ForeignPtrContents
                                              dt5_db3tT
                                              ipv2_ib3iK
                                       of s'1_ib3iN
                                       { __DEFAULT ->
                                       case ipv3_ib3iL of {
                                         __DEFAULT ->
                                           jump $w$j_sb68p
                                             s'1_ib3iN
                                             dt4_db3tS
                                             dt5_db3tT
                                             ds_db3jK
                                             dt6_db3tU
                                             dt7_db3tV
                                             dt8_db3tW;
                                         '\r'# ->
                                           case writeWideCharOffAddr#
                                                  @ RealWorld dt4_db3tS 0# '\r'# s'1_ib3iN
                                           of s2_ib3dC
                                           { __DEFAULT ->
                                           case touch#
                                                  @ 'LiftedRep
                                                  @ GHC.ForeignPtr.ForeignPtrContents
                                                  dt5_db3tT
                                                  s2_ib3dC
                                           of s'2_ib3dD
                                           { __DEFAULT ->
                                           case GHC.IO.Handle.Internals.hLookAhead_2
                                                  wild_ia4yf
                                                  (GHC.IO.Buffer.Buffer
                                                     @ Char
                                                     dt4_db3tS
                                                     dt5_db3tT
                                                     ds_db3jK
                                                     dt6_db3tU
                                                     0#
                                                     1#)
                                                  s'2_ib3dD
                                           of
                                           { (# ipv4_X7ICI, ipv5_X7ICK #) ->
                                           case ipv5_X7ICK of
                                           { Buffer ww1_sb68i ww2_sb68j ww3_sb68k ww4_sb68l
                                                    ww5_sb68m ww6_sb68n ->
                                           jump $w$j_sb68p
                                             ipv4_X7ICI
                                             ww1_sb68i
                                             ww2_sb68j
                                             ww3_sb68k
                                             ww4_sb68l
                                             ww5_sb68m
                                             ww6_sb68n
                                           }
                                           }
                                           }
                                           }
                                       }
                                       }
                                       }
                                   }
                               }
                               })
                            (\ (e1_ib3yU [OS=OneShot] :: SomeException)
                               (eta2_Xu [OS=OneShot] :: State# RealWorld) ->
                               case e1_ib3yU of wild2_ia562
                               { SomeException @ e2_ia565 $dException1_ia566 e3_ia567 ->
                               case Data.Typeable.Internal.sameTypeRep
                                      @ *
                                      @ *
                                      @ e2_ia565
                                      @ IOException
                                      ((GHC.Exception.$p1Exception @ e2_ia565 $dException1_ia566)
                                       `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <e2_ia565>_N
                                               :: (Typeable e2_ia565 :: Constraint)
                                                  ~R# (Data.Typeable.Internal.TypeRep
                                                         e2_ia565 :: *)))
                                      GHC.IO.Exception.$fExceptionIOException4
                               of {
                                 False ->
                                   raiseIO#
                                     @ SomeException @ (Handle__, [Char]) wild2_ia562 eta2_Xu;
                                 True ->
                                   case GHC.IO.Handle.Internals.hClose_help1 wild_ia4yf eta2_Xu of
                                   { (# ipv2_X7ICO, ipv3_X7ICQ #) ->
                                   case ipv3_X7ICQ of { (handle_'_ab2cD, ds_db3ls) ->
                                   (# ipv2_X7ICO,
                                      (handle_'_ab2cD,
                                       case e3_ia567
                                            `cast` (UnsafeCo representational e2_ia565 IOException
                                                    :: (e2_ia565 :: *) ~R# (IOException :: *))
                                       of
                                       { IOError ds13_ib3lc ds14_ib3ld ds15_ib3le ds16_ib3lf
                                                 ds17_ib3lg ds18_ib3lh ->
                                       case ds14_ib3ld of wild6_ib3lj {
                                         __DEFAULT ->
                                           $wlvl_rb6WI
                                             handle_ab2ca
                                             wild6_ib3lj
                                             ds16_ib3lf
                                             ds17_ib3lg
                                             ds18_ib3lh;
                                         EOF ->
                                           case ipv1_i7IAz of
                                           { Buffer dt4_ia4wr dt5_ia4ws ds19_ia4wz dt6_ia4wA
                                                    dt7_ia4wB dt8_ia4wC ->
                                           case ==# dt7_ia4wB dt8_ia4wC of {
                                             __DEFAULT -> lvl4_rb6WH;
                                             1# -> GHC.Types.[] @ Char
                                           }
                                           }
                                       }
                                       }) #)
                                   }
                                   }
                               }
                               })
                            ipv_i7IAy
                          }
                      }
                      } } in
              case handle_ab2ca of wild_X2C {
                FileHandle ds_da4Ia dt_da4Vt ->
                  GHC.IO.Handle.Internals.$wwithHandle'
                    @ [Char]
                    GHC.IO.Handle.Text.hGetContents3
                    wild_X2C
                    dt_da4Vt
                    (act_sb417
                     `cast` (<Handle__>_R
                             ->_R Sym (GHC.Types.N:IO[0] <(Handle__, [Char])>_R)
                             :: (Handle__
                                 -> State# RealWorld
                                 -> (# State# RealWorld, (Handle__, [Char]) #) :: *)
                                ~R# (Handle__ -> IO (Handle__, [Char]) :: *)))
                    s'_ib3kd;
                DuplexHandle ds_da4Ib dt_da4Vu dt1_da4Vv ->
                  GHC.IO.Handle.Internals.$wwithHandle'
                    @ [Char]
                    GHC.IO.Handle.Text.hGetContents3
                    wild_X2C
                    dt_da4Vu
                    (act_sb417
                     `cast` (<Handle__>_R
                             ->_R Sym (GHC.Types.N:IO[0] <(Handle__, [Char])>_R)
                             :: (Handle__
                                 -> State# RealWorld
                                 -> (# State# RealWorld, (Handle__, [Char]) #) :: *)
                                ~R# (Handle__ -> IO (Handle__, [Char]) :: *)))
                    s'_ib3kd
              }
              })
           `cast` (Sym (GHC.Types.N:IO[0] <[Char]>_R)
                   :: (State# RealWorld -> (# State# RealWorld, [Char] #) :: *)
                      ~R# (IO [Char] :: *))))
       `cast` (GHC.Types.N:IO[0] <[Char]>_R
               :: (IO [Char] :: *)
                  ~R# (State# RealWorld -> (# State# RealWorld, [Char] #) :: *)))
        eta_B1
end Rec }

-- RHS size: {terms: 37, types: 81, coercions: 7, joins: 0/0}
GHC.IO.Handle.Text.hGetContents1
  :: Handle -> State# RealWorld -> (# State# RealWorld, String #)
[GblId,
 Arity=2,
 Str=<S,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0 0] 110 0}]
GHC.IO.Handle.Text.hGetContents1
  = \ (handle_ab2c7 :: Handle) (eta_B1 :: State# RealWorld) ->
      GHC.IO.Handle.Internals.wantReadableHandle1
        @ String
        GHC.IO.Handle.Text.hGetContents3
        handle_ab2c7
        ((\ (handle__ab2c8 :: Handle__)
            (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
            case GHC.IO.Handle.Text.hGetContents2 handle_ab2c7 s_i7IAv of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            (# ipv_i7IAy,
               (case handle__ab2c8 of
                { Handle__ @ dev_ia3Gt @ enc_state_ia3Gu @ dec_state_ia3Gv ds_db3ma
                           ds2_db3mb ds3_db3mc ds4_db3md ds5_db3me dt_db3ub ds6_db3mg
                           dt1_db3uc dt2_db3ud dt3_db3ue ds7_db3mk ds8_db3ml ds9_db3mm
                           ds10_db3mn ds11_db3mo ds12_db3mp ->
                GHC.IO.Handle.Types.Handle__
                  @ dev_ia3Gt
                  @ enc_state_ia3Gu
                  @ dec_state_ia3Gv
                  ds_db3ma
                  ds2_db3mb
                  ds3_db3mc
                  ds4_db3md
                  GHC.IO.Handle.Types.SemiClosedHandle
                  dt_db3ub
                  ds6_db3mg
                  dt1_db3uc
                  dt2_db3ud
                  dt3_db3ue
                  ds7_db3mk
                  ds8_db3ml
                  ds9_db3mm
                  ds10_db3mn
                  ds11_db3mo
                  ds12_db3mp
                },
                ipv1_i7IAz) #)
            })
         `cast` (<Handle__>_R
                 ->_R Sym (GHC.Types.N:IO[0] <(Handle__, String)>_R)
                 :: (Handle__
                     -> State# RealWorld
                     -> (# State# RealWorld, (Handle__, String) #) :: *)
                    ~R# (Handle__ -> IO (Handle__, String) :: *)))
        eta_B1

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
hGetContents :: Handle -> IO String
[GblId,
 Arity=2,
 Str=<S,U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetContents1
               `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
                       :: (Handle
                           -> State# RealWorld -> (# State# RealWorld, String #) :: *)
                          ~R# (Handle -> IO String :: *))}]
hGetContents
  = GHC.IO.Handle.Text.hGetContents1
    `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
            :: (Handle
                -> State# RealWorld -> (# State# RealWorld, String #) :: *)
               ~R# (Handle -> IO String :: *))

Rec {
-- RHS size: {terms: 10, types: 13, coercions: 0, joins: 0/0}
go_rb6WP :: [[Char]] -> [Char]
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,1*U>, Unf=OtherCon []]
go_rb6WP
  = \ (ds_i7Jck :: [[Char]]) ->
      case ds_i7Jck of {
        [] -> GHC.Types.[] @ Char;
        : y_i7Jcp ys_i7Jcq -> ++ @ Char y_i7Jcp (go_rb6WP ys_i7Jcq)
      }
end Rec }

Rec {
-- RHS size: {terms: 10, types: 13, coercions: 0, joins: 0/0}
go1_rb6WQ :: [[Char]] -> [Char]
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,1*U>, Unf=OtherCon []]
go1_rb6WQ
  = \ (ds_i7Jck :: [[Char]]) ->
      case ds_i7Jck of {
        [] -> GHC.Types.[] @ Char;
        : y_i7Jcp ys_i7Jcq -> ++ @ Char y_i7Jcp (go1_rb6WQ ys_i7Jcq)
      }
end Rec }

Rec {
-- RHS size: {terms: 366, types: 447, coercions: 0, joins: 7/9}
GHC.IO.Handle.Text.$whGetLineBufferedLoop [InlPrag=NOUSERINLINE[0],
                                           Occ=LoopBreaker]
  :: Handle__
     -> Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> BufferState
     -> Int#
     -> Int#
     -> Int#
     -> [String]
     -> State# RealWorld
     -> (# State# RealWorld, String #)
[GblId,
 Arity=9,
 Str=<S,1*U><L,U><L,U><L,U><L,U><S,U><S,U><L,U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Text.$whGetLineBufferedLoop
  = \ (w_sb69a :: Handle__)
      (ww_sb69g :: Addr#)
      (ww1_sb69h :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sb69i :: BufferState)
      (ww3_sb69j :: Int#)
      (ww4_sb69k :: Int#)
      (ww5_sb69l :: Int#)
      (w1_sb69c :: [String])
      (w2_sb69d :: State# RealWorld) ->
      case w_sb69a of wild_X1u
      { Handle__ @ dev_ab2Qu @ enc_state_ab2Qv @ dec_state_ab2Qw
                 $dIODevice_ab2Qx $dBufferedIO_ab2Qy $dTypeable_ab2Qz ds_db3ol
                 ds1_db3om dt_db3uf ds2_db3oo dt1_db3ug dt2_db3uh dt3_db3ui
                 ds3_db3os ds4_db3ot ds5_db3ou ds6_db3ov ds7_db3ow ds8_db3ox ->
      join {
        $w$j_sb691 [InlPrag=NOUSERINLINE[0],
                    Dmd=<C(C(C(S))),C(C1(C1(U(U,U))))>]
          :: State# RealWorld
             -> Bool -> Int# -> (# State# RealWorld, String #)
        [LclId[JoinId(3)], Arity=3, Str=<S,U><L,U><S,U>, Unf=OtherCon []]
        $w$j_sb691 (w3_sb68Q [OS=OneShot] :: State# RealWorld)
                   (ww6_sb68U [OS=OneShot] :: Bool)
                   (ww7_sb68Y [OS=OneShot] :: Int#)
          = join {
              $w$j1_sb68F [InlPrag=NOUSERINLINE[0], Dmd=<L,C(C1(C1(U(U,U))))>]
                :: State# RealWorld
                   -> [Char] -> Int -> (# State# RealWorld, String #)
              [LclId[JoinId(3)],
               Arity=3,
               Str=<S,U><L,U><L,1*U(U)>,
               Unf=OtherCon []]
              $w$j1_sb68F (w4_sb68y [OS=OneShot] :: State# RealWorld)
                          (ww8_sb68C [OS=OneShot] :: [Char])
                          (ww9_sb68D [OS=OneShot] :: Int)
                = case ww6_sb68U of {
                    False ->
                      let {
                        buf1_sb411 [Dmd=<L,U(U,U,U,U,U,U)>] :: Buffer Char
                        [LclId]
                        buf1_sb411
                          = case ww9_sb68D of { I# x_ib3kL ->
                            case ==# x_ib3kL ww5_sb69l of {
                              __DEFAULT ->
                                GHC.IO.Buffer.Buffer
                                  @ Char ww_sb69g ww1_sb69h ww2_sb69i ww3_sb69j x_ib3kL ww5_sb69l;
                              1# ->
                                GHC.IO.Buffer.Buffer
                                  @ Char ww_sb69g ww1_sb69h ww2_sb69i ww3_sb69j 0# 0#
                            }
                            } } in
                      case catch#
                             @ (Maybe CharBuffer)
                             @ SomeException
                             (\ (s_i7IAv [OS=OneShot] :: State# RealWorld) ->
                                case buf1_sb411 of wild2_XA
                                { Buffer dt4_db3tS dt5_db3tT ds9_db3jK dt6_db3tU dt7_db3tV
                                         dt8_db3tW ->
                                case -# dt8_db3tW dt7_db3tV of {
                                  __DEFAULT -> (# s_i7IAv, GHC.Base.Just @ CharBuffer wild2_XA #);
                                  0# ->
                                    case GHC.IO.Handle.Internals.hLookAhead_2
                                           wild_X1u wild2_XA s_i7IAv
                                    of
                                    { (# ipv_X7IHE, ipv1_X7IHG #) ->
                                    (# ipv_X7IHE, GHC.Base.Just @ CharBuffer ipv1_X7IHG #)
                                    };
                                  1# ->
                                    case ds6_db3ov of {
                                      LF -> (# s_i7IAv, GHC.Base.Just @ CharBuffer wild2_XA #);
                                      CRLF ->
                                        case readWideCharOffAddr#
                                               @ RealWorld dt4_db3tS dt7_db3tV s_i7IAv
                                        of
                                        { (# ipv_ib3iK, ipv1_ib3iL #) ->
                                        case touch#
                                               @ 'LiftedRep
                                               @ GHC.ForeignPtr.ForeignPtrContents
                                               dt5_db3tT
                                               ipv_ib3iK
                                        of s'_ib3iN
                                        { __DEFAULT ->
                                        case ipv1_ib3iL of {
                                          __DEFAULT ->
                                            (# s'_ib3iN, GHC.Base.Just @ CharBuffer wild2_XA #);
                                          '\r'# ->
                                            case writeWideCharOffAddr#
                                                   @ RealWorld dt4_db3tS 0# '\r'# s'_ib3iN
                                            of s2_ib3dC
                                            { __DEFAULT ->
                                            case touch#
                                                   @ 'LiftedRep
                                                   @ GHC.ForeignPtr.ForeignPtrContents
                                                   dt5_db3tT
                                                   s2_ib3dC
                                            of s'1_ib3dD
                                            { __DEFAULT ->
                                            case GHC.IO.Handle.Internals.hLookAhead_2
                                                   wild_X1u
                                                   (GHC.IO.Buffer.Buffer
                                                      @ Char
                                                      dt4_db3tS
                                                      dt5_db3tT
                                                      ds9_db3jK
                                                      dt6_db3tU
                                                      0#
                                                      1#)
                                                   s'1_ib3dD
                                            of
                                            { (# ipv2_X7IHE, ipv3_X7IHG #) ->
                                            (# ipv2_X7IHE, GHC.Base.Just @ CharBuffer ipv3_X7IHG #)
                                            }
                                            }
                                            }
                                        }
                                        }
                                        }
                                    }
                                }
                                })
                             GHC.IO.Handle.Text.hGetChar3
                             w4_sb68y
                      of
                      { (# ipv_X7IDi, ipv1_X7IDk #) ->
                      case ipv1_X7IDk of {
                        Nothing ->
                          case writeMutVar#
                                 @ RealWorld
                                 @ (Buffer CharBufElem)
                                 dt2_db3uh
                                 (case buf1_sb411 of
                                  { Buffer dt4_db3uo dt5_db3up ds10_db3n2 dt6_db3uq dt7_db3ur
                                           dt8_db3us ->
                                  GHC.IO.Buffer.Buffer
                                    @ CharBufElem dt4_db3uo dt5_db3up ds10_db3n2 dt6_db3uq 0# 0#
                                  })
                                 ipv_X7IDi
                          of s2#_i7IBe
                          { __DEFAULT ->
                          case go1_rb6WQ
                                 (GHC.List.reverse1
                                    @ [Char]
                                    (GHC.Types.:
                                       @ [Char]
                                       (case buf1_sb411 of
                                        { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
                                                 dt8_ia4wC ->
                                        case ==# dt7_ia4wB dt8_ia4wC of {
                                          __DEFAULT -> lvl4_rb6WH;
                                          1# -> GHC.Types.[] @ Char
                                        }
                                        })
                                       (GHC.Types.: @ [Char] ww8_sb68C w1_sb69c))
                                    (GHC.Types.[] @ [Char]))
                          of wild3_i8hrH {
                            [] -> GHC.IO.Handle.Internals.ioe_EOF1 @ String s2#_i7IBe;
                            : ds10_i8hNn ds11_i8hNo -> (# s2#_i7IBe, wild3_i8hrH #)
                          }
                          };
                        Just new_buf_ab2bG ->
                          case new_buf_ab2bG of
                          { Buffer ww11_Xb6e1 ww12_Xb6e3 ww13_Xb6e5 ww14_Xb6e7 ww15_Xb6e9
                                   ww16_Xb6eb ->
                          GHC.IO.Handle.Text.$whGetLineBufferedLoop
                            wild_X1u
                            ww11_Xb6e1
                            ww12_Xb6e3
                            ww13_Xb6e5
                            ww14_Xb6e7
                            ww15_Xb6e9
                            ww16_Xb6eb
                            (GHC.Types.: @ [Char] ww8_sb68C w1_sb69c)
                            ipv_X7IDi
                          }
                      }
                      };
                    True ->
                      case writeMutVar#
                             @ RealWorld
                             @ (Buffer CharBufElem)
                             dt2_db3uh
                             (let {
                                x_ib3kL [Dmd=<S,U>] :: Int#
                                [LclId]
                                x_ib3kL = +# ww7_sb68Y 1# } in
                              case ==# x_ib3kL ww5_sb69l of {
                                __DEFAULT ->
                                  GHC.IO.Buffer.Buffer
                                    @ Char ww_sb69g ww1_sb69h ww2_sb69i ww3_sb69j x_ib3kL ww5_sb69l;
                                1# ->
                                  GHC.IO.Buffer.Buffer
                                    @ Char ww_sb69g ww1_sb69h ww2_sb69i ww3_sb69j 0# 0#
                              })
                             w4_sb68y
                      of s2#_i7IBe
                      { __DEFAULT ->
                      (# s2#_i7IBe,
                         go_rb6WP
                           (GHC.List.reverse1
                              @ [Char]
                              (GHC.Types.: @ [Char] ww8_sb68C w1_sb69c)
                              (GHC.Types.[] @ [Char])) #)
                      }
                  } } in
            case ds6_db3ov of {
              LF ->
                case ==# ww4_sb69k ww7_sb68Y of {
                  __DEFAULT ->
                    join {
                      $j_sb5Kr [Dmd=<C(C(S)),C(C1(U(U,U)))>]
                        :: State# RealWorld
                           -> [CharBufElem] -> (# State# RealWorld, String #)
                      [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U>]
                      $j_sb5Kr (ipv_ib3v2 [OS=OneShot] :: State# RealWorld)
                               (ipv1_ib3v3 [OS=OneShot] :: [CharBufElem])
                        = case touch#
                                 @ 'LiftedRep
                                 @ GHC.ForeignPtr.ForeignPtrContents
                                 ww1_sb69h
                                 ipv_ib3v2
                          of s'_ib3va
                          { __DEFAULT ->
                          jump $w$j1_sb68F s'_ib3va ipv1_ib3v3 (GHC.Types.I# ww7_sb68Y)
                          } } in
                    joinrec {
                      $wunpackRB_sb68P [InlPrag=NOUSERINLINE[0], Occ=LoopBreaker]
                        :: [CharBufElem]
                           -> Int# -> State# RealWorld -> (# State# RealWorld, String #)
                      [LclId[JoinId(3)], Arity=3, Str=<L,U><S,U><S,U>, Unf=OtherCon []]
                      $wunpackRB_sb68P (w4_sb68I :: [CharBufElem])
                                       (ww8_sb68N :: Int#)
                                       (w5_sb68K :: State# RealWorld)
                        = case <# ww8_sb68N ww4_sb69k of {
                            __DEFAULT ->
                              case readWideCharOffAddr# @ RealWorld ww_sb69g ww8_sb68N w5_sb68K
                              of
                              { (# ipv_i7O62, ipv1_i7O63 #) ->
                              jump $wunpackRB_sb68P
                                (GHC.Types.: @ CharBufElem (GHC.Types.C# ipv1_i7O63) w4_sb68I)
                                (-# ww8_sb68N 1#)
                                ipv_i7O62
                              };
                            1# -> jump $j_sb5Kr w5_sb68K w4_sb68I
                          }; } in
                    jump $wunpackRB_sb68P
                      (GHC.Types.[] @ Char) (-# ww7_sb68Y 1#) w3_sb68Q;
                  1# ->
                    jump $w$j1_sb68F
                      w3_sb68Q (GHC.Types.[] @ Char) (GHC.Types.I# ww7_sb68Y)
                };
              CRLF ->
                case $wunpack_nl_rb6WF
                       ww_sb69g
                       ww1_sb69h
                       ww4_sb69k
                       ww7_sb68Y
                       (GHC.Types.[] @ Char)
                       w3_sb68Q
                of
                { (# ipv_X7ID0, ipv1_X7ID2 #) ->
                case ipv1_X7ID2 of { (ww9_sb68C, ww10_sb68D) ->
                jump $w$j1_sb68F ipv_X7ID0 ww9_sb68C ww10_sb68D
                }
                }
            } } in
      join {
        exit_X2Z [Dmd=<L,C(C1(U(U,U)))>]
          :: Int# -> State# RealWorld -> (# State# RealWorld, String #)
        [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>]
        exit_X2Z (ww6_sb697 [OS=OneShot] :: Int#)
                 (s'_ib3iN [OS=OneShot]
                    :: State# RealWorld
                    Unf=OtherCon [])
          = jump $w$j_sb691 s'_ib3iN GHC.Types.True ww6_sb697 } in
      join {
        exit1_X2S [Dmd=<L,C(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, String #)
        [LclId[JoinId(1)], Arity=1, Str=<S,U>]
        exit1_X2S (w3_sb694 [OS=OneShot] :: State# RealWorld)
          = jump $w$j_sb691 w3_sb694 GHC.Types.False ww5_sb69l } in
      joinrec {
        $wloop_sb699 [InlPrag=NOUSERINLINE[0], Occ=LoopBreaker]
          :: RawCharBuffer
             -> Int# -> State# RealWorld -> (# State# RealWorld, String #)
        [LclId[JoinId(3)],
         Arity=3,
         Str=<L,1*U(U,U)><S,U><S,U>,
         Unf=OtherCon []]
        $wloop_sb699 (w3_sb692 :: RawCharBuffer)
                     (ww6_sb697 :: Int#)
                     (w4_sb694 :: State# RealWorld)
          = case ==# ww6_sb697 ww5_sb69l of {
              __DEFAULT ->
                case w3_sb692 of wild1_ib3iz
                { GHC.ForeignPtr.ForeignPtr fo_ib3iB ds9_ib3iC ->
                case readWideCharOffAddr# @ RealWorld fo_ib3iB ww6_sb697 w4_sb694
                of
                { (# ipv_ib3iK, ipv1_ib3iL #) ->
                case touch#
                       @ 'LiftedRep
                       @ GHC.ForeignPtr.ForeignPtrContents
                       ds9_ib3iC
                       ipv_ib3iK
                of s'_ib3iN
                { __DEFAULT ->
                case ipv1_ib3iL of {
                  __DEFAULT ->
                    jump $wloop_sb699 wild1_ib3iz (+# ww6_sb697 1#) s'_ib3iN;
                  '\n'# -> jump exit_X2Z ww6_sb697 s'_ib3iN
                }
                }
                }
                };
              1# -> jump exit1_X2S w4_sb694
            }; } in
      jump $wloop_sb699
        (GHC.ForeignPtr.ForeignPtr @ Char ww_sb69g ww1_sb69h)
        ww4_sb69k
        w2_sb69d
      }
end Rec }

-- RHS size: {terms: 17, types: 13, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetLine3 [InlPrag=NOUSERINLINE[0]]
  :: Handle__
     -> CharBuffer
     -> [String]
     -> State# RealWorld
     -> (# State# RealWorld, String #)
[GblId,
 Arity=4,
 Str=<S,1*U><S(SLLSSS),1*U(U,U,U,U,U,U)><L,U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=4,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_sb69a [Occ=Once] :: Handle__)
                 (w1_sb69b [Occ=Once!] :: CharBuffer)
                 (w2_sb69c [Occ=Once] :: [String])
                 (w3_sb69d [Occ=Once] :: State# RealWorld) ->
                 case w1_sb69b of
                 { Buffer ww1_sb69g [Occ=Once] ww2_sb69h [Occ=Once]
                          ww3_sb69i [Occ=Once] ww4_sb69j [Occ=Once] ww5_sb69k [Occ=Once]
                          ww6_sb69l [Occ=Once] ->
                 GHC.IO.Handle.Text.$whGetLineBufferedLoop
                   w_sb69a
                   ww1_sb69g
                   ww2_sb69h
                   ww3_sb69i
                   ww4_sb69j
                   ww5_sb69k
                   ww6_sb69l
                   w2_sb69c
                   w3_sb69d
                 }}]
GHC.IO.Handle.Text.hGetLine3
  = \ (w_sb69a :: Handle__)
      (w1_sb69b :: CharBuffer)
      (w2_sb69c :: [String])
      (w3_sb69d :: State# RealWorld) ->
      case w1_sb69b of
      { Buffer ww1_sb69g ww2_sb69h ww3_sb69i ww4_sb69j ww5_sb69k
               ww6_sb69l ->
      GHC.IO.Handle.Text.$whGetLineBufferedLoop
        w_sb69a
        ww1_sb69g
        ww2_sb69h
        ww3_sb69i
        ww4_sb69j
        ww5_sb69k
        ww6_sb69l
        w2_sb69c
        w3_sb69d
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetLine5 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hGetLine5 = "hGetLine"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetLine4 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hGetLine4
  = unpackCString# GHC.IO.Handle.Text.hGetLine5

-- RHS size: {terms: 23, types: 76, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetLine2
  :: Handle__ -> State# RealWorld -> (# State# RealWorld, String #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (handle__ab2aT [Occ=Once!] :: Handle__)
                 (eta_B1 [Occ=Once] :: State# RealWorld) ->
                 case handle__ab2aT of wild_X1u
                 { Handle__ @ dev_ab2ST @ enc_state_ab2SU @ dec_state_ab2SV
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead]
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] dt2_db3uv [Occ=Once]
                            _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead] _ [Occ=Dead]
                            _ [Occ=Dead] _ [Occ=Dead] ->
                 case readMutVar#
                        @ RealWorld @ (Buffer CharBufElem) dt2_db3uv eta_B1
                 of
                 { (# ipv_i7IAy [Occ=Once], ipv1_i7IAz [Occ=Once] #) ->
                 GHC.IO.Handle.Text.hGetLine3
                   wild_X1u ipv1_i7IAz (GHC.Types.[] @ String) ipv_i7IAy
                 }
                 }}]
GHC.IO.Handle.Text.hGetLine2
  = \ (handle__ab2aT :: Handle__) (eta_B1 :: State# RealWorld) ->
      case handle__ab2aT of wild_X1u
      { Handle__ @ dev_ab2ST @ enc_state_ab2SU @ dec_state_ab2SV
                 $dIODevice_ab2SW $dBufferedIO_ab2SX $dTypeable_ab2SY ds_db3p6
                 ds1_db3p7 dt_db3ut ds2_db3p9 dt1_db3uu dt2_db3uv dt3_db3uw
                 ds3_db3pd ds4_db3pe ds5_db3pf ds6_db3pg ds7_db3ph ds8_db3pi ->
      case readMutVar#
             @ RealWorld @ (Buffer CharBufElem) dt2_db3uv eta_B1
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of
      { Buffer ww1_sb69g ww2_sb69h ww3_sb69i ww4_sb69j ww5_sb69k
               ww6_sb69l ->
      GHC.IO.Handle.Text.$whGetLineBufferedLoop
        wild_X1u
        ww1_sb69g
        ww2_sb69h
        ww3_sb69i
        ww4_sb69j
        ww5_sb69k
        ww6_sb69l
        (GHC.Types.[] @ String)
        ipv_i7IAy
      }
      }
      }

-- RHS size: {terms: 5, types: 2, coercions: 5, joins: 0/0}
GHC.IO.Handle.Text.hGetLine1
  :: Handle -> State# RealWorld -> (# State# RealWorld, String #)
[GblId,
 Arity=2,
 Str=<L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (h_ab2aS [Occ=Once] :: Handle) ->
                 GHC.IO.Handle.Internals.wantReadableHandle_1
                   @ String
                   GHC.IO.Handle.Text.hGetLine4
                   h_ab2aS
                   (GHC.IO.Handle.Text.hGetLine2
                    `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
                            :: (Handle__
                                -> State# RealWorld -> (# State# RealWorld, String #) :: *)
                               ~R# (Handle__ -> IO String :: *)))}]
GHC.IO.Handle.Text.hGetLine1
  = \ (h_ab2aS :: Handle) ->
      GHC.IO.Handle.Internals.wantReadableHandle_1
        @ String
        GHC.IO.Handle.Text.hGetLine4
        h_ab2aS
        (GHC.IO.Handle.Text.hGetLine2
         `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
                 :: (Handle__
                     -> State# RealWorld -> (# State# RealWorld, String #) :: *)
                    ~R# (Handle__ -> IO String :: *)))

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
hGetLine :: Handle -> IO String
[GblId,
 Arity=2,
 Str=<L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetLine1
               `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
                       :: (Handle
                           -> State# RealWorld -> (# State# RealWorld, String #) :: *)
                          ~R# (Handle -> IO String :: *))}]
hGetLine
  = GHC.IO.Handle.Text.hGetLine1
    `cast` (<Handle>_R ->_R Sym (GHC.Types.N:IO[0] <String>_R)
            :: (Handle
                -> State# RealWorld -> (# State# RealWorld, String #) :: *)
               ~R# (Handle -> IO String :: *))

-- RHS size: {terms: 16, types: 33, coercions: 0, joins: 0/0}
lvl11_rb6WR :: Data.Typeable.Internal.TypeRep FD
[GblId]
lvl11_rb6WR
  = case Data.Typeable.Internal.$wmkTrCon
           @ *
           @ FD
           10838815552519039062##
           15546290101957756376##
           GHC.IO.FD.$trModule
           GHC.IO.FD.$tcFD1
           0#
           GHC.Types.krep$*
           (GHC.Types.[] @ Data.Typeable.Internal.SomeTypeRep)
    of
    { (# ww8_i8htw, ww9_i8htx, ww10_i8hty, ww11_i8htz, ww12_i8htA #) ->
    Data.Typeable.Internal.TrTyCon
      @ * @ FD ww8_i8htw ww9_i8htx ww10_i8hty ww11_i8htz ww12_i8htA
    }

Rec {
-- RHS size: {terms: 127, types: 140, coercions: 0, joins: 0/1}
GHC.IO.Handle.Text.hGetBufNonBlocking2
  :: Handle__
     -> Buffer Word8
     -> Ptr Word8
     -> Int
     -> Int
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=6,
 Str=<S,1*U><S(SLLLSS),1*U(U,U,U,U,U,U)><S(S),1*U(U)><L,1*U(U)><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [20 20 40 60 20 0] 338 60}]
GHC.IO.Handle.Text.hGetBufNonBlocking2
  = \ (h__ab2j2 :: Handle__)
      (buf_ab2jg :: Buffer Word8)
      (ptr_ab2jl :: Ptr Word8)
      (so_far_ab2jm :: Int)
      (count_ab2jn :: Int)
      (eta_B1 :: State# RealWorld) ->
      case h__ab2j2 of wild_X1A
      { Handle__ @ dev_ab2sk @ enc_state_ab2sl @ dec_state_ab2sm
                 $dIODevice_ab2sn $dBufferedIO_ab2so $dTypeable_ab2sp ds_db2YD
                 ds1_db2YE dt_db3rk ds2_db2YG dt1_db3rl dt2_db3rm dt3_db3rn
                 ds3_db2YK ds4_db2YL ds5_db2YM ds6_db2YN ds7_db2YO ds8_db2YP ->
      case buf_ab2jg of
      { Buffer dt4_db3ro dt5_db3rp ds9_db2YR dt6_db3rq dt7_db3rr
               dt8_db3rs ->
      case count_ab2jn of { I# x_alN9 ->
      let {
        avail_sb40N [Dmd=<S,U>] :: Int#
        [LclId]
        avail_sb40N = -# dt8_db3rs dt7_db3rr } in
      case <# x_alN9 avail_sb40N of {
        __DEFAULT ->
          case ptr_ab2jl of { GHC.Ptr.Ptr ds11_db3ra ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                 ds11_db3ra
                 (plusAddr# dt4_db3ro dt7_db3rr)
                 (int2Word# avail_sb40N)
                 eta_B1
          of
          { (# ds12_db3rg, ds13_db3rf #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_db3rp
                 ds12_db3rg
          of s'_ib3va
          { __DEFAULT ->
          case writeMutVar#
                 @ RealWorld
                 @ (Buffer Word8)
                 dt_db3rk
                 (GHC.IO.Buffer.Buffer
                    @ Word8 dt4_db3ro dt5_db3rp ds9_db2YR dt6_db3rq 0# 0#)
                 s'_ib3va
          of s2#_i7IBe
          { __DEFAULT ->
          case -# x_alN9 avail_sb40N of wild4_X4F {
            __DEFAULT ->
              GHC.IO.Handle.Text.$wbufReadNBEmpty
                wild_X1A
                dt6_db3rq
                (GHC.Ptr.Ptr @ Word8 (plusAddr# ds11_db3ra avail_sb40N))
                (case so_far_ab2jm of { I# x1_i7MX1 ->
                 GHC.Types.I# (+# x1_i7MX1 avail_sb40N)
                 })
                wild4_X4F
                s2#_i7IBe;
            0# ->
              (# s2#_i7IBe,
                 case so_far_ab2jm of { I# x1_i7MX1 ->
                 GHC.Types.I# (+# x1_i7MX1 avail_sb40N)
                 } #)
          }
          }
          }
          }
          };
        1# ->
          case ptr_ab2jl of { GHC.Ptr.Ptr ds11_db3ra ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                 ds11_db3ra
                 (plusAddr# dt4_db3ro dt7_db3rr)
                 (int2Word# x_alN9)
                 eta_B1
          of
          { (# ds12_db3rg, ds13_db3rf #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_db3rp
                 ds12_db3rg
          of s'_ib3va
          { __DEFAULT ->
          case writeMutVar#
                 @ RealWorld
                 @ (Buffer Word8)
                 dt_db3rk
                 (GHC.IO.Buffer.Buffer
                    @ Word8
                    dt4_db3ro
                    dt5_db3rp
                    ds9_db2YR
                    dt6_db3rq
                    (+# dt7_db3rr x_alN9)
                    dt8_db3rs)
                 s'_ib3va
          of s2#_i7IBe
          { __DEFAULT ->
          (# s2#_i7IBe,
             case so_far_ab2jm of { I# x1_i7MX1 ->
             GHC.Types.I# (+# x1_i7MX1 x_alN9)
             } #)
          }
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 122, types: 182, coercions: 18, joins: 1/1}
GHC.IO.Handle.Text.$wbufReadNBEmpty [InlPrag=NOUSERINLINE[0],
                                     Occ=LoopBreaker]
  :: Handle__
     -> Int#
     -> Ptr Word8
     -> Int
     -> Int#
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=6,
 Str=<S,1*U><S,U><L,1*U(U)><L,U(U)><S,U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Text.$wbufReadNBEmpty
  = \ (w_sb69M :: Handle__)
      (ww_sb69X :: Int#)
      (w1_sb69O :: Ptr Word8)
      (w2_sb69P :: Int)
      (ww1_sb6a3 :: Int#)
      (w3_sb69R :: State# RealWorld) ->
      case w_sb69M of wild_X1B
      { Handle__ @ dev_ab2tW @ enc_state_ab2tX @ dec_state_ab2tY
                 $dIODevice_ab2tZ $dBufferedIO_ab2u0 $dTypeable_ab2u1 ds_db303
                 ds1_db304 dt_db3rD ds2_db306 dt1_db3rE dt2_db3rF dt3_db3rG
                 ds3_db30a ds4_db30b ds5_db30c ds6_db30d ds7_db30e ds8_db30f ->
      case ds_db303
           `cast` (UnsafeCo representational dev_ab2tW FD
                   :: (dev_ab2tW :: *) ~R# (FD :: *))
      of ww2_sb6Dn
      { FD ww3_sb6Do ww4_sb6Dp ->
      join {
        fail_sb40J [Dmd=<L,1*C1(U(U,U))>]
          :: Void# -> (# State# RealWorld, Int #)
        [LclId[JoinId(1)], Arity=1, Str=<L,A>, Unf=OtherCon []]
        fail_sb40J _ [Occ=Dead, OS=OneShot]
          = case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3rD w3_sb69R
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            case ((Buffered.fillReadBuffer0
                     @ dev_ab2tW
                     $dBufferedIO_ab2u0
                     (ww2_sb6Dn
                      `cast` (UnsafeCo representational FD dev_ab2tW
                              :: (FD :: *) ~R# (dev_ab2tW :: *)))
                     ipv1_i7IAz)
                  `cast` (GHC.Types.N:IO[0] <(Maybe Int, Buffer Word8)>_R
                          :: (IO (Maybe Int, Buffer Word8) :: *)
                             ~R# (State# RealWorld
                                  -> (# State# RealWorld, (Maybe Int, Buffer Word8) #) :: *)))
                   ipv_i7IAy
            of
            { (# ipv2_X7ICU, ipv3_X7ICW #) ->
            case ipv3_X7ICW of { (r_ab2iZ, buf'_ab2j0) ->
            case r_ab2iZ of {
              Nothing -> (# ipv2_X7ICU, w2_sb69P #);
              Just ds12_db2Zd ->
                case ds12_db2Zd of wild3_X18 { I# ds13_db2Ze ->
                case ds13_db2Ze of ds14_Xb30o {
                  __DEFAULT ->
                    case writeMutVar#
                           @ RealWorld @ (Buffer Word8) dt_db3rD buf'_ab2j0 ipv2_X7ICU
                    of s2#_i7IBe
                    { __DEFAULT ->
                    case <=# ww1_sb6a3 ds14_Xb30o of {
                      __DEFAULT ->
                        GHC.IO.Handle.Text.hGetBufNonBlocking2
                          wild_X1B buf'_ab2j0 w1_sb69O w2_sb69P wild3_X18 s2#_i7IBe;
                      1# ->
                        GHC.IO.Handle.Text.hGetBufNonBlocking2
                          wild_X1B
                          buf'_ab2j0
                          w1_sb69O
                          w2_sb69P
                          (GHC.Types.I# ww1_sb6a3)
                          s2#_i7IBe
                    }
                    };
                  0# -> (# ipv2_X7ICU, w2_sb69P #)
                }
                }
            }
            }
            }
            } } in
      case ># ww1_sb6a3 ww_sb69X of {
        __DEFAULT -> jump fail_sb40J void#;
        1# ->
          case Data.Typeable.Internal.sameTypeRep
                 @ *
                 @ *
                 @ dev_ab2tW
                 @ FD
                 ($dTypeable_ab2u1
                  `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <dev_ab2tW>_N
                          :: (Typeable dev_ab2tW :: Constraint)
                             ~R# (Data.Typeable.Internal.TypeRep dev_ab2tW :: *)))
                 lvl11_rb6WR
          of {
            False -> jump fail_sb40J void#;
            True ->
              case w1_sb69O of { GHC.Ptr.Ptr ww6_saWpM ->
              case GHC.IO.FD.$wreadRawBufferPtrNoBlock
                     GHC.IO.FD.$fBufferedIOFD8
                     ww3_sb6Do
                     ww4_sb6Dp
                     ww6_saWpM
                     0#
                     (int2Word# ww1_sb6a3)
                     w3_sb69R
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              case ipv1_i7IAz of { I# ds10_daUId ->
              case ds10_daUId of ds11_XaUJ5 {
                __DEFAULT ->
                  (# ipv_i7IAy,
                     case w2_sb69P of { I# x_i7MX1 ->
                     GHC.Types.I# (+# x_i7MX1 ds11_XaUJ5)
                     } #);
                -1# -> (# ipv_i7IAy, w2_sb69P #)
              }
              }
              }
              }
          }
      }
      }
      }
end Rec }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBufNonBlocking4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 60 0}]
GHC.IO.Handle.Text.hGetBufNonBlocking4 = "hGetBufNonBlocking"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBufNonBlocking3 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hGetBufNonBlocking3
  = unpackCString# GHC.IO.Handle.Text.hGetBufNonBlocking4

-- RHS size: {terms: 186, types: 299, coercions: 21, joins: 1/2}
GHC.IO.Handle.Text.$whGetBufNonBlocking [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int# -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 30 0] 614 30}]
GHC.IO.Handle.Text.$whGetBufNonBlocking
  = \ (@ a_sb6a9)
      (w_sb6aa :: Handle)
      (w1_sb6ab :: Ptr a_sb6a9)
      (ww_sb6ag :: Int#)
      (w2_sb6ad :: State# RealWorld) ->
      case ww_sb6ag of wild_X3O {
        __DEFAULT ->
          case <# wild_X3O 0# of {
            __DEFAULT ->
              let {
                wild1_a22E [Dmd=<L,U(U)>] :: Int
                [LclId, Unf=OtherCon []]
                wild1_a22E = GHC.Types.I# wild_X3O } in
              GHC.IO.Handle.Internals.wantReadableHandle_1
                @ Int
                GHC.IO.Handle.Text.hGetBufNonBlocking3
                w_sb6aa
                ((\ (h__ab2ig :: Handle__)
                    (eta_X6 [OS=OneShot] :: State# RealWorld) ->
                    case h__ab2ig of wild2_XA
                    { Handle__ @ dev_ab2vj @ enc_state_ab2vk @ dec_state_ab2vl
                               $dIODevice_ab2vm $dBufferedIO_ab2vn $dTypeable_ab2vo ds_db31c
                               ds1_db31d dt_db3rM ds2_db31f dt1_db3rN dt2_db3rO dt3_db3rP
                               ds3_db31j ds4_db31k ds5_db31l ds6_db31m ds7_db31n ds8_db31o ->
                    case readMutVar#
                           @ RealWorld @ (Buffer CharBufElem) dt2_db3rO eta_X6
                    of
                    { (# ipv_i7IAy, ipv1_i7IAz #) ->
                    case ipv1_i7IAz of
                    { Buffer dt4_ia4xp dt5_ia4xq ds11_ia4xr dt6_ia4xs dt7_ia4xt
                             dt8_ia4xu ->
                    join {
                      $w$j_sb6a8 [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
                        :: State# RealWorld -> (# State# RealWorld, Int #)
                      [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                      $w$j_sb6a8 (w3_sb6a6 [OS=OneShot] :: State# RealWorld)
                        = case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3rM w3_sb6a6
                          of
                          { (# ipv2_X7IHG, ipv3_X7IHI #) ->
                          case ipv3_X7IHI of wild4_XV
                          { Buffer dt10_db3rQ dt11_db3rR ds13_db30H dt12_db3rS dt13_db3rT
                                   dt14_db3rU ->
                          case ==# dt13_db3rT dt14_db3rU of {
                            __DEFAULT ->
                              GHC.IO.Handle.Text.hGetBufNonBlocking2
                                wild2_XA
                                wild4_XV
                                (w1_sb6ab
                                 `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6a9, Word8))_R
                                         :: (Ptr a_sb6a9 :: *) ~R# (Ptr Word8 :: *)))
                                GHC.IO.Handle.Text.hGetBuf3
                                wild1_a22E
                                ipv2_X7IHG;
                            1# ->
                              GHC.IO.Handle.Text.$wbufReadNBEmpty
                                wild2_XA
                                dt12_db3rS
                                (w1_sb6ab
                                 `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6a9, Word8))_R
                                         :: (Ptr a_sb6a9 :: *) ~R# (Ptr Word8 :: *)))
                                GHC.IO.Handle.Text.hGetBuf3
                                wild_X3O
                                ipv2_X7IHG
                          }
                          }
                          } } in
                    case ds11_ia4xr of {
                      ReadBuffer ->
                        case ==# dt7_ia4xt dt8_ia4xu of {
                          __DEFAULT ->
                            case readMutVar#
                                   @ RealWorld @ (dec_state_ab2vl, Buffer Word8) dt1_db3rN ipv_i7IAy
                            of
                            { (# ipv2_X7ID4, ipv3_X7ID6 #) ->
                            case ipv3_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
                            case readMutVar#
                                   @ RealWorld @ (Buffer CharBufElem) dt2_db3rO ipv2_X7ID4
                            of
                            { (# ipv4_X7IDi, ipv5_X7IDk #) ->
                            case writeMutVar#
                                   @ RealWorld
                                   @ (Buffer CharBufElem)
                                   dt2_db3rO
                                   (case ipv5_X7IDk of
                                    { Buffer dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI dt12_da4VJ
                                             dt13_da4VK ->
                                    GHC.IO.Buffer.Buffer
                                      @ CharBufElem dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI 0# 0#
                                    })
                                   ipv4_X7IDi
                            of s2#_i7IBe
                            { __DEFAULT ->
                            case ipv5_X7IDk of
                            { Buffer dt9_ia4zH dt10_ia4zI ds14_ia4zJ dt11_ia4zK dt12_ia4zL
                                     dt13_ia4zM ->
                            case dt12_ia4zL of wild7_X3Y {
                              __DEFAULT ->
                                case ds4_db31k of {
                                  Nothing ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3rM
                                           (case bbuf0_aa3K7 of
                                            { Buffer dt14_da4VL dt15_da4VM ds15_da4LW dt16_da4VN
                                                     dt17_da4VO dt18_da4VP ->
                                            GHC.IO.Buffer.Buffer
                                              @ Word8
                                              dt14_da4VL
                                              dt15_da4VM
                                              ds15_da4LW
                                              dt16_da4VN
                                              (+# dt17_da4VO wild7_X3Y)
                                              dt18_da4VP
                                            })
                                           s2#_i7IBe
                                    of s2#1_X7IH7
                                    { __DEFAULT ->
                                    jump $w$j_sb6a8 s2#1_X7IH7
                                    };
                                  Just decoder_aa3K9 ->
                                    case decoder_aa3K9 of
                                    { BufferCodec ds15_ia4Mf ds16_ia4Mg ds17_ia4Mh ds18_ia4Mi
                                                  ds19_ia4Mj ->
                                    case ((ds19_ia4Mj codec_state_aa3K6)
                                          `cast` (GHC.Types.N:IO[0] <()>_R
                                                  :: (IO () :: *)
                                                     ~R# (State# RealWorld
                                                          -> (# State# RealWorld, () #) :: *)))
                                           s2#_i7IBe
                                    of
                                    { (# ipv6_X7JlR, ipv7_X7JlT #) ->
                                    case GHC.IO.Handle.Internals.$wstreamEncode
                                           @ Word8
                                           @ CharBufElem
                                           @ dec_state_ab2vl
                                           ds15_ia4Mf
                                           ds16_ia4Mg
                                           bbuf0_aa3K7
                                           (GHC.IO.Buffer.Buffer
                                              @ CharBufElem
                                              dt9_ia4zH
                                              dt10_ia4zI
                                              ds14_ia4zJ
                                              wild7_X3Y
                                              0#
                                              0#)
                                           ipv6_X7JlR
                                    of
                                    { (# ipv8_X7IGW, ipv9_X7IDM #) ->
                                    case ipv9_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3rM
                                           bbuf1_aa3Ka
                                           ipv8_X7IGW
                                    of s2#1_X7IHx
                                    { __DEFAULT ->
                                    jump $w$j_sb6a8 s2#1_X7IHx
                                    }
                                    }
                                    }
                                    }
                                    }
                                };
                              0# ->
                                case writeMutVar#
                                       @ RealWorld @ (Buffer Word8) dt_db3rM bbuf0_aa3K7 s2#_i7IBe
                                of s2#1_X7IH3
                                { __DEFAULT ->
                                jump $w$j_sb6a8 s2#1_X7IH3
                                }
                            }
                            }
                            }
                            }
                            }
                            };
                          1# -> jump $w$j_sb6a8 ipv_i7IAy
                        };
                      WriteBuffer -> jump $w$j_sb6a8 ipv_i7IAy
                    }
                    }
                    }
                    })
                 `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                         :: (Handle__
                             -> State# RealWorld -> (# State# RealWorld, Int #) :: *)
                            ~R# (Handle__ -> IO Int :: *)))
                w2_sb6ad;
            1# ->
              GHC.IO.Handle.Text.$willegalBufferSize
                @ Int
                w_sb6aa
                GHC.IO.Handle.Text.hGetBufNonBlocking3
                wild_X3O
                w2_sb6ad
          };
        0# -> (# w2_sb6ad, GHC.IO.Handle.Text.hGetBuf3 #)
      }

-- RHS size: {terms: 13, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBufNonBlocking1 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=4,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sb6a9)
                 (w_sb6aa [Occ=Once] :: Handle)
                 (w1_sb6ab [Occ=Once] :: Ptr a_sb6a9)
                 (w2_sb6ac [Occ=Once!] :: Int)
                 (w3_sb6ad [Occ=Once] :: State# RealWorld) ->
                 case w2_sb6ac of { I# ww1_sb6ag [Occ=Once] ->
                 GHC.IO.Handle.Text.$whGetBufNonBlocking
                   @ a_sb6a9 w_sb6aa w1_sb6ab ww1_sb6ag w3_sb6ad
                 }}]
GHC.IO.Handle.Text.hGetBufNonBlocking1
  = \ (@ a_sb6a9)
      (w_sb6aa :: Handle)
      (w1_sb6ab :: Ptr a_sb6a9)
      (w2_sb6ac :: Int)
      (w3_sb6ad :: State# RealWorld) ->
      case w2_sb6ac of { I# ww1_sb6ag ->
      GHC.IO.Handle.Text.$whGetBufNonBlocking
        @ a_sb6a9 w_sb6aa w1_sb6ab ww1_sb6ag w3_sb6ad
      }

-- RHS size: {terms: 1, types: 0, coercions: 13, joins: 0/0}
hGetBufNonBlocking :: forall a. Handle -> Ptr a -> Int -> IO Int
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetBufNonBlocking1
               `cast` (forall (a :: <*>_N).
                       <Handle>_R
                       ->_R <Ptr a>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                       :: (forall a.
                           Handle
                           -> Ptr a
                           -> Int
                           -> State# RealWorld
                           -> (# State# RealWorld, Int #) :: *)
                          ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))}]
hGetBufNonBlocking
  = GHC.IO.Handle.Text.hGetBufNonBlocking1
    `cast` (forall (a :: <*>_N).
            <Handle>_R
            ->_R <Ptr a>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
            :: (forall a.
                Handle
                -> Ptr a
                -> Int
                -> State# RealWorld
                -> (# State# RealWorld, Int #) :: *)
               ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl12_rb6WS :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl12_rb6WS = "hGetBufSome"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl13_rb6WT :: [Char]
[GblId]
lvl13_rb6WT = unpackCString# lvl12_rb6WS

-- RHS size: {terms: 276, types: 366, coercions: 59, joins: 2/4}
GHC.IO.Handle.Text.$whGetBufSome [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int# -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId, Arity=4, Str=<L,U><L,U(U)><S,1*U><S,U>, Unf=OtherCon []]
GHC.IO.Handle.Text.$whGetBufSome
  = \ (@ a_sb6an)
      (w_sb6ao :: Handle)
      (w1_sb6ap :: Ptr a_sb6an)
      (ww_sb6au :: Int#)
      (w2_sb6ar :: State# RealWorld) ->
      case ww_sb6au of wild_X41 {
        __DEFAULT ->
          case <# wild_X41 0# of {
            __DEFAULT ->
              let {
                wild1_a22E [Dmd=<L,U(U)>] :: Int
                [LclId, Unf=OtherCon []]
                wild1_a22E = GHC.Types.I# wild_X41 } in
              GHC.IO.Handle.Internals.wantReadableHandle_1
                @ Int
                lvl13_rb6WT
                w_sb6ao
                ((\ (h__ab2hF :: Handle__)
                    (eta_X6 [OS=OneShot] :: State# RealWorld) ->
                    case h__ab2hF of wild2_XB
                    { Handle__ @ dev_ab2wc @ enc_state_ab2wd @ dec_state_ab2we
                               $dIODevice_ab2wf $dBufferedIO_ab2wg $dTypeable_ab2wh ds_db33a
                               ds1_db33b dt_db3rZ ds2_db33d dt1_db3s0 dt2_db3s1 dt3_db3s2
                               ds3_db33h ds4_db33i ds5_db33j ds6_db33k ds7_db33l ds8_db33m ->
                    case ds_db33a
                         `cast` (UnsafeCo representational dev_ab2wc FD
                                 :: (dev_ab2wc :: *) ~R# (FD :: *))
                    of ww1_sb6Dt
                    { FD ww2_sb6Du ww3_sb6Dv ->
                    case readMutVar#
                           @ RealWorld @ (Buffer CharBufElem) dt2_db3s1 eta_X6
                    of
                    { (# ipv_i7IAy, ipv1_i7IAz #) ->
                    case ipv1_i7IAz of
                    { Buffer dt4_ia4xp dt5_ia4xq ds11_ia4xr dt6_ia4xs dt7_ia4xt
                             dt8_ia4xu ->
                    join {
                      $w$j_sb6am [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
                        :: State# RealWorld -> (# State# RealWorld, Int #)
                      [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                      $w$j_sb6am (w3_sb6ak [OS=OneShot] :: State# RealWorld)
                        = case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3rZ w3_sb6ak
                          of
                          { (# ipv2_X7IHT, ipv3_X7IHV #) ->
                          case ipv3_X7IHV of wild4_XX
                          { Buffer dt10_db3s3 dt11_db3s4 ds13_db32F dt12_db3s5 dt13_db3s6
                                   dt14_db3s7 ->
                          case ==# dt13_db3s6 dt14_db3s7 of {
                            __DEFAULT ->
                              let {
                                y1_sb40F [Dmd=<S,U>] :: Int#
                                [LclId]
                                y1_sb40F = -# dt14_db3s7 dt13_db3s6 } in
                              case <=# wild_X41 y1_sb40F of {
                                __DEFAULT ->
                                  GHC.IO.Handle.Text.hGetBufNonBlocking2
                                    wild2_XB
                                    wild4_XX
                                    (w1_sb6ap
                                     `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6an, Word8))_R
                                             :: (Ptr a_sb6an :: *) ~R# (Ptr Word8 :: *)))
                                    GHC.IO.Handle.Text.hGetBuf3
                                    (GHC.Types.I# y1_sb40F)
                                    ipv2_X7IHT;
                                1# ->
                                  GHC.IO.Handle.Text.hGetBufNonBlocking2
                                    wild2_XB
                                    wild4_XX
                                    (w1_sb6ap
                                     `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6an, Word8))_R
                                             :: (Ptr a_sb6an :: *) ~R# (Ptr Word8 :: *)))
                                    GHC.IO.Handle.Text.hGetBuf3
                                    wild1_a22E
                                    ipv2_X7IHT
                              };
                            1# ->
                              join {
                                fail_sb40H [Dmd=<L,1*C1(U(U,U))>]
                                  :: Void# -> (# State# RealWorld, Int #)
                                [LclId[JoinId(1)], Arity=1, Str=<L,A>, Unf=OtherCon []]
                                fail_sb40H _ [Occ=Dead, OS=OneShot]
                                  = case ((Buffered.fillReadBuffer
                                             @ dev_ab2wc
                                             $dBufferedIO_ab2wg
                                             (ww1_sb6Dt
                                              `cast` (UnsafeCo representational FD dev_ab2wc
                                                      :: (FD :: *) ~R# (dev_ab2wc :: *)))
                                             wild4_XX)
                                          `cast` (GHC.Types.N:IO[0] <(Int, Buffer Word8)>_R
                                                  :: (IO (Int, Buffer Word8) :: *)
                                                     ~R# (State# RealWorld
                                                          -> (# State# RealWorld,
                                                                (Int, Buffer Word8) #) :: *)))
                                           ipv2_X7IHT
                                    of
                                    { (# ipv4_X7IDd, ipv5_X7IDf #) ->
                                    case ipv5_X7IDf of { (r_ab2hW, buf'_ab2hX) ->
                                    case r_ab2hW of wild6_X27X { I# x_X281 ->
                                    case x_X281 of wild7_X5q {
                                      __DEFAULT ->
                                        case writeMutVar#
                                               @ RealWorld
                                               @ (Buffer Word8)
                                               dt_db3rZ
                                               buf'_ab2hX
                                               ipv4_X7IDd
                                        of s2#_i7IBe
                                        { __DEFAULT ->
                                        case <=# wild7_X5q wild_X41 of {
                                          __DEFAULT ->
                                            GHC.IO.Handle.Text.hGetBufNonBlocking2
                                              wild2_XB
                                              buf'_ab2hX
                                              (w1_sb6ap
                                               `cast` ((Ptr
                                                          Univ(phantom phantom <*>_N
                                                               :: a_sb6an, Word8))_R
                                                       :: (Ptr a_sb6an :: *) ~R# (Ptr Word8 :: *)))
                                              GHC.IO.Handle.Text.hGetBuf3
                                              wild1_a22E
                                              s2#_i7IBe;
                                          1# ->
                                            GHC.IO.Handle.Text.hGetBufNonBlocking2
                                              wild2_XB
                                              buf'_ab2hX
                                              (w1_sb6ap
                                               `cast` ((Ptr
                                                          Univ(phantom phantom <*>_N
                                                               :: a_sb6an, Word8))_R
                                                       :: (Ptr a_sb6an :: *) ~R# (Ptr Word8 :: *)))
                                              GHC.IO.Handle.Text.hGetBuf3
                                              wild6_X27X
                                              s2#_i7IBe
                                        }
                                        };
                                      0# -> (# ipv4_X7IDd, GHC.IO.Handle.Text.hGetBuf3 #)
                                    }
                                    }
                                    }
                                    } } in
                              case ># wild_X41 dt12_db3s5 of {
                                __DEFAULT -> jump fail_sb40H void#;
                                1# ->
                                  case Data.Typeable.Internal.sameTypeRep
                                         @ *
                                         @ *
                                         @ dev_ab2wc
                                         @ FD
                                         ($dTypeable_ab2wh
                                          `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <dev_ab2wc>_N
                                                  :: (Typeable dev_ab2wc :: Constraint)
                                                     ~R# (Data.Typeable.Internal.TypeRep
                                                            dev_ab2wc :: *)))
                                         lvl11_rb6WR
                                  of {
                                    False -> jump fail_sb40H void#;
                                    True ->
                                      case w1_sb6ap
                                           `cast` ((Ptr
                                                      Univ(phantom phantom <*>_N
                                                           :: a_sb6an, Word8))_R
                                                   :: (Ptr a_sb6an :: *) ~R# (Ptr Word8 :: *))
                                      of
                                      { GHC.Ptr.Ptr ww5_saWqg ->
                                      GHC.IO.FD.$wreadRawBufferPtr
                                        GHC.IO.FD.$fBufferedIOFD12
                                        ww2_sb6Du
                                        ww3_sb6Dv
                                        ww5_saWqg
                                        0#
                                        (int2Word# wild_X41)
                                        ipv2_X7IHT
                                      }
                                  }
                              }
                          }
                          }
                          } } in
                    case ds11_ia4xr of {
                      ReadBuffer ->
                        case ==# dt7_ia4xt dt8_ia4xu of {
                          __DEFAULT ->
                            case readMutVar#
                                   @ RealWorld @ (dec_state_ab2we, Buffer Word8) dt1_db3s0 ipv_i7IAy
                            of
                            { (# ipv2_X7ID4, ipv3_X7ID6 #) ->
                            case ipv3_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
                            case readMutVar#
                                   @ RealWorld @ (Buffer CharBufElem) dt2_db3s1 ipv2_X7ID4
                            of
                            { (# ipv4_X7IDi, ipv5_X7IDk #) ->
                            case writeMutVar#
                                   @ RealWorld
                                   @ (Buffer CharBufElem)
                                   dt2_db3s1
                                   (case ipv5_X7IDk of
                                    { Buffer dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI dt12_da4VJ
                                             dt13_da4VK ->
                                    GHC.IO.Buffer.Buffer
                                      @ CharBufElem dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI 0# 0#
                                    })
                                   ipv4_X7IDi
                            of s2#_i7IBe
                            { __DEFAULT ->
                            case ipv5_X7IDk of
                            { Buffer dt9_ia4zH dt10_ia4zI ds14_ia4zJ dt11_ia4zK dt12_ia4zL
                                     dt13_ia4zM ->
                            case dt12_ia4zL of wild7_X3Y {
                              __DEFAULT ->
                                case ds4_db33i of {
                                  Nothing ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3rZ
                                           (case bbuf0_aa3K7 of
                                            { Buffer dt14_da4VL dt15_da4VM ds15_da4LW dt16_da4VN
                                                     dt17_da4VO dt18_da4VP ->
                                            GHC.IO.Buffer.Buffer
                                              @ Word8
                                              dt14_da4VL
                                              dt15_da4VM
                                              ds15_da4LW
                                              dt16_da4VN
                                              (+# dt17_da4VO wild7_X3Y)
                                              dt18_da4VP
                                            })
                                           s2#_i7IBe
                                    of s2#1_X7IH7
                                    { __DEFAULT ->
                                    jump $w$j_sb6am s2#1_X7IH7
                                    };
                                  Just decoder_aa3K9 ->
                                    case decoder_aa3K9 of
                                    { BufferCodec ds15_ia4Mf ds16_ia4Mg ds17_ia4Mh ds18_ia4Mi
                                                  ds19_ia4Mj ->
                                    case ((ds19_ia4Mj codec_state_aa3K6)
                                          `cast` (GHC.Types.N:IO[0] <()>_R
                                                  :: (IO () :: *)
                                                     ~R# (State# RealWorld
                                                          -> (# State# RealWorld, () #) :: *)))
                                           s2#_i7IBe
                                    of
                                    { (# ipv6_X7JlR, ipv7_X7JlT #) ->
                                    case GHC.IO.Handle.Internals.$wstreamEncode
                                           @ Word8
                                           @ CharBufElem
                                           @ dec_state_ab2we
                                           ds15_ia4Mf
                                           ds16_ia4Mg
                                           bbuf0_aa3K7
                                           (GHC.IO.Buffer.Buffer
                                              @ CharBufElem
                                              dt9_ia4zH
                                              dt10_ia4zI
                                              ds14_ia4zJ
                                              wild7_X3Y
                                              0#
                                              0#)
                                           ipv6_X7JlR
                                    of
                                    { (# ipv8_X7IGW, ipv9_X7IDM #) ->
                                    case ipv9_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3rZ
                                           bbuf1_aa3Ka
                                           ipv8_X7IGW
                                    of s2#1_X7IHx
                                    { __DEFAULT ->
                                    jump $w$j_sb6am s2#1_X7IHx
                                    }
                                    }
                                    }
                                    }
                                    }
                                };
                              0# ->
                                case writeMutVar#
                                       @ RealWorld @ (Buffer Word8) dt_db3rZ bbuf0_aa3K7 s2#_i7IBe
                                of s2#1_X7IH3
                                { __DEFAULT ->
                                jump $w$j_sb6am s2#1_X7IH3
                                }
                            }
                            }
                            }
                            }
                            }
                            };
                          1# -> jump $w$j_sb6am ipv_i7IAy
                        };
                      WriteBuffer -> jump $w$j_sb6am ipv_i7IAy
                    }
                    }
                    }
                    }
                    })
                 `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                         :: (Handle__
                             -> State# RealWorld -> (# State# RealWorld, Int #) :: *)
                            ~R# (Handle__ -> IO Int :: *)))
                w2_sb6ar;
            1# ->
              GHC.IO.Handle.Text.$willegalBufferSize
                @ Int w_sb6ao lvl13_rb6WT wild_X41 w2_sb6ar
          };
        0# -> (# w2_sb6ar, GHC.IO.Handle.Text.hGetBuf3 #)
      }

-- RHS size: {terms: 13, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBufSome1 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=4,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sb6an)
                 (w_sb6ao [Occ=Once] :: Handle)
                 (w1_sb6ap [Occ=Once] :: Ptr a_sb6an)
                 (w2_sb6aq [Occ=Once!] :: Int)
                 (w3_sb6ar [Occ=Once] :: State# RealWorld) ->
                 case w2_sb6aq of { I# ww1_sb6au [Occ=Once] ->
                 GHC.IO.Handle.Text.$whGetBufSome
                   @ a_sb6an w_sb6ao w1_sb6ap ww1_sb6au w3_sb6ar
                 }}]
GHC.IO.Handle.Text.hGetBufSome1
  = \ (@ a_sb6an)
      (w_sb6ao :: Handle)
      (w1_sb6ap :: Ptr a_sb6an)
      (w2_sb6aq :: Int)
      (w3_sb6ar :: State# RealWorld) ->
      case w2_sb6aq of { I# ww1_sb6au ->
      GHC.IO.Handle.Text.$whGetBufSome
        @ a_sb6an w_sb6ao w1_sb6ap ww1_sb6au w3_sb6ar
      }

-- RHS size: {terms: 1, types: 0, coercions: 13, joins: 0/0}
hGetBufSome :: forall a. Handle -> Ptr a -> Int -> IO Int
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetBufSome1
               `cast` (forall (a :: <*>_N).
                       <Handle>_R
                       ->_R <Ptr a>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                       :: (forall a.
                           Handle
                           -> Ptr a
                           -> Int
                           -> State# RealWorld
                           -> (# State# RealWorld, Int #) :: *)
                          ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))}]
hGetBufSome
  = GHC.IO.Handle.Text.hGetBufSome1
    `cast` (forall (a :: <*>_N).
            <Handle>_R
            ->_R <Ptr a>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
            :: (forall a.
                Handle
                -> Ptr a
                -> Int
                -> State# RealWorld
                -> (# State# RealWorld, Int #) :: *)
               ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))

Rec {
-- RHS size: {terms: 124, types: 138, coercions: 0, joins: 0/2}
GHC.IO.Handle.Text.hGetBuf4
  :: Handle__
     -> Buffer Word8
     -> Ptr Word8
     -> Int
     -> Int
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=6,
 Str=<S,1*U><S(SLLLSS),1*U(U,U,U,U,U,U)><S(S),1*U(U)><S,1*U(U)><S(S),1*U(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [20 20 40 20 20 0] 338 60}]
GHC.IO.Handle.Text.hGetBuf4
  = \ (h__ab2gE :: Handle__)
      (buf_ab2gS :: Buffer Word8)
      (ptr_ab2gX :: Ptr Word8)
      (so_far_ab2gY :: Int)
      (count_ab2gZ :: Int)
      (eta_B1 :: State# RealWorld) ->
      case h__ab2gE of wild_X1F
      { Handle__ @ dev_ab2yC @ enc_state_ab2yD @ dec_state_ab2yE
                 $dIODevice_ab2yF $dBufferedIO_ab2yG $dTypeable_ab2yH ds_db35Z
                 ds1_db360 dt_db3sh ds2_db362 dt1_db3si dt2_db3sj dt3_db3sk
                 ds3_db366 ds4_db367 ds5_db368 ds6_db369 ds7_db36a ds8_db36b ->
      case buf_ab2gS of
      { Buffer dt4_db3sl dt5_db3sm ds9_db36d dt6_db3sn dt7_db3so
               dt8_db3sp ->
      case so_far_ab2gY of { I# ipv_sb3BF ->
      case count_ab2gZ of { I# ipv1_sb3BI ->
      let {
        avail_sb40t [Dmd=<S,U>] :: Int#
        [LclId]
        avail_sb40t = -# dt8_db3sp dt7_db3so } in
      case <# ipv1_sb3BI avail_sb40t of {
        __DEFAULT ->
          case ptr_ab2gX of { GHC.Ptr.Ptr ds11_db3ra ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                 ds11_db3ra
                 (plusAddr# dt4_db3sl dt7_db3so)
                 (int2Word# avail_sb40t)
                 eta_B1
          of
          { (# ds12_db3rg, ds13_db3rf #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_db3sm
                 ds12_db3rg
          of s'_ib3va
          { __DEFAULT ->
          let {
            buf'_sb40z [Dmd=<L,U(U,U,U,U,U,U)>] :: Buffer Word8
            [LclId, Unf=OtherCon []]
            buf'_sb40z
              = GHC.IO.Buffer.Buffer
                  @ Word8 dt4_db3sl dt5_db3sm ds9_db36d dt6_db3sn 0# 0# } in
          case writeMutVar#
                 @ RealWorld @ (Buffer Word8) dt_db3sh buf'_sb40z s'_ib3va
          of s2#_i7IBe
          { __DEFAULT ->
          case -# ipv1_sb3BI avail_sb40t of wild3_X5g {
            __DEFAULT ->
              GHC.IO.Handle.Text.hGetBuf2
                wild_X1F
                buf'_sb40z
                (GHC.Ptr.Ptr @ Word8 (plusAddr# ds11_db3ra avail_sb40t))
                (GHC.Types.I# (+# ipv_sb3BF avail_sb40t))
                (GHC.Types.I# wild3_X5g)
                s2#_i7IBe;
            0# -> (# s2#_i7IBe, GHC.Types.I# (+# ipv_sb3BF avail_sb40t) #)
          }
          }
          }
          }
          };
        1# ->
          case ptr_ab2gX of { GHC.Ptr.Ptr ds11_db3ra ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                 ds11_db3ra
                 (plusAddr# dt4_db3sl dt7_db3so)
                 (int2Word# ipv1_sb3BI)
                 eta_B1
          of
          { (# ds12_db3rg, ds13_db3rf #) ->
          case touch#
                 @ 'LiftedRep
                 @ GHC.ForeignPtr.ForeignPtrContents
                 dt5_db3sm
                 ds12_db3rg
          of s'_ib3va
          { __DEFAULT ->
          case writeMutVar#
                 @ RealWorld
                 @ (Buffer Word8)
                 dt_db3sh
                 (GHC.IO.Buffer.Buffer
                    @ Word8
                    dt4_db3sl
                    dt5_db3sm
                    ds9_db36d
                    dt6_db3sn
                    (+# dt7_db3so ipv1_sb3BI)
                    dt8_db3sp)
                 s'_ib3va
          of s2#_i7IBe
          { __DEFAULT ->
          (# s2#_i7IBe, GHC.Types.I# (+# ipv_sb3BF ipv1_sb3BI) #)
          }
          }
          }
          }
      }
      }
      }
      }
      }

-- RHS size: {terms: 147, types: 211, coercions: 13, joins: 4/4}
GHC.IO.Handle.Text.hGetBuf2 [Occ=LoopBreaker]
  :: Handle__
     -> Buffer Word8
     -> Ptr Word8
     -> Int
     -> Int
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=6,
 Str=<S,1*U><S(LLLSLL),1*U(U,U,U,U,U,U)><L,U(U)><L,U(U)><S(S),1*U(U)><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Text.hGetBuf2
  = \ (h__ab2h5 :: Handle__)
      (buf_ab2hj :: Buffer Word8)
      (ptr_ab2ho :: Ptr Word8)
      (so_far_ab2hp :: Int)
      (count_ab2hq :: Int)
      (eta_B1 :: State# RealWorld) ->
      case h__ab2h5 of wild_X1E
      { Handle__ @ dev_ab2xj @ enc_state_ab2xk @ dec_state_ab2xl
                 $dIODevice_ab2xm $dBufferedIO_ab2xn $dTypeable_ab2xo ds_db34j
                 ds1_db34k dt_db3s8 ds2_db34m dt1_db3s9 dt2_db3sa dt3_db3sb
                 ds3_db34q ds4_db34r ds5_db34s ds6_db34t ds7_db34u ds8_db34v ->
      case buf_ab2hj of wild1_XX
      { Buffer dt4_db3sc dt5_db3sd ds9_db34x dt6_db3se dt7_db3sf
               dt8_db3sg ->
      case count_ab2hq of wild2_aA1C { I# x_aA1E ->
      join {
        fail_sb40D [Dmd=<L,1*C1(U(U,U))>]
          :: Void# -> (# State# RealWorld, Int #)
        [LclId[JoinId(1)], Arity=1, Str=<L,A>, Unf=OtherCon []]
        fail_sb40D _ [Occ=Dead, OS=OneShot]
          = case ((Buffered.fillReadBuffer
                     @ dev_ab2xj $dBufferedIO_ab2xn ds_db34j wild1_XX)
                  `cast` (GHC.Types.N:IO[0] <(Int, Buffer Word8)>_R
                          :: (IO (Int, Buffer Word8) :: *)
                             ~R# (State# RealWorld
                                  -> (# State# RealWorld, (Int, Buffer Word8) #) :: *)))
                   eta_B1
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            case ipv1_i7IAz of { (r_ab2hA, buf'_ab2hB) ->
            case r_ab2hA of { I# x1_a22G ->
            case x1_a22G of {
              __DEFAULT ->
                case writeMutVar#
                       @ RealWorld @ (Buffer Word8) dt_db3s8 buf'_ab2hB ipv_i7IAy
                of s2#_i7IBe
                { __DEFAULT ->
                GHC.IO.Handle.Text.hGetBuf4
                  wild_X1E buf'_ab2hB ptr_ab2ho so_far_ab2hp wild2_aA1C s2#_i7IBe
                };
              0# -> (# ipv_i7IAy, so_far_ab2hp #)
            }
            }
            }
            } } in
      case ># x_aA1E dt6_db3se of {
        __DEFAULT -> jump fail_sb40D void#;
        1# ->
          case Data.Typeable.Internal.sameTypeRep
                 @ *
                 @ *
                 @ dev_ab2xj
                 @ FD
                 ($dTypeable_ab2xo
                  `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <dev_ab2xj>_N
                          :: (Typeable dev_ab2xj :: Constraint)
                             ~R# (Data.Typeable.Internal.TypeRep dev_ab2xj :: *)))
                 lvl11_rb6WR
          of {
            False -> jump fail_sb40D void#;
            True ->
              join {
                exit_X3d [Dmd=<L,C(C1(U(U,U)))>]
                  :: Int# -> State# RealWorld -> (# State# RealWorld, Int #)
                [LclId[JoinId(2)], Arity=2, Str=<L,U><S,U>]
                exit_X3d (d_i7NQq [OS=OneShot] :: Int#)
                         (ipv_i7IAy [OS=OneShot] :: State# RealWorld)
                  = (# ipv_i7IAy,
                       case so_far_ab2hp of { I# x1_i7MX1 ->
                       GHC.Types.I# (+# x1_i7MX1 d_i7NQq)
                       } #) } in
              join {
                exit1_X31 [Dmd=<L,C(C1(U(U,U)))>]
                  :: Int -> State# RealWorld -> (# State# RealWorld, Int #)
                [LclId[JoinId(2)], Arity=2, Str=<L,1*U(U)><S,U>]
                exit1_X31 (w_sb6b0 [OS=OneShot] :: Int)
                          (w1_sb6b2 [OS=OneShot] :: State# RealWorld)
                  = (# w1_sb6b2, GHC.Num.$fNumInt_$c+ so_far_ab2hp w_sb6b0 #) } in
              joinrec {
                $wloop_sb6b7 [InlPrag=NOUSERINLINE[0], Occ=LoopBreaker]
                  :: FD
                     -> Int -> Int# -> State# RealWorld -> (# State# RealWorld, Int #)
                [LclId[JoinId(4)],
                 Arity=4,
                 Str=<L,1*U(U,U)><L,1*U(U)><S,U><S,U>,
                 Unf=OtherCon []]
                $wloop_sb6b7 (w_sb6aZ :: FD)
                             (w1_sb6b0 :: Int)
                             (ww_sb6b5 :: Int#)
                             (w2_sb6b2 :: State# RealWorld)
                  = case <=# ww_sb6b5 0# of {
                      __DEFAULT ->
                        case ptr_ab2ho of { GHC.Ptr.Ptr addr_i7NQm ->
                        case w1_sb6b0 of { I# d_i7NQq ->
                        case w_sb6aZ of ww1_saWqa { FD ww2_saWqb ww3_saWqc ->
                        case GHC.IO.FD.$wreadRawBufferPtr
                               GHC.IO.FD.$fBufferedIOFD12
                               ww2_saWqb
                               ww3_saWqc
                               (plusAddr# addr_i7NQm d_i7NQq)
                               0#
                               (int2Word# ww_sb6b5)
                               w2_sb6b2
                        of
                        { (# ipv_i7IAy, ipv1_i7IAz #) ->
                        case ipv1_i7IAz of { I# x1_a22G ->
                        case x1_a22G of wild7_X5d {
                          __DEFAULT ->
                            jump $wloop_sb6b7
                              ww1_saWqa
                              (GHC.Types.I# (+# d_i7NQq wild7_X5d))
                              (-# ww_sb6b5 wild7_X5d)
                              ipv_i7IAy;
                          0# -> jump exit_X3d d_i7NQq ipv_i7IAy
                        }
                        }
                        }
                        }
                        }
                        };
                      1# -> jump exit1_X31 w1_sb6b0 w2_sb6b2
                    }; } in
              jump $wloop_sb6b7
                (ds_db34j
                 `cast` (UnsafeCo representational dev_ab2xj FD
                         :: (dev_ab2xj :: *) ~R# (FD :: *)))
                GHC.IO.Handle.Text.hGetBuf3
                x_aA1E
                eta_B1
          }
      }
      }
      }
      }
end Rec }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBuf6 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hGetBuf6 = "hGetBuf"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBuf5 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hGetBuf5
  = unpackCString# GHC.IO.Handle.Text.hGetBuf6

-- RHS size: {terms: 186, types: 299, coercions: 21, joins: 1/2}
GHC.IO.Handle.Text.$whGetBuf [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int# -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 30 0] 614 30}]
GHC.IO.Handle.Text.$whGetBuf
  = \ (@ a_sb6bu)
      (w_sb6bv :: Handle)
      (w1_sb6bw :: Ptr a_sb6bu)
      (ww_sb6bB :: Int#)
      (w2_sb6by :: State# RealWorld) ->
      case ww_sb6bB of wild_X4k {
        __DEFAULT ->
          case <# wild_X4k 0# of {
            __DEFAULT ->
              let {
                wild1_a22E [Dmd=<L,U(U)>] :: Int
                [LclId, Unf=OtherCon []]
                wild1_a22E = GHC.Types.I# wild_X4k } in
              GHC.IO.Handle.Internals.wantReadableHandle_1
                @ Int
                GHC.IO.Handle.Text.hGetBuf5
                w_sb6bv
                ((\ (h__ab2gl :: Handle__)
                    (eta_X6 [OS=OneShot] :: State# RealWorld) ->
                    case h__ab2gl of wild2_XE
                    { Handle__ @ dev_ab2Aw @ enc_state_ab2Ax @ dec_state_ab2Ay
                               $dIODevice_ab2Az $dBufferedIO_ab2AA $dTypeable_ab2AB ds_db376
                               ds1_db377 dt_db3sA ds2_db379 dt1_db3sB dt2_db3sC dt3_db3sD
                               ds3_db37d ds4_db37e ds5_db37f ds6_db37g ds7_db37h ds8_db37i ->
                    case readMutVar#
                           @ RealWorld @ (Buffer CharBufElem) dt2_db3sC eta_X6
                    of
                    { (# ipv_i7IAy, ipv1_i7IAz #) ->
                    case ipv1_i7IAz of
                    { Buffer dt4_ia4xp dt5_ia4xq ds11_ia4xr dt6_ia4xs dt7_ia4xt
                             dt8_ia4xu ->
                    join {
                      $w$j_sb6bt [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
                        :: State# RealWorld -> (# State# RealWorld, Int #)
                      [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                      $w$j_sb6bt (w3_sb6br [OS=OneShot] :: State# RealWorld)
                        = case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3sA w3_sb6br
                          of
                          { (# ipv2_X7IId, ipv3_X7IIf #) ->
                          case ipv3_X7IIf of wild4_XZ
                          { Buffer dt10_db3sE dt11_db3sF ds13_db36B dt12_db3sG dt13_db3sH
                                   dt14_db3sI ->
                          case ==# dt13_db3sH dt14_db3sI of {
                            __DEFAULT ->
                              GHC.IO.Handle.Text.hGetBuf4
                                wild2_XE
                                wild4_XZ
                                (w1_sb6bw
                                 `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6bu, Word8))_R
                                         :: (Ptr a_sb6bu :: *) ~R# (Ptr Word8 :: *)))
                                GHC.IO.Handle.Text.hGetBuf3
                                wild1_a22E
                                ipv2_X7IId;
                            1# ->
                              GHC.IO.Handle.Text.hGetBuf2
                                wild2_XE
                                wild4_XZ
                                (w1_sb6bw
                                 `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6bu, Word8))_R
                                         :: (Ptr a_sb6bu :: *) ~R# (Ptr Word8 :: *)))
                                GHC.IO.Handle.Text.hGetBuf3
                                wild1_a22E
                                ipv2_X7IId
                          }
                          }
                          } } in
                    case ds11_ia4xr of {
                      ReadBuffer ->
                        case ==# dt7_ia4xt dt8_ia4xu of {
                          __DEFAULT ->
                            case readMutVar#
                                   @ RealWorld @ (dec_state_ab2Ay, Buffer Word8) dt1_db3sB ipv_i7IAy
                            of
                            { (# ipv2_X7ID4, ipv3_X7ID6 #) ->
                            case ipv3_X7ID6 of { (codec_state_aa3K6, bbuf0_aa3K7) ->
                            case readMutVar#
                                   @ RealWorld @ (Buffer CharBufElem) dt2_db3sC ipv2_X7ID4
                            of
                            { (# ipv4_X7IDi, ipv5_X7IDk #) ->
                            case writeMutVar#
                                   @ RealWorld
                                   @ (Buffer CharBufElem)
                                   dt2_db3sC
                                   (case ipv5_X7IDk of
                                    { Buffer dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI dt12_da4VJ
                                             dt13_da4VK ->
                                    GHC.IO.Buffer.Buffer
                                      @ CharBufElem dt9_da4VG dt10_da4VH ds14_da4LG dt11_da4VI 0# 0#
                                    })
                                   ipv4_X7IDi
                            of s2#_i7IBe
                            { __DEFAULT ->
                            case ipv5_X7IDk of
                            { Buffer dt9_ia4zH dt10_ia4zI ds14_ia4zJ dt11_ia4zK dt12_ia4zL
                                     dt13_ia4zM ->
                            case dt12_ia4zL of wild7_X3Y {
                              __DEFAULT ->
                                case ds4_db37e of {
                                  Nothing ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3sA
                                           (case bbuf0_aa3K7 of
                                            { Buffer dt14_da4VL dt15_da4VM ds15_da4LW dt16_da4VN
                                                     dt17_da4VO dt18_da4VP ->
                                            GHC.IO.Buffer.Buffer
                                              @ Word8
                                              dt14_da4VL
                                              dt15_da4VM
                                              ds15_da4LW
                                              dt16_da4VN
                                              (+# dt17_da4VO wild7_X3Y)
                                              dt18_da4VP
                                            })
                                           s2#_i7IBe
                                    of s2#1_X7IH7
                                    { __DEFAULT ->
                                    jump $w$j_sb6bt s2#1_X7IH7
                                    };
                                  Just decoder_aa3K9 ->
                                    case decoder_aa3K9 of
                                    { BufferCodec ds15_ia4Mf ds16_ia4Mg ds17_ia4Mh ds18_ia4Mi
                                                  ds19_ia4Mj ->
                                    case ((ds19_ia4Mj codec_state_aa3K6)
                                          `cast` (GHC.Types.N:IO[0] <()>_R
                                                  :: (IO () :: *)
                                                     ~R# (State# RealWorld
                                                          -> (# State# RealWorld, () #) :: *)))
                                           s2#_i7IBe
                                    of
                                    { (# ipv6_X7JlR, ipv7_X7JlT #) ->
                                    case GHC.IO.Handle.Internals.$wstreamEncode
                                           @ Word8
                                           @ CharBufElem
                                           @ dec_state_ab2Ay
                                           ds15_ia4Mf
                                           ds16_ia4Mg
                                           bbuf0_aa3K7
                                           (GHC.IO.Buffer.Buffer
                                              @ CharBufElem
                                              dt9_ia4zH
                                              dt10_ia4zI
                                              ds14_ia4zJ
                                              wild7_X3Y
                                              0#
                                              0#)
                                           ipv6_X7JlR
                                    of
                                    { (# ipv8_X7IGW, ipv9_X7IDM #) ->
                                    case ipv9_X7IDM of { (bbuf1_aa3Ka, cbuf1_aa3Kb) ->
                                    case writeMutVar#
                                           @ RealWorld
                                           @ (Buffer Word8)
                                           dt_db3sA
                                           bbuf1_aa3Ka
                                           ipv8_X7IGW
                                    of s2#1_X7IHx
                                    { __DEFAULT ->
                                    jump $w$j_sb6bt s2#1_X7IHx
                                    }
                                    }
                                    }
                                    }
                                    }
                                };
                              0# ->
                                case writeMutVar#
                                       @ RealWorld @ (Buffer Word8) dt_db3sA bbuf0_aa3K7 s2#_i7IBe
                                of s2#1_X7IH3
                                { __DEFAULT ->
                                jump $w$j_sb6bt s2#1_X7IH3
                                }
                            }
                            }
                            }
                            }
                            }
                            };
                          1# -> jump $w$j_sb6bt ipv_i7IAy
                        };
                      WriteBuffer -> jump $w$j_sb6bt ipv_i7IAy
                    }
                    }
                    }
                    })
                 `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                         :: (Handle__
                             -> State# RealWorld -> (# State# RealWorld, Int #) :: *)
                            ~R# (Handle__ -> IO Int :: *)))
                w2_sb6by;
            1# ->
              GHC.IO.Handle.Text.$willegalBufferSize
                @ Int w_sb6bv GHC.IO.Handle.Text.hGetBuf5 wild_X4k w2_sb6by
          };
        0# -> (# w2_sb6by, GHC.IO.Handle.Text.hGetBuf3 #)
      }

-- RHS size: {terms: 13, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hGetBuf1 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a -> Int -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=4,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sb6bu)
                 (w_sb6bv [Occ=Once] :: Handle)
                 (w1_sb6bw [Occ=Once] :: Ptr a_sb6bu)
                 (w2_sb6bx [Occ=Once!] :: Int)
                 (w3_sb6by [Occ=Once] :: State# RealWorld) ->
                 case w2_sb6bx of { I# ww1_sb6bB [Occ=Once] ->
                 GHC.IO.Handle.Text.$whGetBuf
                   @ a_sb6bu w_sb6bv w1_sb6bw ww1_sb6bB w3_sb6by
                 }}]
GHC.IO.Handle.Text.hGetBuf1
  = \ (@ a_sb6bu)
      (w_sb6bv :: Handle)
      (w1_sb6bw :: Ptr a_sb6bu)
      (w2_sb6bx :: Int)
      (w3_sb6by :: State# RealWorld) ->
      case w2_sb6bx of { I# ww1_sb6bB ->
      GHC.IO.Handle.Text.$whGetBuf
        @ a_sb6bu w_sb6bv w1_sb6bw ww1_sb6bB w3_sb6by
      }

-- RHS size: {terms: 1, types: 0, coercions: 13, joins: 0/0}
hGetBuf :: forall a. Handle -> Ptr a -> Int -> IO Int
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hGetBuf1
               `cast` (forall (a :: <*>_N).
                       <Handle>_R
                       ->_R <Ptr a>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                       :: (forall a.
                           Handle
                           -> Ptr a
                           -> Int
                           -> State# RealWorld
                           -> (# State# RealWorld, Int #) :: *)
                          ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))}]
hGetBuf
  = GHC.IO.Handle.Text.hGetBuf1
    `cast` (forall (a :: <*>_N).
            <Handle>_R
            ->_R <Ptr a>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
            :: (forall a.
                Handle
                -> Ptr a
                -> Int
                -> State# RealWorld
                -> (# State# RealWorld, Int #) :: *)
               ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl14_rb6WU :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl14_rb6WU = "error"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl15_rb6WV :: [Char]
[GblId]
lvl15_rb6WV = unpackCString# lvl14_rb6WU

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl16_rb6WW :: [Char]
[GblId]
lvl16_rb6WW = unpackCString# GHC.IO.Handle.Text.$trModule4

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl17_rb6WX :: [Char]
[GblId]
lvl17_rb6WX = unpackCString# GHC.IO.Handle.Text.$trModule2

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl18_rb6WY :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl18_rb6WY = "./GHC/IO/Handle/Text.hs"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl19_rb6WZ :: [Char]
[GblId]
lvl19_rb6WZ = unpackCString# lvl18_rb6WY

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl20_rb6X0 :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl20_rb6X0 = GHC.Types.I# 785#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl21_rb6X1 :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl21_rb6X1 = GHC.Types.I# 17#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl22_rb6X2 :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl22_rb6X2 = GHC.Types.I# 38#

-- RHS size: {terms: 8, types: 0, coercions: 0, joins: 0/0}
lvl23_rb6X3 :: SrcLoc
[GblId, Str=m, Unf=OtherCon []]
lvl23_rb6X3
  = GHC.Stack.Types.SrcLoc
      lvl16_rb6WW
      lvl17_rb6WX
      lvl19_rb6WZ
      lvl20_rb6X0
      lvl21_rb6X1
      lvl20_rb6X0
      lvl22_rb6X2

-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
lvl24_rb6X4 :: CallStack
[GblId, Str=m2, Unf=OtherCon []]
lvl24_rb6X4
  = GHC.Stack.Types.PushCallStack
      lvl15_rb6WV lvl23_rb6X3 GHC.Stack.Types.EmptyCallStack

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl25_rb6X5 :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl25_rb6X5 = "Todo: hPutBuf"#

-- RHS size: {terms: 4, types: 3, coercions: 4, joins: 0/0}
lvl26_rb6X6 :: IO ()
[GblId, Str=x]
lvl26_rb6X6
  = error
      @ 'LiftedRep
      @ (IO ())
      (lvl24_rb6X4
       `cast` (Sym (GHC.Classes.N:IP[0] <"callStack">_N <CallStack>_N)
               :: (CallStack :: *) ~R# (?callStack::CallStack :: Constraint)))
      (unpackCString# lvl25_rb6X5)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl27_rb6X7 :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl27_rb6X7 = GHC.Types.I# 790#

-- RHS size: {terms: 8, types: 0, coercions: 0, joins: 0/0}
lvl28_rb6X8 :: SrcLoc
[GblId, Str=m, Unf=OtherCon []]
lvl28_rb6X8
  = GHC.Stack.Types.SrcLoc
      lvl16_rb6WW
      lvl17_rb6WX
      lvl19_rb6WZ
      lvl27_rb6X7
      lvl21_rb6X1
      lvl27_rb6X7
      lvl22_rb6X2

-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
lvl29_rb6X9 :: CallStack
[GblId, Str=m2, Unf=OtherCon []]
lvl29_rb6X9
  = GHC.Stack.Types.PushCallStack
      lvl15_rb6WV lvl28_rb6X8 GHC.Stack.Types.EmptyCallStack

-- RHS size: {terms: 4, types: 3, coercions: 4, joins: 0/0}
lvl30_rb6Xa :: IO Int
[GblId, Str=x]
lvl30_rb6Xa
  = error
      @ 'LiftedRep
      @ (IO Int)
      (lvl29_rb6X9
       `cast` (Sym (GHC.Classes.N:IP[0] <"callStack">_N <CallStack>_N)
               :: (CallStack :: *) ~R# (?callStack::CallStack :: Constraint)))
      (unpackCString# lvl25_rb6X5)

Rec {
-- RHS size: {terms: 186, types: 229, coercions: 26, joins: 2/3}
GHC.IO.Handle.Text.$wbufWrite [InlPrag=NOUSERINLINE[0],
                               Occ=LoopBreaker]
  :: Handle__
     -> Ptr Word8
     -> Int#
     -> Bool
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=5,
 Str=<S,1*U><L,1*U(U)><S,U><L,1*U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Text.$wbufWrite
  = \ (w_sb6bH :: Handle__)
      (w1_sb6bI :: Ptr Word8)
      (ww_sb6bO :: Int#)
      (w2_sb6bK :: Bool)
      (w3_sb6bL :: State# RealWorld) ->
      case w_sb6bH of wild_X1G
      { Handle__ @ dev_ab2BH @ enc_state_ab2BI @ dec_state_ab2BJ
                 $dIODevice_ab2BK $dBufferedIO_ab2BL $dTypeable_ab2BM ds_db39Z
                 ds1_db3a0 dt_db3sR ds2_db3a2 dt1_db3sS dt2_db3sT dt3_db3sU
                 ds3_db3a6 ds4_db3a7 ds5_db3a8 ds6_db3a9 ds7_db3aa ds8_db3ab ->
      case ds_db39Z
           `cast` (UnsafeCo representational dev_ab2BH FD
                   :: (dev_ab2BH :: *) ~R# (FD :: *))
      of ww1_sb6E3
      { FD ww2_sb6E4 ww3_sb6E5 ->
      case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3sR w3_sb6bL of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of wild1_XZ
      { Buffer dt4_db3sV dt5_db3sW ds10_db39u dt6_db3sX dt7_db3sY
               dt8_db3sZ ->
      let {
        v_X6 :: Int
        [LclId, Unf=OtherCon []]
        v_X6 = GHC.Types.I# ww_sb6bO } in
      join {
        $j_sb4ck [Dmd=<L,1*U(U,U)>] :: (# State# RealWorld, Int #)
        [LclId[JoinId(0)]]
        $j_sb4ck
          = join {
              $w$j_sb6bG [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
                :: State# RealWorld -> (# State# RealWorld, Int #)
              [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
              $w$j_sb6bG (w4_sb6bE [OS=OneShot] :: State# RealWorld)
                = case <# ww_sb6bO dt6_db3sX of {
                    __DEFAULT ->
                      case w2_sb6bK of {
                        False ->
                          case Data.Typeable.Internal.sameTypeRep
                                 @ *
                                 @ *
                                 @ dev_ab2BH
                                 @ FD
                                 ($dTypeable_ab2BM
                                  `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <dev_ab2BH>_N
                                          :: (Typeable dev_ab2BH :: Constraint)
                                             ~R# (Data.Typeable.Internal.TypeRep dev_ab2BH :: *)))
                                 lvl11_rb6WR
                          of {
                            False -> case lvl30_rb6Xa of wild4_00 { };
                            True ->
                              case w1_sb6bI of { GHC.Ptr.Ptr ww5_saWrl ->
                              GHC.IO.FD.$w$cwriteNonBlocking
                                ww2_sb6E4 ww3_sb6E5 ww5_saWrl ww_sb6bO w4_sb6bE
                              }
                          };
                        True ->
                          case Data.Typeable.Internal.sameTypeRep
                                 @ *
                                 @ *
                                 @ dev_ab2BH
                                 @ FD
                                 ($dTypeable_ab2BM
                                  `cast` (Data.Typeable.Internal.N:Typeable[0] <*>_N <dev_ab2BH>_N
                                          :: (Typeable dev_ab2BH :: Constraint)
                                             ~R# (Data.Typeable.Internal.TypeRep dev_ab2BH :: *)))
                                 lvl11_rb6WR
                          of {
                            False -> case lvl26_rb6X6 of wild4_00 { };
                            True ->
                              case w1_sb6bI of { GHC.Ptr.Ptr ww5_saWr3 ->
                              case GHC.IO.FD.$wfdWrite
                                     ww2_sb6E4 ww3_sb6E5 ww5_saWr3 ww_sb6bO w4_sb6bE
                              of
                              { (# ipv2_X7JlB, ipv3_X7JlD #) ->
                              (# ipv2_X7JlB, v_X6 #)
                              }
                              }
                          }
                      };
                    1# ->
                      GHC.IO.Handle.Text.$wbufWrite
                        wild_X1G w1_sb6bI ww_sb6bO w2_sb6bK w4_sb6bE
                  } } in
            case ># dt8_db3sZ 0# of {
              __DEFAULT -> jump $w$j_sb6bG ipv_i7IAy;
              1# ->
                case ((Buffered.flushWriteBuffer
                         @ dev_ab2BH
                         $dBufferedIO_ab2BL
                         (ww1_sb6E3
                          `cast` (UnsafeCo representational FD dev_ab2BH
                                  :: (FD :: *) ~R# (dev_ab2BH :: *)))
                         wild1_XZ)
                      `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                              :: (IO (Buffer Word8) :: *)
                                 ~R# (State# RealWorld
                                      -> (# State# RealWorld, Buffer Word8 #) :: *)))
                       ipv_i7IAy
                of
                { (# ipv2_X7IDf, ipv3_X7IDh #) ->
                case writeMutVar#
                       @ RealWorld @ (Buffer Word8) dt_db3sR ipv3_X7IDh ipv2_X7IDf
                of s2#_i7IBe
                { __DEFAULT ->
                jump $w$j_sb6bG s2#_i7IBe
                }
                }
            } } in
      case <# ww_sb6bO dt6_db3sX of {
        __DEFAULT -> jump $j_sb4ck;
        1# ->
          case <=# ww_sb6bO (-# dt6_db3sX dt8_db3sZ) of {
            __DEFAULT -> jump $j_sb4ck;
            1# ->
              case w1_sb6bI of { GHC.Ptr.Ptr ds12_db3rc ->
              case {__pkg_ccall base-4.11.0.0 Addr#
                           -> Addr#
                           -> Word#
                           -> State# RealWorld
                           -> (# State# RealWorld, Addr# #)}_db3ri
                     (plusAddr# dt4_db3sV dt8_db3sZ)
                     ds12_db3rc
                     (int2Word# ww_sb6bO)
                     ipv_i7IAy
              of
              { (# ds13_db3rg, ds14_db3rf #) ->
              case touch#
                     @ 'LiftedRep
                     @ GHC.ForeignPtr.ForeignPtrContents
                     dt5_db3sW
                     ds13_db3rg
              of s'_ib3va
              { __DEFAULT ->
              case ==# ww_sb6bO (-# dt6_db3sX dt8_db3sZ) of {
                __DEFAULT ->
                  case writeMutVar#
                         @ RealWorld
                         @ (Buffer Word8)
                         dt_db3sR
                         (GHC.IO.Buffer.Buffer
                            @ Word8
                            dt4_db3sV
                            dt5_db3sW
                            ds10_db39u
                            dt6_db3sX
                            dt7_db3sY
                            (+# dt8_db3sZ ww_sb6bO))
                         s'_ib3va
                  of s2#_i7IBe
                  { __DEFAULT ->
                  (# s2#_i7IBe, v_X6 #)
                  };
                1# ->
                  case ((Buffered.flushWriteBuffer
                           @ dev_ab2BH
                           $dBufferedIO_ab2BL
                           (ww1_sb6E3
                            `cast` (UnsafeCo representational FD dev_ab2BH
                                    :: (FD :: *) ~R# (dev_ab2BH :: *)))
                           (GHC.IO.Buffer.Buffer
                              @ Word8
                              dt4_db3sV
                              dt5_db3sW
                              ds10_db39u
                              dt6_db3sX
                              dt7_db3sY
                              (+# dt8_db3sZ ww_sb6bO)))
                        `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                :: (IO (Buffer Word8) :: *)
                                   ~R# (State# RealWorld
                                        -> (# State# RealWorld, Buffer Word8 #) :: *)))
                         s'_ib3va
                  of
                  { (# ipv2_X7IDz, ipv3_X7IDB #) ->
                  case writeMutVar#
                         @ RealWorld @ (Buffer Word8) dt_db3sR ipv3_X7IDB ipv2_X7IDz
                  of s2#_i7IBe
                  { __DEFAULT ->
                  (# s2#_i7IBe, v_X6 #)
                  }
                  }
              }
              }
              }
              }
          }
      }
      }
      }
      }
      }
end Rec }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutBuf4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hPutBuf4 = "hPutBuf"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutBuf3 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hPutBuf3
  = unpackCString# GHC.IO.Handle.Text.hPutBuf4

-- RHS size: {terms: 107, types: 200, coercions: 20, joins: 0/1}
GHC.IO.Handle.Text.$whPutBuf' [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a
     -> Int#
     -> Bool
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=5,
 Str=<L,U><L,U(U)><S,1*U><L,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [80 0 30 0 0] 438 30}]
GHC.IO.Handle.Text.$whPutBuf'
  = \ (@ a_sb6bT)
      (w_sb6bU :: Handle)
      (w1_sb6bV :: Ptr a_sb6bT)
      (ww_sb6c1 :: Int#)
      (w2_sb6bX :: Bool)
      (w3_sb6bY :: State# RealWorld) ->
      case ww_sb6c1 of wild_X4C {
        __DEFAULT ->
          case <# wild_X4C 0# of {
            __DEFAULT ->
              let {
                act_sb40l [Dmd=<L,C(C1(U(U,U)))>]
                  :: Handle__ -> State# RealWorld -> (# State# RealWorld, Int #)
                [LclId, Arity=2, Str=<S,1*U><S,U>, Unf=OtherCon []]
                act_sb40l
                  = \ (h__ab2f6 :: Handle__)
                      (eta_X6 [OS=OneShot] :: State# RealWorld) ->
                      case h__ab2f6 of wild1_XH
                      { Handle__ @ dev_ab2DI @ enc_state_ab2DJ @ dec_state_ab2DK
                                 $dIODevice_ab2DL $dBufferedIO_ab2DM $dTypeable_ab2DN ds_db3aP
                                 ds1_db3aQ dt_db3t5 ds2_db3aS dt1_db3t6 dt2_db3t7 dt3_db3t8
                                 ds3_db3aW ds4_db3aX ds5_db3aY ds6_db3aZ ds7_db3b0 ds8_db3b1 ->
                      case GHC.IO.Handle.Text.$wbufWrite
                             wild1_XH
                             (w1_sb6bV
                              `cast` ((Ptr Univ(phantom phantom <*>_N :: a_sb6bT, Word8))_R
                                      :: (Ptr a_sb6bT :: *) ~R# (Ptr Word8 :: *)))
                             wild_X4C
                             w2_sb6bX
                             eta_X6
                      of ds9_i7IAw
                      { (# ipv_i7IAy, ipv1_i7IAz #) ->
                      case ds2_db3aS of {
                        __DEFAULT ->
                          case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3t5 ipv_i7IAy of
                          { (# ipv2_X7IIN, ipv3_X7IIP #) ->
                          case ipv3_X7IIP of
                          { Buffer dt4_ia4xp dt5_ia4xq ds11_ia4xr dt6_ia4xs dt7_ia4xt
                                   dt8_ia4xu ->
                          case ds11_ia4xr of {
                            ReadBuffer -> (# ipv2_X7IIN, ipv1_i7IAz #);
                            WriteBuffer ->
                              case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3t5 ipv2_X7IIN
                              of
                              { (# ipv4_X7IFr, ipv5_X7IFt #) ->
                              case ipv5_X7IFt of wild5_ia4we
                              { Buffer dt9_ia4wr dt10_ia4ws ds13_ia4wz dt11_ia4wA dt12_ia4wB
                                       dt13_ia4wC ->
                              case ==# dt12_ia4wB dt13_ia4wC of {
                                __DEFAULT ->
                                  case ((Buffered.flushWriteBuffer
                                           @ dev_ab2DI $dBufferedIO_ab2DM ds_db3aP wild5_ia4we)
                                        `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                                :: (IO (Buffer Word8) :: *)
                                                   ~R# (State# RealWorld
                                                        -> (# State# RealWorld,
                                                              Buffer Word8 #) :: *)))
                                         ipv4_X7IFr
                                  of
                                  { (# ipv6_X7ICO, ipv7_X7ICQ #) ->
                                  case writeMutVar#
                                         @ RealWorld @ (Buffer Word8) dt_db3t5 ipv7_X7ICQ ipv6_X7ICO
                                  of s2#_i7IBe
                                  { __DEFAULT ->
                                  (# s2#_i7IBe, ipv1_i7IAz #)
                                  }
                                  };
                                1# -> (# ipv4_X7IFr, ipv1_i7IAz #)
                              }
                              }
                              }
                          }
                          }
                          };
                        BlockBuffering ds10_db3al -> ds9_i7IAw
                      }
                      }
                      } } in
              case w_sb6bU of wild1_X2B {
                FileHandle ds_da4QS dt_da4Wh ->
                  GHC.IO.Handle.Internals.$wwantWritableHandle'
                    @ Int
                    GHC.IO.Handle.Text.hPutBuf3
                    wild1_X2B
                    dt_da4Wh
                    (act_sb40l
                     `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                             :: (Handle__
                                 -> State# RealWorld -> (# State# RealWorld, Int #) :: *)
                                ~R# (Handle__ -> IO Int :: *)))
                    w3_sb6bY;
                DuplexHandle ds_da4QT dt_da4Wi dt1_da4Wj ->
                  GHC.IO.Handle.Internals.$wwantWritableHandle'
                    @ Int
                    GHC.IO.Handle.Text.hPutBuf3
                    wild1_X2B
                    dt1_da4Wj
                    (act_sb40l
                     `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                             :: (Handle__
                                 -> State# RealWorld -> (# State# RealWorld, Int #) :: *)
                                ~R# (Handle__ -> IO Int :: *)))
                    w3_sb6bY
              };
            1# ->
              GHC.IO.Handle.Text.$willegalBufferSize
                @ Int w_sb6bU GHC.IO.Handle.Text.hPutBuf3 wild_X4C w3_sb6bY
          };
        0# -> (# w3_sb6bY, GHC.IO.Handle.Text.hGetBuf3 #)
      }

-- RHS size: {terms: 15, types: 12, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutBuf2 [InlPrag=NOUSERINLINE[0]]
  :: forall a.
     Handle
     -> Ptr a
     -> Int
     -> Bool
     -> State# RealWorld
     -> (# State# RealWorld, Int #)
[GblId,
 Arity=5,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><L,U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_sb6bT)
                 (w_sb6bU [Occ=Once] :: Handle)
                 (w1_sb6bV [Occ=Once] :: Ptr a_sb6bT)
                 (w2_sb6bW [Occ=Once!] :: Int)
                 (w3_sb6bX [Occ=Once] :: Bool)
                 (w4_sb6bY [Occ=Once] :: State# RealWorld) ->
                 case w2_sb6bW of { I# ww1_sb6c1 [Occ=Once] ->
                 GHC.IO.Handle.Text.$whPutBuf'
                   @ a_sb6bT w_sb6bU w1_sb6bV ww1_sb6c1 w3_sb6bX w4_sb6bY
                 }}]
GHC.IO.Handle.Text.hPutBuf2
  = \ (@ a_sb6bT)
      (w_sb6bU :: Handle)
      (w1_sb6bV :: Ptr a_sb6bT)
      (w2_sb6bW :: Int)
      (w3_sb6bX :: Bool)
      (w4_sb6bY :: State# RealWorld) ->
      case w2_sb6bW of { I# ww1_sb6c1 ->
      GHC.IO.Handle.Text.$whPutBuf'
        @ a_sb6bT w_sb6bU w1_sb6bV ww1_sb6c1 w3_sb6bX w4_sb6bY
      }

-- RHS size: {terms: 14, types: 11, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutBufNonBlocking1
  :: forall a.
     Handle
     -> Ptr a -> Int -> State# RealWorld -> (# State# RealWorld, Int #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_ab2Eg)
                 (h_ab2eZ [Occ=Once] :: Handle)
                 (ptr_ab2f0 [Occ=Once] :: Ptr a_ab2Eg)
                 (count_ab2f1 [Occ=Once] :: Int) ->
                 GHC.IO.Handle.Text.hPutBuf2
                   @ a_ab2Eg h_ab2eZ ptr_ab2f0 count_ab2f1 GHC.Types.False}]
GHC.IO.Handle.Text.hPutBufNonBlocking1
  = \ (@ a_ab2Eg)
      (h_ab2eZ :: Handle)
      (ptr_ab2f0 :: Ptr a_ab2Eg)
      (count_ab2f1 :: Int)
      (w_sb6bY :: State# RealWorld) ->
      case count_ab2f1 of { I# ww1_sb6c1 ->
      GHC.IO.Handle.Text.$whPutBuf'
        @ a_ab2Eg h_ab2eZ ptr_ab2f0 ww1_sb6c1 GHC.Types.False w_sb6bY
      }

-- RHS size: {terms: 1, types: 0, coercions: 13, joins: 0/0}
hPutBufNonBlocking :: forall a. Handle -> Ptr a -> Int -> IO Int
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hPutBufNonBlocking1
               `cast` (forall (a :: <*>_N).
                       <Handle>_R
                       ->_R <Ptr a>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
                       :: (forall a.
                           Handle
                           -> Ptr a
                           -> Int
                           -> State# RealWorld
                           -> (# State# RealWorld, Int #) :: *)
                          ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))}]
hPutBufNonBlocking
  = GHC.IO.Handle.Text.hPutBufNonBlocking1
    `cast` (forall (a :: <*>_N).
            <Handle>_R
            ->_R <Ptr a>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <Int>_R)
            :: (forall a.
                Handle
                -> Ptr a
                -> Int
                -> State# RealWorld
                -> (# State# RealWorld, Int #) :: *)
               ~R# (forall a. Handle -> Ptr a -> Int -> IO Int :: *))

-- RHS size: {terms: 19, types: 29, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutBuf1
  :: forall a.
     Handle
     -> Ptr a -> Int -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=4,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@ a_ab2Ej)
                 (h_ab2eW [Occ=Once] :: Handle)
                 (ptr_ab2eX [Occ=Once] :: Ptr a_ab2Ej)
                 (count_ab2eY [Occ=Once] :: Int)
                 (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                 case GHC.IO.Handle.Text.hPutBuf2
                        @ a_ab2Ej h_ab2eW ptr_ab2eX count_ab2eY GHC.Types.True s_i7IAv
                 of
                 { (# ipv_i7IAy [Occ=Once], _ [Occ=Dead] #) ->
                 (# ipv_i7IAy, GHC.Tuple.() #)
                 }}]
GHC.IO.Handle.Text.hPutBuf1
  = \ (@ a_ab2Ej)
      (h_ab2eW :: Handle)
      (ptr_ab2eX :: Ptr a_ab2Ej)
      (count_ab2eY :: Int)
      (s_i7IAv :: State# RealWorld) ->
      case count_ab2eY of { I# ww1_sb6c1 ->
      case GHC.IO.Handle.Text.$whPutBuf'
             @ a_ab2Ej h_ab2eW ptr_ab2eX ww1_sb6c1 GHC.Types.True s_i7IAv
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      (# ipv_i7IAy, GHC.Tuple.() #)
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 13, joins: 0/0}
hPutBuf :: forall a. Handle -> Ptr a -> Int -> IO ()
[GblId,
 Arity=4,
 Str=<L,U><L,U(U)><S(S),1*U(1*U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hPutBuf1
               `cast` (forall (a :: <*>_N).
                       <Handle>_R
                       ->_R <Ptr a>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (forall a.
                           Handle
                           -> Ptr a
                           -> Int
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (forall a. Handle -> Ptr a -> Int -> IO () :: *))}]
hPutBuf
  = GHC.IO.Handle.Text.hPutBuf1
    `cast` (forall (a :: <*>_N).
            <Handle>_R
            ->_R <Ptr a>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (forall a.
                Handle
                -> Ptr a
                -> Int
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (forall a. Handle -> Ptr a -> Int -> IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl31_rb6Xb :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl31_rb6Xb = "\n"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl32_rb6Xc :: [Char]
[GblId]
lvl32_rb6Xc = unpackCString# lvl31_rb6Xb

-- RHS size: {terms: 290, types: 451, coercions: 18, joins: 3/5}
GHC.IO.Handle.Text.$wwriteBlocks [InlPrag=NOUSERINLINE[0]]
  :: Handle
     -> Bool
     -> Bool
     -> Newline
     -> Addr#
     -> GHC.ForeignPtr.ForeignPtrContents
     -> Int#
     -> String
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=9,
 Str=<S,U><L,U><L,1*U><L,U><L,U><L,U><L,U><S,1*U><S,U>,
 Unf=OtherCon []]
GHC.IO.Handle.Text.$wwriteBlocks
  = \ (w_sb6ck :: Handle)
      (w1_sb6cl :: Bool)
      (w2_sb6cm :: Bool)
      (w3_sb6cn :: Newline)
      (ww_sb6ct :: Addr#)
      (ww1_sb6cu :: GHC.ForeignPtr.ForeignPtrContents)
      (ww2_sb6cw :: Int#)
      (w4_sb6cp :: String)
      (w5_sb6cq :: State# RealWorld) ->
      join {
        exit_X2z [Dmd=<L,C(C1(U(U,U)))>]
          :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
        [LclId[JoinId(2)], Arity=2, Str=<L,U><S,U>]
        exit_X2z (ww3_sb6ch [OS=OneShot] :: Int#)
                 (w6_sb6ce [OS=OneShot] :: State# RealWorld)
          = let {
              raw_sb40j :: RawBuffer CharBufElem
              [LclId, Unf=OtherCon []]
              raw_sb40j
                = GHC.ForeignPtr.ForeignPtr @ CharBufElem ww_sb6ct ww1_sb6cu } in
            GHC.IO.Handle.Internals.wantWritableHandle1
              @ ()
              lvl2_rb6WE
              w_sb6ck
              ((\ (h__ab2ei :: Handle__)
                  (eta_Xc [OS=OneShot] :: State# RealWorld) ->
                  case h__ab2ei of wild_X1u
                  { Handle__ @ dev_ab2FM @ enc_state_ab2FN @ dec_state_ab2FO
                             $dIODevice_ab2FP $dBufferedIO_ab2FQ $dTypeable_ab2FR ds_db3d4
                             ds1_db3d5 dt_db3ti ds2_db3d7 dt1_db3tj dt2_db3tk dt3_db3tl
                             ds3_db3db ds4_db3dc ds5_db3dd ds6_db3de ds7_db3df ds8_db3dg ->
                  case GHC.IO.Handle.Internals.$wwriteCharBuffer
                         wild_X1u
                         ww_sb6ct
                         ww1_sb6cu
                         GHC.IO.Buffer.WriteBuffer
                         ww2_sb6cw
                         0#
                         ww3_sb6ch
                         eta_Xc
                  of
                  { (# ipv_X7JkH, ipv1_i7JiL #) ->
                  case readMutVar#
                         @ RealWorld @ (Buffer CharBufElem) dt2_db3tk ipv_X7JkH
                  of
                  { (# ipv2_i7IAy, ipv3_i7IAz #) ->
                  case ipv3_i7IAz of
                  { Buffer dt4_db3tm dt5_db3tn ds11_db3cz dt6_db3to dt7_db3tp
                           dt8_db3tq ->
                  case ==# ww2_sb6cw dt6_db3to of {
                    __DEFAULT -> (# ipv2_i7IAy, GHC.Tuple.() #);
                    1# ->
                      case readMutVar#
                             @ RealWorld @ (BufferList CharBufElem) dt3_db3tl ipv2_i7IAy
                      of
                      { (# ipv4_X7ID8, ipv5_X7IDa #) ->
                      case writeMutVar#
                             @ RealWorld
                             @ (BufferList CharBufElem)
                             dt3_db3tl
                             (GHC.IO.Handle.Types.BufferListCons
                                @ CharBufElem raw_sb40j ipv5_X7IDa)
                             ipv4_X7ID8
                      of s2#_i7IBe
                      { __DEFAULT ->
                      (# s2#_i7IBe, GHC.Tuple.() #)
                      }
                      }
                  }
                  }
                  }
                  }
                  })
               `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle__
                           -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle__ -> IO () :: *)))
              w6_sb6ce } in
      joinrec {
        $wshoveString_sb6cj [InlPrag=NOUSERINLINE[0], Occ=LoopBreaker]
          :: Int#
             -> [Char]
             -> [Char]
             -> State# RealWorld
             -> (# State# RealWorld, () #)
        [LclId[JoinId(4)],
         Arity=4,
         Str=<S,U><S,1*U><L,1*U><S,U>,
         Unf=OtherCon []]
        $wshoveString_sb6cj (ww3_sb6ch :: Int#)
                            (w6_sb6cc :: [Char])
                            (w7_sb6cd :: [Char])
                            (w8_sb6ce :: State# RealWorld)
          = case w6_sb6cc of wild_XW {
              [] ->
                case w7_sb6cd of wild1_XX {
                  [] -> jump exit_X2z ww3_sb6ch w8_sb6ce;
                  : ipv_sb3D6 ipv1_sb3D7 ->
                    jump $wshoveString_sb6cj
                      ww3_sb6ch wild1_XX (GHC.Types.[] @ Char) w8_sb6ce
                };
              : c_ab2e6 cs_ab2e7 ->
                case >=# (+# ww3_sb6ch 1#) ww2_sb6cw of {
                  __DEFAULT ->
                    case c_ab2e6 of { C# x_a5ih ->
                    case x_a5ih of wild2_X5o {
                      __DEFAULT ->
                        case writeWideCharOffAddr#
                               @ RealWorld ww_sb6ct ww3_sb6ch wild2_X5o w8_sb6ce
                        of s2_ib3dC
                        { __DEFAULT ->
                        case touch#
                               @ 'LiftedRep @ GHC.ForeignPtr.ForeignPtrContents ww1_sb6cu s2_ib3dC
                        of s'_ib3dD
                        { __DEFAULT ->
                        jump $wshoveString_sb6cj
                          (+# ww3_sb6ch 1#) cs_ab2e7 w7_sb6cd s'_ib3dD
                        }
                        };
                      '\n'# ->
                        join {
                          $w$j_sb6ca [InlPrag=NOUSERINLINE[0],
                                      Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
                            :: State# RealWorld -> Int# -> (# State# RealWorld, () #)
                          [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U>, Unf=OtherCon []]
                          $w$j_sb6ca (w9_sb6c4 [OS=OneShot] :: State# RealWorld)
                                     (ww4_sb6c8 [OS=OneShot] :: Int#)
                            = case w1_sb6cl of {
                                False ->
                                  jump $wshoveString_sb6cj ww4_sb6c8 cs_ab2e7 w7_sb6cd w9_sb6c4;
                                True ->
                                  case GHC.IO.Handle.Internals.wantWritableHandle1
                                         @ ()
                                         lvl2_rb6WE
                                         w_sb6ck
                                         ((\ (h__ab2ei :: Handle__)
                                             (eta_Xc [OS=OneShot] :: State# RealWorld) ->
                                             case h__ab2ei of wild4_X1u
                                             { Handle__ @ dev_ab2FM @ enc_state_ab2FN
                                                        @ dec_state_ab2FO $dIODevice_ab2FP
                                                        $dBufferedIO_ab2FQ $dTypeable_ab2FR ds_db3d4
                                                        ds1_db3d5 dt_db3ti ds2_db3d7 dt1_db3tj
                                                        dt2_db3tk dt3_db3tl ds3_db3db ds4_db3dc
                                                        ds5_db3dd ds6_db3de ds7_db3df ds8_db3dg ->
                                             case GHC.IO.Handle.Internals.$wwriteCharBuffer
                                                    wild4_X1u
                                                    ww_sb6ct
                                                    ww1_sb6cu
                                                    GHC.IO.Buffer.WriteBuffer
                                                    ww2_sb6cw
                                                    0#
                                                    ww4_sb6c8
                                                    eta_Xc
                                             of
                                             { (# ipv_X7JkH, ipv1_i7JiL #) ->
                                             case readMutVar#
                                                    @ RealWorld @ (Buffer Word8) dt_db3ti ipv_X7JkH
                                             of
                                             { (# ipv2_X7IGl, ipv3_X7IGn #) ->
                                             case ipv3_X7IGn of wild5_ia4we
                                             { Buffer dt4_ia4wr dt5_ia4ws ds11_ia4wz dt6_ia4wA
                                                      dt7_ia4wB dt8_ia4wC ->
                                             case ==# dt7_ia4wB dt8_ia4wC of {
                                               __DEFAULT ->
                                                 case ((Buffered.flushWriteBuffer
                                                          @ dev_ab2FM
                                                          $dBufferedIO_ab2FQ
                                                          ds_db3d4
                                                          wild5_ia4we)
                                                       `cast` (GHC.Types.N:IO[0] <Buffer Word8>_R
                                                               :: (IO (Buffer Word8) :: *)
                                                                  ~R# (State# RealWorld
                                                                       -> (# State# RealWorld,
                                                                             Buffer Word8 #) :: *)))
                                                        ipv2_X7IGl
                                                 of
                                                 { (# ipv4_X7ICO, ipv5_X7ICQ #) ->
                                                 case writeMutVar#
                                                        @ RealWorld
                                                        @ (Buffer Word8)
                                                        dt_db3ti
                                                        ipv5_X7ICQ
                                                        ipv4_X7ICO
                                                 of s2#_i7IBe
                                                 { __DEFAULT ->
                                                 (# s2#_i7IBe, GHC.Tuple.() #)
                                                 }
                                                 };
                                               1# -> (# ipv2_X7IGl, GHC.Tuple.() #)
                                             }
                                             }
                                             }
                                             }
                                             })
                                          `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                                  :: (Handle__
                                                      -> State# RealWorld
                                                      -> (# State# RealWorld, () #) :: *)
                                                     ~R# (Handle__ -> IO () :: *)))
                                         w9_sb6c4
                                  of
                                  { (# ipv_i7JiK, ipv1_i7JiL #) ->
                                  jump $wshoveString_sb6cj 0# cs_ab2e7 w7_sb6cd ipv_i7JiK
                                  }
                              } } in
                        case w3_sb6cn of {
                          LF ->
                            case writeWideCharOffAddr#
                                   @ RealWorld ww_sb6ct ww3_sb6ch '\n'# w8_sb6ce
                            of s2_ib3dC
                            { __DEFAULT ->
                            case touch#
                                   @ 'LiftedRep
                                   @ GHC.ForeignPtr.ForeignPtrContents
                                   ww1_sb6cu
                                   s2_ib3dC
                            of s'_ib3dD
                            { __DEFAULT ->
                            jump $w$j_sb6ca s'_ib3dD (+# ww3_sb6ch 1#)
                            }
                            };
                          CRLF ->
                            case writeWideCharOffAddr#
                                   @ RealWorld ww_sb6ct ww3_sb6ch '\r'# w8_sb6ce
                            of s2_ib3dC
                            { __DEFAULT ->
                            case touch#
                                   @ 'LiftedRep
                                   @ GHC.ForeignPtr.ForeignPtrContents
                                   ww1_sb6cu
                                   s2_ib3dC
                            of s'_ib3dD
                            { __DEFAULT ->
                            let {
                              ipv1_sb4cW [Dmd=<S,U>] :: Int#
                              [LclId]
                              ipv1_sb4cW = +# ww3_sb6ch 1# } in
                            case writeWideCharOffAddr#
                                   @ RealWorld ww_sb6ct ipv1_sb4cW '\n'# s'_ib3dD
                            of s1_Xb3m6
                            { __DEFAULT ->
                            case touch#
                                   @ 'LiftedRep
                                   @ GHC.ForeignPtr.ForeignPtrContents
                                   ww1_sb6cu
                                   s1_Xb3m6
                            of s'1_Xb3ma
                            { __DEFAULT ->
                            jump $w$j_sb6ca s'1_Xb3ma (+# ipv1_sb4cW 1#)
                            }
                            }
                            }
                            }
                        }
                    }
                    };
                  1# ->
                    case GHC.IO.Handle.Internals.wantWritableHandle1
                           @ ()
                           lvl2_rb6WE
                           w_sb6ck
                           ((\ (h__ab2ei :: Handle__)
                               (eta_Xc [OS=OneShot] :: State# RealWorld) ->
                               case h__ab2ei of wild1_X1u
                               { Handle__ @ dev_ab2FM @ enc_state_ab2FN @ dec_state_ab2FO
                                          $dIODevice_ab2FP $dBufferedIO_ab2FQ $dTypeable_ab2FR
                                          ds_db3d4 ds1_db3d5 dt_db3ti ds2_db3d7 dt1_db3tj dt2_db3tk
                                          dt3_db3tl ds3_db3db ds4_db3dc ds5_db3dd ds6_db3de
                                          ds7_db3df ds8_db3dg ->
                               case GHC.IO.Handle.Internals.$wwriteCharBuffer
                                      wild1_X1u
                                      ww_sb6ct
                                      ww1_sb6cu
                                      GHC.IO.Buffer.WriteBuffer
                                      ww2_sb6cw
                                      0#
                                      ww3_sb6ch
                                      eta_Xc
                               of
                               { (# ipv_X7JkH, ipv1_i7JiL #) ->
                               (# ipv_X7JkH, GHC.Tuple.() #)
                               }
                               })
                            `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                    :: (Handle__
                                        -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                                       ~R# (Handle__ -> IO () :: *)))
                           w8_sb6ce
                    of
                    { (# ipv_i7JiK, ipv1_i7JiL #) ->
                    jump $wshoveString_sb6cj 0# wild_XW w7_sb6cd ipv_i7JiK
                    }
                }
            }; } in
      jump $wshoveString_sb6cj
        0#
        w4_sb6cp
        (case w2_sb6cm of {
           False -> GHC.Types.[] @ Char;
           True -> lvl32_rb6Xc
         })
        w5_sb6cq

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl33_rb6Xd :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl33_rb6Xd = "no buffer!"#

-- RHS size: {terms: 3, types: 2, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutStr4 :: CharBuffer
[GblId, Str=x]
GHC.IO.Handle.Text.hPutStr4
  = errorWithoutStackTrace
      @ 'LiftedRep @ CharBuffer (unpackCString# lvl33_rb6Xd)

-- RHS size: {terms: 3, types: 2, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutStr3 :: (BufferMode, CharBuffer)
[GblId,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 30}]
GHC.IO.Handle.Text.hPutStr3
  = (GHC.IO.Handle.Types.NoBuffering, GHC.IO.Handle.Text.hPutStr4)

-- RHS size: {terms: 94, types: 206, coercions: 5, joins: 0/1}
GHC.IO.Handle.Text.hPutStr2
  :: Handle__
     -> State# RealWorld
     -> (# State# RealWorld, ((BufferMode, CharBuffer), Newline) #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [20 0] 215 90}]
GHC.IO.Handle.Text.hPutStr2
  = \ (h__ab2dC :: Handle__)
      (s_X7ICm [OS=OneShot] :: State# RealWorld) ->
      case h__ab2dC of
      { Handle__ @ dev_ab2HF @ enc_state_ab2HG @ dec_state_ab2HH
                 $dIODevice_ab2HI $dBufferedIO_ab2HJ $dTypeable_ab2HK ds_db3fA
                 ds1_db3fB dt_db3tw ds2_db3fD dt1_db3tx dt2_db3ty dt3_db3tz
                 ds3_db3fH ds4_db3fI ds5_db3fJ ds6_db3fK ds7_db3fL ds8_db3fM ->
      case ds2_db3fD of wild1_Xz {
        __DEFAULT ->
          case readMutVar#
                 @ RealWorld @ (BufferList CharBufElem) dt3_db3tz s_X7ICm
          of
          { (# ipv_i7IAy, ipv1_i7IAz #) ->
          case readMutVar#
                 @ RealWorld @ (Buffer CharBufElem) dt2_db3ty ipv_i7IAy
          of
          { (# ipv2_X7ID8, ipv3_X7IDa #) ->
          case ipv1_i7IAz of {
            BufferListNil ->
              case ipv3_X7IDa of
              { Buffer dt4_ib3ey dt5_ib3ez ds11_ib3eA dt6_ib3eB dt7_ib3eC
                       dt8_ib3eD ->
              let {
                x1_sb40d [Dmd=<S,U>] :: Int#
                [LclId]
                x1_sb40d = *# dt6_ib3eB 4# } in
              case <# x1_sb40d 0# of {
                __DEFAULT ->
                  case newMutVar#
                         @ GHC.ForeignPtr.Finalizers
                         @ RealWorld
                         GHC.ForeignPtr.NoFinalizers
                         ipv2_X7ID8
                  of
                  { (# ipv4_ia4Xw, ipv5_ia4Xx #) ->
                  case newPinnedByteArray# @ RealWorld x1_sb40d ipv4_ia4Xw of
                  { (# ipv6_ia4XB, ipv7_ia4XC #) ->
                  (# ipv6_ia4XB,
                     ((wild1_Xz,
                       GHC.IO.Buffer.Buffer
                         @ Char
                         (byteArrayContents#
                            (ipv7_ia4XC
                             `cast` (UnsafeCo representational (MutableByteArray#
                                                                  RealWorld) ByteArray#
                                     :: (MutableByteArray# RealWorld :: TYPE 'UnliftedRep)
                                        ~R# (ByteArray# :: TYPE 'UnliftedRep))))
                         (GHC.ForeignPtr.MallocPtr ipv7_ia4XC ipv5_ia4Xx)
                         GHC.IO.Buffer.WriteBuffer
                         dt6_ib3eB
                         0#
                         0#),
                      ds7_db3fL) #)
                  }
                  };
                1# -> case GHC.ForeignPtr.mallocForeignPtrBytes2 of wild4_00 { }
              }
              };
            BufferListCons b_ab2dQ rest_ab2dR ->
              case writeMutVar#
                     @ RealWorld
                     @ (BufferList CharBufElem)
                     dt3_db3tz
                     rest_ab2dR
                     ipv2_X7ID8
              of s2#_i7IBe
              { __DEFAULT ->
              (# s2#_i7IBe,
                 ((wild1_Xz,
                   case b_ab2dQ of { GHC.ForeignPtr.ForeignPtr dt5_ib3en dt6_ib3eo ->
                   case ipv3_X7IDa of
                   { Buffer dt7_ib3ey dt8_ib3ez ds11_ib3eA dt9_ib3eB dt10_ib3eC
                            dt11_ib3eD ->
                   GHC.IO.Buffer.Buffer
                     @ CharBufElem
                     dt5_ib3en
                     dt6_ib3eo
                     GHC.IO.Buffer.WriteBuffer
                     dt9_ib3eB
                     0#
                     0#
                   }
                   }),
                  ds7_db3fL) #)
              }
          }
          }
          };
        NoBuffering ->
          (# s_X7ICm, (GHC.IO.Handle.Text.hPutStr3, ds7_db3fL) #)
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutStr6 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 30 0}]
GHC.IO.Handle.Text.hPutStr6 = "hPutStr"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hPutStr5 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hPutStr5
  = unpackCString# GHC.IO.Handle.Text.hPutStr6

-- RHS size: {terms: 99, types: 149, coercions: 18, joins: 1/1}
GHC.IO.Handle.Text.hPutStr1
  :: Handle
     -> String -> Bool -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=4,
 Str=<S,U><L,1*U><L,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [118 0 30 0] 516 0}]
GHC.IO.Handle.Text.hPutStr1
  = \ (handle_ab2dz :: Handle)
      (str_ab2dA :: String)
      (add_nl_ab2dB :: Bool)
      (s_i7IAv :: State# RealWorld) ->
      join {
        $w$j_sb6cP [InlPrag=NOUSERINLINE[0],
                    Dmd=<L,1*C1(C1(C1(C1(U(U,U)))))>]
          :: State# RealWorld
             -> BufferMode
             -> CharBuffer
             -> Newline
             -> (# State# RealWorld, () #)
        [LclId[JoinId(4)],
         Arity=4,
         Str=<S,U><S,1*U><L,1*U(U,U,A,U,A,A)><L,U>,
         Unf=OtherCon []]
        $w$j_sb6cP (w_sb6cD [OS=OneShot] :: State# RealWorld)
                   (ww_sb6cK [OS=OneShot] :: BufferMode)
                   (ww1_sb6cL [OS=OneShot] :: CharBuffer)
                   (ww2_sb6cN [OS=OneShot] :: Newline)
          = case ww_sb6cK of {
              NoBuffering ->
                case GHC.IO.Handle.Text.hPutStr7 handle_ab2dz str_ab2dA w_sb6cD of
                { (# ipv_i7JiK, ipv1_i7JiL #) ->
                case add_nl_ab2dB of {
                  False -> (# ipv_i7JiK, GHC.Tuple.() #);
                  True -> GHC.IO.Handle.Text.$whPutChar handle_ab2dz '\n'# ipv_i7JiK
                }
                };
              LineBuffering ->
                case ww1_sb6cL of
                { Buffer ww4_sb6ct ww5_sb6cu ww6_sb6cv ww7_sb6cw ww8_sb6cx
                         ww9_sb6cy ->
                GHC.IO.Handle.Text.$wwriteBlocks
                  handle_ab2dz
                  GHC.Types.True
                  add_nl_ab2dB
                  ww2_sb6cN
                  ww4_sb6ct
                  ww5_sb6cu
                  ww7_sb6cw
                  str_ab2dA
                  w_sb6cD
                };
              BlockBuffering ds_db3hD ->
                case ww1_sb6cL of
                { Buffer ww4_sb6ct ww5_sb6cu ww6_sb6cv ww7_sb6cw ww8_sb6cx
                         ww9_sb6cy ->
                GHC.IO.Handle.Text.$wwriteBlocks
                  handle_ab2dz
                  GHC.Types.False
                  add_nl_ab2dB
                  ww2_sb6cN
                  ww4_sb6ct
                  ww5_sb6cu
                  ww7_sb6cw
                  str_ab2dA
                  w_sb6cD
                }
            } } in
      case handle_ab2dz of wild_X2B {
        FileHandle ds_da4QS dt_da4Wh ->
          case GHC.IO.Handle.Internals.$wwantWritableHandle'
                 @ ((BufferMode, CharBuffer), Newline)
                 GHC.IO.Handle.Text.hPutStr5
                 wild_X2B
                 dt_da4Wh
                 (GHC.IO.Handle.Text.hPutStr2
                  `cast` (<Handle__>_R
                          ->_R Sym (GHC.Types.N:IO[0]
                                        <((BufferMode, CharBuffer), Newline)>_R)
                          :: (Handle__
                              -> State# RealWorld
                              -> (# State# RealWorld,
                                    ((BufferMode, CharBuffer), Newline) #) :: *)
                             ~R# (Handle__ -> IO ((BufferMode, CharBuffer), Newline) :: *)))
                 s_i7IAv
          of
          { (# ipv_i7IAy, ipv1_i7IAz #) ->
          case ipv1_i7IAz of { (ww1_sb6cH, ww2_sb6cN) ->
          case ww1_sb6cH of { (ww4_sb6cK, ww5_sb6cL) ->
          jump $w$j_sb6cP ipv_i7IAy ww4_sb6cK ww5_sb6cL ww2_sb6cN
          }
          }
          };
        DuplexHandle ds_da4QT dt_da4Wi dt1_da4Wj ->
          case GHC.IO.Handle.Internals.$wwantWritableHandle'
                 @ ((BufferMode, CharBuffer), Newline)
                 GHC.IO.Handle.Text.hPutStr5
                 wild_X2B
                 dt1_da4Wj
                 (GHC.IO.Handle.Text.hPutStr2
                  `cast` (<Handle__>_R
                          ->_R Sym (GHC.Types.N:IO[0]
                                        <((BufferMode, CharBuffer), Newline)>_R)
                          :: (Handle__
                              -> State# RealWorld
                              -> (# State# RealWorld,
                                    ((BufferMode, CharBuffer), Newline) #) :: *)
                             ~R# (Handle__ -> IO ((BufferMode, CharBuffer), Newline) :: *)))
                 s_i7IAv
          of
          { (# ipv_i7IAy, ipv1_i7IAz #) ->
          case ipv1_i7IAz of { (ww1_sb6cH, ww2_sb6cN) ->
          case ww1_sb6cH of { (ww4_sb6cK, ww5_sb6cL) ->
          jump $w$j_sb6cP ipv_i7IAy ww4_sb6cK ww5_sb6cL ww2_sb6cN
          }
          }
          }
      }

-- RHS size: {terms: 1, types: 0, coercions: 9, joins: 0/0}
hPutStr' [InlPrag=NOINLINE] :: Handle -> String -> Bool -> IO ()
[GblId,
 Arity=4,
 Str=<S,U><L,1*U><L,1*U><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hPutStr1
               `cast` (<Handle>_R
                       ->_R <String>_R
                       ->_R <Bool>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Handle
                           -> String
                           -> Bool
                           -> State# RealWorld
                           -> (# State# RealWorld, () #) :: *)
                          ~R# (Handle -> String -> Bool -> IO () :: *))}]
hPutStr'
  = GHC.IO.Handle.Text.hPutStr1
    `cast` (<Handle>_R
            ->_R <String>_R
            ->_R <Bool>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Handle
                -> String
                -> Bool
                -> State# RealWorld
                -> (# State# RealWorld, () #) :: *)
               ~R# (Handle -> String -> Bool -> IO () :: *))

-- RHS size: {terms: 6, types: 2, coercions: 0, joins: 0/0}
hPutStr :: Handle -> String -> IO ()
[GblId,
 Arity=3,
 Str=<L,U><L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (handle_ab2dv [Occ=Once] :: Handle)
                 (str_ab2dw [Occ=Once] :: String) ->
                 hPutStr' handle_ab2dv str_ab2dw GHC.Types.False}]
hPutStr
  = \ (handle_ab2dv :: Handle) (str_ab2dw :: String) ->
      hPutStr' handle_ab2dv str_ab2dw GHC.Types.False

-- RHS size: {terms: 6, types: 2, coercions: 0, joins: 0/0}
hPutStrLn :: Handle -> String -> IO ()
[GblId,
 Arity=3,
 Str=<L,U><L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (handle_ab2dx [Occ=Once] :: Handle)
                 (str_ab2dy [Occ=Once] :: String) ->
                 hPutStr' handle_ab2dx str_ab2dy GHC.Types.True}]
hPutStrLn
  = \ (handle_ab2dx :: Handle) (str_ab2dy :: String) ->
      hPutStr' handle_ab2dx str_ab2dy GHC.Types.True

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hWaitForInput3 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 50 0}]
GHC.IO.Handle.Text.hWaitForInput3 = "hWaitForInput"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.IO.Handle.Text.hWaitForInput2 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.IO.Handle.Text.hWaitForInput2
  = unpackCString# GHC.IO.Handle.Text.hWaitForInput3

-- RHS size: {terms: 246, types: 427, coercions: 9, joins: 1/2}
GHC.IO.Handle.Text.hWaitForInput1
  :: Handle
     -> Int -> State# RealWorld -> (# State# RealWorld, Bool #)
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U)><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0 20 0] 640 0}]
GHC.IO.Handle.Text.hWaitForInput1
  = \ (h_ab2aa :: Handle)
      (msecs_ab2ab :: Int)
      (eta_B1 :: State# RealWorld) ->
      let {
        lvl34_sb450 :: Bool
        [LclId]
        lvl34_sb450
          = case msecs_ab2ab of { I# x_alN9 ->
            tagToEnum# @ Bool (<# x_alN9 0#)
            } } in
      GHC.IO.Handle.Internals.wantReadableHandle_1
        @ Bool
        GHC.IO.Handle.Text.hWaitForInput2
        h_ab2aa
        ((\ (handle__ab2ac :: Handle__)
            (eta1_X5 [OS=OneShot] :: State# RealWorld) ->
            case handle__ab2ac of wild_X1W
            { Handle__ @ dev_ab2UN @ enc_state_ab2UO @ dec_state_ab2UP
                       $dIODevice_ab2UQ $dBufferedIO_ab2UR $dTypeable_ab2US ds_db3qR
                       ds1_db3qS dt_db3uB ds2_db3qU dt1_db3uC dt2_db3uD dt3_db3uE
                       ds3_db3qY ds4_db3qZ ds5_db3r0 ds6_db3r1 ds7_db3r2 ds8_db3r3 ->
            case readMutVar#
                   @ RealWorld @ (Buffer CharBufElem) dt2_db3uD eta1_X5
            of
            { (# ipv_i7IAy, ipv1_i7IAz #) ->
            case ipv1_i7IAz of wild1_ia4we
            { Buffer dt4_ia4wr dt5_ia4ws ds10_ia4wz dt6_ia4wA dt7_ia4wB
                     dt8_ia4wC ->
            case ==# dt7_ia4wB dt8_ia4wC of {
              __DEFAULT -> (# ipv_i7IAy, GHC.Types.True #);
              1# ->
                case lvl34_sb450 of {
                  False ->
                    case readMutVar# @ RealWorld @ (Buffer Word8) dt_db3uB ipv_i7IAy of
                    { (# ipv2_X7IJj, ipv3_X7IJl #) ->
                    join {
                      $w$j_sb6d5 [InlPrag=NOUSERINLINE[0],
                                  Dmd=<L,1*C1(C1(C1(C1(C1(C1(C1(U(U,U))))))))>]
                        :: State# RealWorld
                           -> Addr#
                           -> GHC.ForeignPtr.ForeignPtrContents
                           -> BufferState
                           -> Int#
                           -> Int#
                           -> Int#
                           -> (# State# RealWorld, Bool #)
                      [LclId[JoinId(7)],
                       Arity=7,
                       Str=<S,U><L,U><L,U><L,U><L,U><S,U><S,U>,
                       Unf=OtherCon []]
                      $w$j_sb6d5 (w_sb6cU [OS=OneShot] :: State# RealWorld)
                                 (ww_sb6cY [OS=OneShot] :: Addr#)
                                 (ww1_sb6cZ [OS=OneShot] :: GHC.ForeignPtr.ForeignPtrContents)
                                 (ww2_sb6d0 [OS=OneShot] :: BufferState)
                                 (ww3_sb6d1 [OS=OneShot] :: Int#)
                                 (ww4_sb6d2 [OS=OneShot] :: Int#)
                                 (ww5_sb6d3 [OS=OneShot] :: Int#)
                        = case writeMutVar#
                                 @ RealWorld
                                 @ (Buffer CharBufElem)
                                 dt2_db3uD
                                 (GHC.IO.Buffer.Buffer
                                    @ Char
                                    ww_sb6cY
                                    ww1_sb6cZ
                                    ww2_sb6d0
                                    ww3_sb6d1
                                    ww4_sb6d2
                                    ww5_sb6d3)
                                 w_sb6cU
                          of s2#_i7IBe
                          { __DEFAULT ->
                          case ==# ww4_sb6d2 ww5_sb6d3 of {
                            __DEFAULT -> (# s2#_i7IBe, GHC.Types.True #);
                            1# ->
                              case ((RawIO.ready
                                       @ dev_ab2UN
                                       $dIODevice_ab2UQ
                                       ds_db3qR
                                       GHC.Types.False
                                       msecs_ab2ab)
                                    `cast` (GHC.Types.N:IO[0] <Bool>_R
                                            :: (IO Bool :: *)
                                               ~R# (State# RealWorld
                                                    -> (# State# RealWorld, Bool #) :: *)))
                                     s2#_i7IBe
                              of
                              { (# ipv4_X7IDs, ipv5_X7IDu #) ->
                              case ipv5_X7IDu of {
                                False -> (# ipv4_X7IDs, GHC.Types.False #);
                                True ->
                                  case readMutVar#
                                         @ RealWorld @ (Buffer CharBufElem) dt2_db3uD ipv4_X7IDs
                                  of
                                  { (# ipv6_X7IDS, ipv7_X7IDU #) ->
                                  case ipv7_X7IDU of wild4_Xa4FC
                                  { Buffer dt9_Xa4FR dt10_Xa4FT ds14_Xa4G1 dt11_Xa4G3 dt12_Xa4G5
                                           dt13_Xa4G7 ->
                                  case ==# dt12_Xa4G5 dt13_Xa4G7 of {
                                    __DEFAULT ->
                                      case writeMutVar#
                                             @ RealWorld
                                             @ (Buffer CharBufElem)
                                             dt2_db3uD
                                             wild4_Xa4FC
                                             ipv6_X7IDS
                                      of s2#1_X7IKQ
                                      { __DEFAULT ->
                                      case readWideCharOffAddr#
                                             @ RealWorld dt9_Xa4FR dt12_Xa4G5 s2#1_X7IKQ
                                      of
                                      { (# ipv8_ia54K, ipv9_ia54L #) ->
                                      case touch#
                                             @ 'LiftedRep
                                             @ GHC.ForeignPtr.ForeignPtrContents
                                             dt10_Xa4FT
                                             ipv8_ia54K
                                      of s'_ia54N
                                      { __DEFAULT ->
                                      (# s'_ia54N, GHC.Types.True #)
                                      }
                                      }
                                      };
                                    1# ->
                                      case GHC.IO.Handle.Internals.hLookAhead_2
                                             wild_X1W wild4_Xa4FC ipv6_X7IDS
                                      of
                                      { (# ipv8_X7ID0, ipv9_X7ID2 #) ->
                                      case writeMutVar#
                                             @ RealWorld
                                             @ (Buffer CharBufElem)
                                             dt2_db3uD
                                             ipv9_X7ID2
                                             ipv8_X7ID0
                                      of s2#1_X7IKV
                                      { __DEFAULT ->
                                      case readWideCharOffAddr#
                                             @ RealWorld dt9_Xa4FR dt12_Xa4G5 s2#1_X7IKV
                                      of
                                      { (# ipv10_ia54K, ipv11_ia54L #) ->
                                      case touch#
                                             @ 'LiftedRep
                                             @ GHC.ForeignPtr.ForeignPtrContents
                                             dt10_Xa4FT
                                             ipv10_ia54K
                                      of s'_ia54N
                                      { __DEFAULT ->
                                      (# s'_ia54N, GHC.Types.True #)
                                      }
                                      }
                                      }
                                      }
                                  }
                                  }
                                  }
                              }
                              }
                          }
                          } } in
                    case ds4_db3qZ of {
                      Nothing ->
                        case writeMutVar#
                               @ RealWorld
                               @ (dec_state_ab2UP, Buffer Word8)
                               dt1_db3uC
                               (GHC.IO.Handle.Internals.decodeByteBuf2 @ dec_state_ab2UP,
                                ipv3_X7IJl)
                               ipv2_X7IJj
                        of s2#_i7IBe
                        { __DEFAULT ->
                        case GHC.IO.Encoding.Latin1.latin5 ipv3_X7IJl wild1_ia4we s2#_i7IBe
                        of
                        { (# ipv4_ia4Z6, ipv5_ia4Z7 #) ->
                        case ipv5_ia4Z7 of { (_why_ia4Zb, input'_ia4Zc, output'_ia4Zd) ->
                        case writeMutVar#
                               @ RealWorld @ (Buffer Word8) dt_db3uB input'_ia4Zc ipv4_ia4Z6
                        of s2#1_X7IEx
                        { __DEFAULT ->
                        case output'_ia4Zd of
                        { Buffer ww1_sb6cY ww2_sb6cZ ww3_sb6d0 ww4_sb6d1 ww5_sb6d2
                                 ww6_sb6d3 ->
                        jump $w$j_sb6d5
                          s2#1_X7IEx
                          ww1_sb6cY
                          ww2_sb6cZ
                          ww3_sb6d0
                          ww4_sb6d1
                          ww5_sb6d2
                          ww6_sb6d3
                        }
                        }
                        }
                        }
                        };
                      Just decoder_aa3Nq ->
                        case decoder_aa3Nq of
                        { BufferCodec ds12_ia4Aw ds13_ia4Ax ds14_ia4Ay ds15_ia4Az
                                      ds16_ia4AA ->
                        case (ds15_ia4Az
                              `cast` (GHC.Types.N:IO[0] <dec_state_ab2UP>_R
                                      :: (IO dec_state_ab2UP :: *)
                                         ~R# (State# RealWorld
                                              -> (# State# RealWorld, dec_state_ab2UP #) :: *)))
                               ipv2_X7IJj
                        of
                        { (# ipv4_X7ICV, ipv5_X7ICX #) ->
                        case writeMutVar#
                               @ RealWorld
                               @ (dec_state_ab2UP, Buffer Word8)
                               dt1_db3uC
                               (ipv5_X7ICX, ipv3_X7IJl)
                               ipv4_X7ICV
                        of s2#_i7IBe
                        { __DEFAULT ->
                        case GHC.IO.Handle.Internals.$wstreamEncode
                               @ Word8
                               @ CharBufElem
                               @ dec_state_ab2UP
                               ds12_ia4Aw
                               ds13_ia4Ax
                               ipv3_X7IJl
                               wild1_ia4we
                               s2#_i7IBe
                        of
                        { (# ipv6_X7IHV, ipv7_X7IHY #) ->
                        case ipv7_X7IHY of { (bbuf2_aa3Ns, cbuf'_aa3Nt) ->
                        case writeMutVar#
                               @ RealWorld @ (Buffer Word8) dt_db3uB bbuf2_aa3Ns ipv6_X7IHV
                        of s2#1_X7IEJ
                        { __DEFAULT ->
                        case cbuf'_aa3Nt of
                        { Buffer ww1_sb6cY ww2_sb6cZ ww3_sb6d0 ww4_sb6d1 ww5_sb6d2
                                 ww6_sb6d3 ->
                        jump $w$j_sb6d5
                          s2#1_X7IEJ
                          ww1_sb6cY
                          ww2_sb6cZ
                          ww3_sb6d0
                          ww4_sb6d1
                          ww5_sb6d2
                          ww6_sb6d3
                        }
                        }
                        }
                        }
                        }
                        }
                        }
                    }
                    };
                  True ->
                    case GHC.IO.Handle.Internals.hLookAhead_2
                           wild_X1W wild1_ia4we ipv_i7IAy
                    of
                    { (# ipv2_X7IDb, ipv3_X7IDd #) ->
                    case writeMutVar#
                           @ RealWorld @ (Buffer CharBufElem) dt2_db3uD ipv3_X7IDd ipv2_X7IDb
                    of s2#_i7IBe
                    { __DEFAULT ->
                    (# s2#_i7IBe, GHC.Types.True #)
                    }
                    }
                }
            }
            }
            }
            })
         `cast` (<Handle__>_R ->_R Sym (GHC.Types.N:IO[0] <Bool>_R)
                 :: (Handle__
                     -> State# RealWorld -> (# State# RealWorld, Bool #) :: *)
                    ~R# (Handle__ -> IO Bool :: *)))
        eta_B1

-- RHS size: {terms: 1, types: 0, coercions: 7, joins: 0/0}
hWaitForInput :: Handle -> Int -> IO Bool
[GblId,
 Arity=3,
 Str=<S,1*U><L,U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.IO.Handle.Text.hWaitForInput1
               `cast` (<Handle>_R
                       ->_R <Int>_R
                       ->_R Sym (GHC.Types.N:IO[0] <Bool>_R)
                       :: (Handle
                           -> Int -> State# RealWorld -> (# State# RealWorld, Bool #) :: *)
                          ~R# (Handle -> Int -> IO Bool :: *))}]
hWaitForInput
  = GHC.IO.Handle.Text.hWaitForInput1
    `cast` (<Handle>_R
            ->_R <Int>_R
            ->_R Sym (GHC.Types.N:IO[0] <Bool>_R)
            :: (Handle
                -> Int -> State# RealWorld -> (# State# RealWorld, Bool #) :: *)
               ~R# (Handle -> Int -> IO Bool :: *))


