
==================== Tidy Core ====================
2018-03-16 16:05:42.932824085 UTC

Result size of Tidy Core
  = {terms: 4,067, types: 7,236, coercions: 616, joins: 25/70}

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl1_raLJo :: Int
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl1_raLJo = GHC.Types.I# 0#

-- RHS size: {terms: 14, types: 32, coercions: 3, joins: 0/0}
lvl2_raLJp :: State# RealWorld -> (# State# RealWorld, IORef Int #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl2_raLJp
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMutVar# @ Int @ RealWorld lvl1_raLJo s'_i91ZE of
      { (# ipv_ia4ZV, ipv1_ia4ZW #) ->
      (# ipv_ia4ZV,
         (GHC.STRef.STRef @ RealWorld @ Int ipv1_ia4ZW)
         `cast` (Sym (GHC.IORef.N:IORef[0]) <Int>_N
                 :: (GHC.STRef.STRef RealWorld Int :: *) ~R# (IORef Int :: *)) #)
      }
      }

-- RHS size: {terms: 5, types: 33, coercions: 0, joins: 0/0}
numEnabledEventManagers [InlPrag=NOINLINE] :: IORef Int
[GblId]
numEnabledEventManagers
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, IORef Int #)
           lvl2_raLJp
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.$trModule4 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.Event.Thread.$trModule4 = "base"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.$trModule3 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.Event.Thread.$trModule3
  = GHC.Types.TrNameS GHC.Event.Thread.$trModule4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.$trModule2 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 50 0}]
GHC.Event.Thread.$trModule2 = "GHC.Event.Thread"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.$trModule1 :: TrName
[GblId,
 Caf=NoCafRefs,
 Str=m1,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]
GHC.Event.Thread.$trModule1
  = GHC.Types.TrNameS GHC.Event.Thread.$trModule2

-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.$trModule :: Module
[GblId,
 Caf=NoCafRefs,
 Str=m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 30}]
GHC.Event.Thread.$trModule
  = GHC.Types.Module
      GHC.Event.Thread.$trModule3 GHC.Event.Thread.$trModule1

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.blockedOnBadFD3 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 40 0}]
GHC.Event.Thread.blockedOnBadFD3 = "awaitEvent"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.blockedOnBadFD2 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.Event.Thread.blockedOnBadFD2
  = unpackCString# GHC.Event.Thread.blockedOnBadFD3

-- RHS size: {terms: 5, types: 2, coercions: 0, joins: 0/0}
GHC.Event.Thread.blockedOnBadFD1 :: GHC.IO.Exception.IOError
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 50 0}]
GHC.Event.Thread.blockedOnBadFD1
  = Foreign.C.Error.$werrnoToIOError
      GHC.Event.Thread.blockedOnBadFD2
      9#
      (GHC.Base.Nothing @ GHC.IO.Handle.Types.Handle)
      (GHC.Base.Nothing @ String)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
blockedOnBadFD :: SomeException
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=False,
         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 20 0}]
blockedOnBadFD
  = GHC.IO.Exception.$fExceptionIOException_$ctoException
      GHC.Event.Thread.blockedOnBadFD1

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning7 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 60 0}]
GHC.Event.Thread.ensureIOManagerIsRunning7 = "IOManager on cap "#

-- RHS size: {terms: 116, types: 186, coercions: 9, joins: 1/1}
restartPollLoop_raLJq
  :: EventManager
     -> Int -> State# RealWorld -> (# State# RealWorld, ThreadId #)
[GblId,
 Arity=3,
 Str=<S(SSSLLSLLLLSLL),1*U(U,U(U),U(U),A,U,U,A,U,U,U,U,U,U)><L,1*U(U)><S,U>,
 Unf=OtherCon []]
restartPollLoop_raLJq
  = \ (mgr_aaHXk :: EventManager)
      (i_aaHXl :: Int)
      (s_i7JiH :: State# RealWorld) ->
      case mgr_aaHXk of wild_X3y
      { GHC.Event.Manager.EventManager ds1_dawNW dt_dawX2 dt1_dawX3
                                       dt2_dawX4 dt3_dawX5 dt4_dawX6 dt5_dawX7 dt6_dawX8 dt7_dawX9
                                       dt8_dawXa dt9_dawXb dt10_dawXc dt11_dawXd ->
      case atomicModifyMutVar#
             @ RealWorld
             @ GHC.Event.Manager.State
             @ (GHC.Event.Manager.State, GHC.Event.Manager.State)
             @ GHC.Event.Manager.State
             dt4_dawX6
             GHC.Event.Manager.release2
             s_i7JiH
      of
      { (# ipv_iarpn, ipv1_iarpo #) ->
      join {
        $w$j_saKMD [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, ThreadId #)
        [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
        $w$j_saKMD (w_saKMB [OS=OneShot] :: State# RealWorld)
          = case i_aaHXl of { I# cpu_iaImS ->
            case forkOn#
                   @ (IO ())
                   cpu_iaImS
                   ((\ (eta1_iaImU :: State# RealWorld) ->
                       catch#
                         @ ()
                         @ SomeException
                         (GHC.Event.Manager.loop1 wild_X3y)
                         GHC.Conc.Sync.forkIO2
                         eta1_iaImU)
                    `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                            :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                               ~R# (IO () :: *)))
                   w_saKMB
            of
            { (# ipv2_iaImX, ipv3_iaImY #) ->
            case GHC.Foreign.charIsRepresentable3
                   @ ()
                   GHC.IO.Encoding.UTF8.utf8
                   (unpackAppendCString#
                      GHC.Event.Thread.ensureIOManagerIsRunning7
                      (case GHC.Show.$wshowSignedInt 0# cpu_iaImS (GHC.Types.[] @ Char)
                       of
                       { (# ww5_i7NVe, ww6_i7NVf #) ->
                       GHC.Types.: @ Char ww5_i7NVe ww6_i7NVf
                       }))
                   ((\ (ds5_iaIng :: Ptr Foreign.C.Types.CChar)
                       (eta1_iaInh [OS=OneShot] :: State# RealWorld) ->
                       case ds5_iaIng of { GHC.Ptr.Ptr p_iaInk ->
                       case labelThread# ipv3_iaImY p_iaInk eta1_iaInh of s1_iaInm
                       { __DEFAULT ->
                       (# s1_iaInm, GHC.Tuple.() #)
                       }
                       })
                    `cast` (<Ptr Foreign.C.Types.CChar>_R
                            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                            :: (Ptr Foreign.C.Types.CChar
                                -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                               ~R# (Ptr Foreign.C.Types.CChar -> IO () :: *)))
                   ipv2_iaImX
            of
            { (# ipv4_X7Jk4, ipv5_X7Jk6 #) ->
            (# ipv4_X7Jk4, GHC.Conc.Sync.ThreadId ipv3_iaImY #)
            }
            }
            } } in
      case ipv1_iarpo of {
        __DEFAULT -> jump $w$j_saKMD ipv_iarpn;
        GHC.Event.Manager.Running ->
          case {__pkg_ccall base-4.11.0.0 Int#
                           -> Word# -> State# RealWorld -> (# State# RealWorld, Int# #)}_dao99
                 (narrow32Int# dt8_dawXa) 1## ipv_iarpn
          of
          { (# ds_dao97, ds4_dao96 #) ->
          case narrow32Int# ds4_dao96 of {
            __DEFAULT ->
              case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Int# #)}_iaobJ
                     ds_dao97
              of
              { (# ds5_iaobM, ds3_iaobN #) ->
              case readMutVar# @ RealWorld @ Bool dt10_dawXc ds5_iaobM of
              { (# ipv2_X7ICP, ipv3_X7ICR #) ->
              case ipv3_X7ICR of {
                False ->
                  case Foreign.C.Error.throwErrno1
                         @ () GHC.Event.Control.sendWakeup2 ipv2_X7ICP
                  of
                  { (# ipv4_i7JiK, ipv5_i7JiL #) ->
                  jump $w$j_saKMD ipv4_i7JiK
                  };
                True ->
                  case narrow32Int# ds3_iaobN of {
                    __DEFAULT ->
                      case Foreign.C.Error.throwErrno1
                             @ () GHC.Event.Control.sendWakeup2 ipv2_X7ICP
                      of
                      { (# ipv4_i7JiK, ipv5_i7JiL #) ->
                      jump $w$j_saKMD ipv4_i7JiK
                      };
                    9# -> jump $w$j_saKMD ipv2_X7ICP
                  }
              }
              }
              };
            0# -> jump $w$j_saKMD ds_dao97
          }
          }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl3_raLJr :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl3_raLJr = "Int"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl4_raLJs :: [Char]
[GblId]
lvl4_raLJs = unpackCString# lvl3_raLJr

-- RHS size: {terms: 12, types: 5, coercions: 0, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning8
  :: Int# -> Int# -> Int# -> Int
[GblId, Arity=3, Str=<B,U><B,U><B,U>x, Unf=OtherCon []]
GHC.Event.Thread.ensureIOManagerIsRunning8
  = \ (ww_saKNj :: Int#) (ww1_saKNe :: Int#) (ww2_saKNq :: Int#) ->
      GHC.Arr.$windexError
        @ Int
        @ Int
        GHC.Show.$fShowInt
        (GHC.Types.I# ww1_saKNe)
        (GHC.Types.I# ww_saKNj)
        (GHC.Types.I# ww2_saKNq)
        lvl4_raLJs

-- RHS size: {terms: 159, types: 239, coercions: 9, joins: 1/1}
GHC.Event.Thread.$wstartIOManagerThread [InlPrag=NOUSERINLINE[0]]
  :: Int#
     -> Int#
     -> MutableArray# RealWorld (Maybe (ThreadId, EventManager))
     -> Int#
     -> State# RealWorld
     -> (# State# RealWorld, () #)
[GblId,
 Arity=5,
 Str=<S,U><S,U><S,U><S,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [0 0 0 0 0] 611 30}]
GHC.Event.Thread.$wstartIOManagerThread
  = \ (ww_saKNe :: Int#)
      (ww1_saKNj :: Int#)
      (ww2_saKNm
         :: MutableArray# RealWorld (Maybe (ThreadId, EventManager)))
      (ww3_saKNq :: Int#)
      (w_saKN8 :: State# RealWorld) ->
      case <=# ww_saKNe ww3_saKNq of {
        __DEFAULT ->
          case GHC.Event.Thread.ensureIOManagerIsRunning8
                 ww1_saKNj ww_saKNe ww3_saKNq
          of wild_00 {
          };
        1# ->
          case <=# ww3_saKNq ww1_saKNj of {
            __DEFAULT ->
              case GHC.Event.Thread.ensureIOManagerIsRunning8
                     ww1_saKNj ww_saKNe ww3_saKNq
              of wild_00 {
              };
            1# ->
              case readArray#
                     @ RealWorld
                     @ (Maybe (ThreadId, EventManager))
                     ww2_saKNm
                     (-# ww3_saKNq ww_saKNe)
                     w_saKN8
              of
              { (# ipv_i7IAy, ipv1_i7IAz #) ->
              join {
                create_saIYD [Dmd=<L,1*C1(U(U,U))>]
                  :: State# RealWorld -> (# State# RealWorld, () #)
                [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
                create_saIYD (s_i7IAv [OS=OneShot] :: State# RealWorld)
                  = case GHC.Event.EPoll.new1 s_i7IAv of
                    { (# ipv2_X7ICN, ipv3_X7ICP #) ->
                    case GHC.Event.Manager.new2 ipv3_X7ICP ipv2_X7ICN of
                    { (# ipv4_X7IDI, ipv5_X7IDK #) ->
                    case ipv5_X7IDK of mgr_XaHXK
                    { GHC.Event.Manager.EventManager ipv6_saIq7 ipv7_saIq8 ipv8_saIq9
                                                     ipv9_saIqa ipv10_saIqb ipv11_saIqc ipv12_saIqd
                                                     ipv13_saIqe ipv14_saIqf ipv15_saIqg ipv16_saIqh
                                                     ipv17_saIqi ipv18_saIqj ->
                    case forkOn#
                           @ (IO ())
                           ww3_saKNq
                           ((\ (eta1_iaImU :: State# RealWorld) ->
                               catch#
                                 @ ()
                                 @ SomeException
                                 (\ (s1_i7JiH [OS=OneShot] :: State# RealWorld) ->
                                    case {__pkg_ccall base-4.11.0.0 Word#
                           -> Int# -> State# RealWorld -> (# State# RealWorld #)}_daIlv
                                           (narrow32Word# (int2Word# ww3_saKNq))
                                           (narrow32Int# ipv14_saIqf)
                                           s1_i7JiH
                                    of
                                    { (# ds_daIlt #) ->
                                    GHC.Event.Manager.loop1 mgr_XaHXK ds_daIlt
                                    })
                                 GHC.Conc.Sync.forkIO2
                                 eta1_iaImU)
                            `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                                    :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                                       ~R# (IO () :: *)))
                           ipv4_X7IDI
                    of
                    { (# ipv19_iaImX, ipv20_iaImY #) ->
                    case GHC.Foreign.charIsRepresentable3
                           @ ()
                           GHC.IO.Encoding.UTF8.utf8
                           (unpackAppendCString#
                              GHC.Event.Thread.ensureIOManagerIsRunning7
                              (case GHC.Show.$wshowSignedInt 0# ww3_saKNq (GHC.Types.[] @ Char)
                               of
                               { (# ww5_i7NVe, ww6_i7NVf #) ->
                               GHC.Types.: @ Char ww5_i7NVe ww6_i7NVf
                               }))
                           ((\ (ds5_iaIng :: Ptr Foreign.C.Types.CChar)
                               (eta1_iaInh [OS=OneShot] :: State# RealWorld) ->
                               case ds5_iaIng of { GHC.Ptr.Ptr p_iaInk ->
                               case labelThread# ipv20_iaImY p_iaInk eta1_iaInh of s1_iaInm
                               { __DEFAULT ->
                               (# s1_iaInm, GHC.Tuple.() #)
                               }
                               })
                            `cast` (<Ptr Foreign.C.Types.CChar>_R
                                    ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                    :: (Ptr Foreign.C.Types.CChar
                                        -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                                       ~R# (Ptr Foreign.C.Types.CChar -> IO () :: *)))
                           ipv19_iaImX
                    of
                    { (# ipv21_i7JiK, ipv22_i7JiL #) ->
                    case writeArray#
                           @ RealWorld
                           @ (Maybe (ThreadId, EventManager))
                           ww2_saKNm
                           (-# ww3_saKNq ww_saKNe)
                           (GHC.Base.Just
                              @ (ThreadId, EventManager)
                              (GHC.Conc.Sync.ThreadId ipv20_iaImY, mgr_XaHXK))
                           ipv21_i7JiK
                    of s2#_i80pX
                    { __DEFAULT ->
                    (# s2#_i80pX, GHC.Tuple.() #)
                    }
                    }
                    }
                    }
                    }
                    } } in
              case ipv1_i7IAz of {
                Nothing -> jump create_saIYD ipv_i7IAy;
                Just ds_daIg9 ->
                  case ds_daIg9 of { (t_aaHXt, em_aaHXu) ->
                  case t_aaHXt of { GHC.Conc.Sync.ThreadId ww5_iaIra ->
                  case threadStatus# ww5_iaIra ipv_i7IAy of
                  { (# ipv2_iaJMz, ipv3_iaJMA, ipv4_iaJMB, ipv5_iaJMC #) ->
                  case ipv3_iaJMA of {
                    __DEFAULT -> (# ipv2_iaJMz, GHC.Tuple.() #);
                    16# -> jump create_saIYD ipv2_iaJMz;
                    17# ->
                      case {__pkg_ccall base-4.11.0.0 Word#
                           -> Int# -> State# RealWorld -> (# State# RealWorld #)}_daIlv
                             (narrow32Word# (int2Word# ww3_saKNq)) -1# ipv2_iaJMz
                      of
                      { (# ds3_daIlt #) ->
                      case GHC.Event.Manager.cleanup1 em_aaHXu ds3_daIlt of
                      { (# ipv6_X7Jku, ipv7_X7Jkw #) ->
                      jump create_saIYD ipv6_X7Jku
                      }
                      }
                  }
                  }
                  }
                  }
              }
              }
          }
      }

-- RHS size: {terms: 83, types: 163, coercions: 42, joins: 0/1}
lvl5_raLJt
  :: State# RealWorld
     -> (# State# RealWorld, MVar (Maybe ThreadId) #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl5_raLJt
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMVar# @ RealWorld @ (Maybe ThreadId) s'_i91ZE of
      { (# ipv_ia50l, ipv1_ia50m #) ->
      case putMVar#
             @ RealWorld
             @ (Maybe ThreadId)
             ipv1_ia50m
             (GHC.Base.Nothing @ ThreadId)
             ipv_ia50l
      of s2#_ia50o
      { __DEFAULT ->
      case getMaskingState# s2#_ia50o of
      { (# ipv2_iaIrA, ipv3_iaIrB #) ->
      let {
        ipv4_i7IAz :: MVar (Maybe ThreadId)
        [LclId, Unf=OtherCon []]
        ipv4_i7IAz = GHC.MVar.MVar @ (Maybe ThreadId) ipv1_ia50m } in
      case ipv3_iaIrB of {
        __DEFAULT ->
          case makeStablePtr# @ (MVar (Maybe ThreadId)) ipv4_i7IAz ipv2_iaIrA
          of
          { (# ipv5_iaIrF, ipv6_iaIrG #) ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlH
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr#
                                                       (MVar (Maybe ThreadId))) Addr#
                          :: (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ipv5_iaIrF
          of
          { (# ds4_daIlF, ds5_daIlE #) ->
          case eqAddr#
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr#
                                                       (MVar (Maybe ThreadId))) Addr#
                          :: (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ds5_daIlE
          of {
            __DEFAULT ->
              case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                     @ (MVar (Maybe ThreadId)) ipv6_iaIrG ds4_daIlF
              of
              { (# ds6_iaIrW #) ->
              deRefStablePtr#
                @ (MVar (Maybe ThreadId))
                (ds5_daIlE
                 `cast` (UnsafeCo representational Addr# (StablePtr#
                                                            (MVar (Maybe ThreadId)))
                         :: (Addr# :: TYPE 'AddrRep)
                            ~R# (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)))
                ds6_iaIrW
              };
            1# -> (# ds4_daIlF, ipv4_i7IAz #)
          }
          }
          };
        0# ->
          maskAsyncExceptions#
            @ (MVar (Maybe ThreadId))
            (\ (s1_iaIrz [OS=OneShot] :: State# RealWorld) ->
               case makeStablePtr# @ (MVar (Maybe ThreadId)) ipv4_i7IAz s1_iaIrz
               of
               { (# ipv5_iaIrF, ipv6_iaIrG #) ->
               case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlH
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr#
                                                            (MVar (Maybe ThreadId))) Addr#
                               :: (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ipv5_iaIrF
               of
               { (# ds4_daIlF, ds5_daIlE #) ->
               case eqAddr#
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr#
                                                            (MVar (Maybe ThreadId))) Addr#
                               :: (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ds5_daIlE
               of {
                 __DEFAULT ->
                   case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                          @ (MVar (Maybe ThreadId)) ipv6_iaIrG ds4_daIlF
                   of
                   { (# ds6_iaIrW #) ->
                   deRefStablePtr#
                     @ (MVar (Maybe ThreadId))
                     (ds5_daIlE
                      `cast` (UnsafeCo representational Addr# (StablePtr#
                                                                 (MVar (Maybe ThreadId)))
                              :: (Addr# :: TYPE 'AddrRep)
                                 ~R# (StablePtr# (MVar (Maybe ThreadId)) :: TYPE 'AddrRep)))
                     ds6_iaIrW
                   };
                 1# -> (# ds4_daIlF, ipv4_i7IAz #)
               }
               }
               })
            ipv2_iaIrA
      }
      }
      }
      }
      }

-- RHS size: {terms: 5, types: 36, coercions: 0, joins: 0/0}
timerManagerThreadVar [InlPrag=NOINLINE] :: MVar (Maybe ThreadId)
[GblId]
timerManagerThreadVar
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, MVar (Maybe ThreadId) #)
           lvl5_raLJt
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 78, types: 160, coercions: 58, joins: 0/1}
lvl6_raLJu
  :: State# RealWorld
     -> (# State# RealWorld, IORef (Maybe TM.TimerManager) #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl6_raLJu
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMutVar#
             @ (Maybe TM.TimerManager)
             @ RealWorld
             (GHC.Base.Nothing @ TM.TimerManager)
             s'_i91ZE
      of
      { (# ipv_ia4ZV, ipv1_ia4ZW #) ->
      case getMaskingState# ipv_ia4ZV of
      { (# ipv2_iaIrA, ipv3_iaIrB #) ->
      let {
        ipv4_saJ3E :: GHC.STRef.STRef RealWorld (Maybe TM.TimerManager)
        [LclId, Unf=OtherCon []]
        ipv4_saJ3E
          = GHC.STRef.STRef
              @ RealWorld @ (Maybe TM.TimerManager) ipv1_ia4ZW } in
      case ipv3_iaIrB of {
        __DEFAULT ->
          case makeStablePtr#
                 @ (IORef (Maybe TM.TimerManager))
                 (ipv4_saJ3E
                  `cast` (Sym (GHC.IORef.N:IORef[0]) <Maybe TM.TimerManager>_N
                          :: (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *)
                             ~R# (IORef (Maybe TM.TimerManager) :: *)))
                 ipv2_iaIrA
          of
          { (# ipv5_iaIrF, ipv6_iaIrG #) ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlP
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr#
                                                       (IORef (Maybe TM.TimerManager))) Addr#
                          :: (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ipv5_iaIrF
          of
          { (# ds4_daIlN, ds5_daIlM #) ->
          case eqAddr#
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr#
                                                       (IORef (Maybe TM.TimerManager))) Addr#
                          :: (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ds5_daIlM
          of {
            __DEFAULT ->
              case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                     @ (IORef (Maybe TM.TimerManager)) ipv6_iaIrG ds4_daIlN
              of
              { (# ds6_iaIrW #) ->
              deRefStablePtr#
                @ (IORef (Maybe TM.TimerManager))
                (ds5_daIlM
                 `cast` (UnsafeCo representational Addr# (StablePtr#
                                                            (IORef (Maybe TM.TimerManager)))
                         :: (Addr# :: TYPE 'AddrRep)
                            ~R# (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)))
                ds6_iaIrW
              };
            1# ->
              (# ds4_daIlN,
                 ipv4_saJ3E
                 `cast` (Sym (GHC.IORef.N:IORef[0]) <Maybe TM.TimerManager>_N
                         :: (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *)
                            ~R# (IORef (Maybe TM.TimerManager) :: *)) #)
          }
          }
          };
        0# ->
          maskAsyncExceptions#
            @ (IORef (Maybe TM.TimerManager))
            (\ (s1_iaIrz [OS=OneShot] :: State# RealWorld) ->
               case makeStablePtr#
                      @ (IORef (Maybe TM.TimerManager))
                      (ipv4_saJ3E
                       `cast` (Sym (GHC.IORef.N:IORef[0]) <Maybe TM.TimerManager>_N
                               :: (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *)
                                  ~R# (IORef (Maybe TM.TimerManager) :: *)))
                      s1_iaIrz
               of
               { (# ipv5_iaIrF, ipv6_iaIrG #) ->
               case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlP
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr#
                                                            (IORef (Maybe TM.TimerManager))) Addr#
                               :: (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ipv5_iaIrF
               of
               { (# ds4_daIlN, ds5_daIlM #) ->
               case eqAddr#
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr#
                                                            (IORef (Maybe TM.TimerManager))) Addr#
                               :: (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ds5_daIlM
               of {
                 __DEFAULT ->
                   case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                          @ (IORef (Maybe TM.TimerManager)) ipv6_iaIrG ds4_daIlN
                   of
                   { (# ds6_iaIrW #) ->
                   deRefStablePtr#
                     @ (IORef (Maybe TM.TimerManager))
                     (ds5_daIlM
                      `cast` (UnsafeCo representational Addr# (StablePtr#
                                                                 (IORef (Maybe TM.TimerManager)))
                              :: (Addr# :: TYPE 'AddrRep)
                                 ~R# (StablePtr# (IORef (Maybe TM.TimerManager)) :: TYPE 'AddrRep)))
                     ds6_iaIrW
                   };
                 1# ->
                   (# ds4_daIlN,
                      ipv4_saJ3E
                      `cast` (Sym (GHC.IORef.N:IORef[0]) <Maybe TM.TimerManager>_N
                              :: (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *)
                                 ~R# (IORef (Maybe TM.TimerManager) :: *)) #)
               }
               }
               })
            ipv2_iaIrA
      }
      }
      }
      }

-- RHS size: {terms: 5, types: 36, coercions: 0, joins: 0/0}
timerManager [InlPrag=NOINLINE] :: IORef (Maybe TM.TimerManager)
[GblId]
timerManager
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, IORef (Maybe TM.TimerManager) #)
           lvl6_raLJu
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl7_raLJv :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl7_raLJv
  = "Pattern match failure in do expression at GHC/Event/Thread.hs:216:3-10"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
GHC.Event.Thread.getSystemTimerManager2
  :: State# RealWorld -> (# State# RealWorld, TM.TimerManager #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
GHC.Event.Thread.getSystemTimerManager2
  = \ (eta_B1 :: State# RealWorld) ->
      GHC.IO.failIO1 @ TM.TimerManager (unpackCString# lvl7_raLJv) eta_B1

-- RHS size: {terms: 18, types: 36, coercions: 3, joins: 0/0}
GHC.Event.Thread.getSystemTimerManager1
  :: State# RealWorld -> (# State# RealWorld, TM.TimerManager #)
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (s_i7IAv [Occ=Once] :: State# RealWorld) ->
                 case timerManager
                      `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                              :: (IORef (Maybe TM.TimerManager) :: *)
                                 ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
                 of
                 { GHC.STRef.STRef var#_i7IB3 [Occ=Once] ->
                 case readMutVar#
                        @ RealWorld @ (Maybe TM.TimerManager) var#_i7IB3 s_i7IAv
                 of
                 { (# ipv_i7IAy [Occ=Once*], ipv1_i7IAz [Occ=Once!] #) ->
                 case ipv1_i7IAz of {
                   Nothing -> GHC.Event.Thread.getSystemTimerManager2 ipv_i7IAy;
                   Just mgr_aaHXe [Occ=Once] -> (# ipv_i7IAy, mgr_aaHXe #)
                 }
                 }
                 }}]
GHC.Event.Thread.getSystemTimerManager1
  = \ (s_i7IAv :: State# RealWorld) ->
      case timerManager
           `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                   :: (IORef (Maybe TM.TimerManager) :: *)
                      ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar#
             @ RealWorld @ (Maybe TM.TimerManager) var#_i7IB3 s_i7IAv
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz of {
        Nothing -> GHC.Event.Thread.getSystemTimerManager2 ipv_i7IAy;
        Just mgr_aaHXe -> (# ipv_i7IAy, mgr_aaHXe #)
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 3, joins: 0/0}
getSystemTimerManager :: IO TM.TimerManager
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.getSystemTimerManager1
               `cast` (Sym (GHC.Types.N:IO[0] <TM.TimerManager>_R)
                       :: (State# RealWorld
                           -> (# State# RealWorld, TM.TimerManager #) :: *)
                          ~R# (IO TM.TimerManager :: *))}]
getSystemTimerManager
  = GHC.Event.Thread.getSystemTimerManager1
    `cast` (Sym (GHC.Types.N:IO[0] <TM.TimerManager>_R)
            :: (State# RealWorld
                -> (# State# RealWorld, TM.TimerManager #) :: *)
               ~R# (IO TM.TimerManager :: *))

-- RHS size: {terms: 83, types: 143, coercions: 36, joins: 0/1}
lvl8_raLJw :: State# RealWorld -> (# State# RealWorld, MVar () #)
[GblId, Arity=1, Caf=NoCafRefs, Str=<S,U>, Unf=OtherCon []]
lvl8_raLJw
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case newMVar# @ RealWorld @ () s'_i91ZE of
      { (# ipv_ia50l, ipv1_ia50m #) ->
      case putMVar# @ RealWorld @ () ipv1_ia50m GHC.Tuple.() ipv_ia50l
      of s2#_ia50o
      { __DEFAULT ->
      case getMaskingState# s2#_ia50o of
      { (# ipv2_iaIrA, ipv3_iaIrB #) ->
      let {
        ipv4_i7IAz :: MVar ()
        [LclId, Unf=OtherCon []]
        ipv4_i7IAz = GHC.MVar.MVar @ () ipv1_ia50m } in
      case ipv3_iaIrB of {
        __DEFAULT ->
          case makeStablePtr# @ (MVar ()) ipv4_i7IAz ipv2_iaIrA of
          { (# ipv5_iaIrF, ipv6_iaIrG #) ->
          case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlX
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr# (MVar ())) Addr#
                          :: (StablePtr# (MVar ()) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ipv5_iaIrF
          of
          { (# ds4_daIlV, ds5_daIlU #) ->
          case eqAddr#
                 (ipv6_iaIrG
                  `cast` (UnsafeCo representational (StablePtr# (MVar ())) Addr#
                          :: (StablePtr# (MVar ()) :: TYPE 'AddrRep)
                             ~R# (Addr# :: TYPE 'AddrRep)))
                 ds5_daIlU
          of {
            __DEFAULT ->
              case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                     @ (MVar ()) ipv6_iaIrG ds4_daIlV
              of
              { (# ds6_iaIrW #) ->
              deRefStablePtr#
                @ (MVar ())
                (ds5_daIlU
                 `cast` (UnsafeCo representational Addr# (StablePtr# (MVar ()))
                         :: (Addr# :: TYPE 'AddrRep)
                            ~R# (StablePtr# (MVar ()) :: TYPE 'AddrRep)))
                ds6_iaIrW
              };
            1# -> (# ds4_daIlV, ipv4_i7IAz #)
          }
          }
          };
        0# ->
          maskAsyncExceptions#
            @ (MVar ())
            (\ (s1_iaIrz [OS=OneShot] :: State# RealWorld) ->
               case makeStablePtr# @ (MVar ()) ipv4_i7IAz s1_iaIrz of
               { (# ipv5_iaIrF, ipv6_iaIrG #) ->
               case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIlX
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr# (MVar ())) Addr#
                               :: (StablePtr# (MVar ()) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ipv5_iaIrF
               of
               { (# ds4_daIlV, ds5_daIlU #) ->
               case eqAddr#
                      (ipv6_iaIrG
                       `cast` (UnsafeCo representational (StablePtr# (MVar ())) Addr#
                               :: (StablePtr# (MVar ()) :: TYPE 'AddrRep)
                                  ~R# (Addr# :: TYPE 'AddrRep)))
                      ds5_daIlU
               of {
                 __DEFAULT ->
                   case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                          @ (MVar ()) ipv6_iaIrG ds4_daIlV
                   of
                   { (# ds6_iaIrW #) ->
                   deRefStablePtr#
                     @ (MVar ())
                     (ds5_daIlU
                      `cast` (UnsafeCo representational Addr# (StablePtr# (MVar ()))
                              :: (Addr# :: TYPE 'AddrRep)
                                 ~R# (StablePtr# (MVar ()) :: TYPE 'AddrRep)))
                     ds6_iaIrW
                   };
                 1# -> (# ds4_daIlV, ipv4_i7IAz #)
               }
               }
               })
            ipv2_iaIrA
      }
      }
      }
      }
      }

-- RHS size: {terms: 5, types: 33, coercions: 0, joins: 0/0}
ioManagerLock [InlPrag=NOINLINE] :: MVar ()
[GblId]
ioManagerLock
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld, MVar () #)
           lvl8_raLJw
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 121, types: 298, coercions: 105, joins: 1/3}
lvl9_raLJx
  :: State# RealWorld
     -> (# State# RealWorld,
           IORef (IOArray Int (Maybe (ThreadId, EventManager))) #)
[GblId, Arity=1, Str=<S,U>, Unf=OtherCon []]
lvl9_raLJx
  = \ (s_i91ZD [OS=OneShot] :: State# RealWorld) ->
      case noDuplicate# @ RealWorld s_i91ZD of s'_i91ZE { __DEFAULT ->
      case readInt32OffAddr#
             @ RealWorld (__label "enabled_capabilities" (data)) 0# s'_i91ZE
      of
      { (# ipv_iaIsF, ipv1_iaIsG #) ->
      let {
        u_saJ49 [Dmd=<S,U>] :: Int#
        [LclId]
        u_saJ49 = -# ipv1_iaIsG 1# } in
      join {
        $j_saJuY [Dmd=<C(S),1*C1(U(U,U))>]
          :: Int#
             -> (# State# RealWorld,
                   IORef (IOArray Int (Maybe (ThreadId, EventManager))) #)
        [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
        $j_saJuY (x_alN9 [OS=OneShot] :: Int#)
          = case <# x_alN9 0# of {
              __DEFAULT ->
                case newArray#
                       @ (Maybe (ThreadId, EventManager))
                       @ RealWorld
                       x_alN9
                       (GHC.Base.Nothing @ (ThreadId, EventManager))
                       ipv_iaIsF
                of
                { (# ipv2_iamtQ, ipv3_iamtR #) ->
                case newMutVar#
                       @ (IOArray Int (Maybe (ThreadId, EventManager)))
                       @ RealWorld
                       ((GHC.Arr.STArray
                           @ RealWorld
                           @ Int
                           @ (Maybe (ThreadId, EventManager))
                           lvl1_raLJo
                           (GHC.Types.I# u_saJ49)
                           x_alN9
                           ipv3_iamtR)
                        `cast` (Sym (GHC.IOArray.N:IOArray[0]) <Int>_N <Maybe
                                                                          (ThreadId,
                                                                           EventManager)>_N
                                :: (GHC.Arr.STArray
                                      RealWorld Int (Maybe (ThreadId, EventManager)) :: *)
                                   ~R# (IOArray Int (Maybe (ThreadId, EventManager)) :: *)))
                       ipv2_iamtQ
                of
                { (# ipv4_ia4ZV, ipv5_ia4ZW #) ->
                case getMaskingState# ipv4_ia4ZV of
                { (# ipv6_iaIrA, ipv7_iaIrB #) ->
                let {
                  ipv8_saJ4f
                    :: GHC.STRef.STRef
                         RealWorld (IOArray Int (Maybe (ThreadId, EventManager)))
                  [LclId, Unf=OtherCon []]
                  ipv8_saJ4f
                    = GHC.STRef.STRef
                        @ RealWorld
                        @ (IOArray Int (Maybe (ThreadId, EventManager)))
                        ipv5_ia4ZW } in
                case ipv7_iaIrB of {
                  __DEFAULT ->
                    case makeStablePtr#
                           @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                           (ipv8_saJ4f
                            `cast` (Sym (GHC.IORef.N:IORef[0]) <IOArray
                                                                  Int
                                                                  (Maybe
                                                                     (ThreadId, EventManager))>_N
                                    :: (GHC.STRef.STRef
                                          RealWorld
                                          (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                                       ~R# (IORef
                                              (IOArray Int (Maybe (ThreadId, EventManager))) :: *)))
                           ipv6_iaIrA
                    of
                    { (# ipv9_iaIrF, ipv10_iaIrG #) ->
                    case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIm5
                           (ipv10_iaIrG
                            `cast` (UnsafeCo representational (StablePtr#
                                                                 (IORef
                                                                    (IOArray
                                                                       Int
                                                                       (Maybe
                                                                          (ThreadId,
                                                                           EventManager))))) Addr#
                                    :: (StablePtr#
                                          (IORef
                                             (IOArray Int (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                                  'AddrRep)
                                       ~R# (Addr# :: TYPE 'AddrRep)))
                           ipv9_iaIrF
                    of
                    { (# ds7_daIm3, ds8_daIm2 #) ->
                    case eqAddr#
                           (ipv10_iaIrG
                            `cast` (UnsafeCo representational (StablePtr#
                                                                 (IORef
                                                                    (IOArray
                                                                       Int
                                                                       (Maybe
                                                                          (ThreadId,
                                                                           EventManager))))) Addr#
                                    :: (StablePtr#
                                          (IORef
                                             (IOArray Int (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                                  'AddrRep)
                                       ~R# (Addr# :: TYPE 'AddrRep)))
                           ds8_daIm2
                    of {
                      __DEFAULT ->
                        case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                               @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                               ipv10_iaIrG
                               ds7_daIm3
                        of
                        { (# ds9_iaIrW #) ->
                        deRefStablePtr#
                          @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                          (ds8_daIm2
                           `cast` (UnsafeCo representational Addr# (StablePtr#
                                                                      (IORef
                                                                         (IOArray
                                                                            Int
                                                                            (Maybe
                                                                               (ThreadId,
                                                                                EventManager)))))
                                   :: (Addr# :: TYPE 'AddrRep)
                                      ~R# (StablePtr#
                                             (IORef
                                                (IOArray
                                                   Int (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                               'AddrRep)))
                          ds9_iaIrW
                        };
                      1# ->
                        (# ds7_daIm3,
                           ipv8_saJ4f
                           `cast` (Sym (GHC.IORef.N:IORef[0]) <IOArray
                                                                 Int
                                                                 (Maybe (ThreadId, EventManager))>_N
                                   :: (GHC.STRef.STRef
                                         RealWorld
                                         (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                                      ~R# (IORef
                                             (IOArray
                                                Int (Maybe (ThreadId, EventManager))) :: *)) #)
                    }
                    }
                    };
                  0# ->
                    maskAsyncExceptions#
                      @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                      (\ (s1_iaIrz [OS=OneShot] :: State# RealWorld) ->
                         case makeStablePtr#
                                @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                                (ipv8_saJ4f
                                 `cast` (Sym (GHC.IORef.N:IORef[0]) <IOArray
                                                                       Int
                                                                       (Maybe
                                                                          (ThreadId,
                                                                           EventManager))>_N
                                         :: (GHC.STRef.STRef
                                               RealWorld
                                               (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                                            ~R# (IORef
                                                   (IOArray
                                                      Int (Maybe (ThreadId, EventManager))) :: *)))
                                s1_iaIrz
                         of
                         { (# ipv9_iaIrF, ipv10_iaIrG #) ->
                         case {__pkg_ccall base-4.11.0.0 Addr#
                           -> State# RealWorld -> (# State# RealWorld, Addr# #)}_daIm5
                                (ipv10_iaIrG
                                 `cast` (UnsafeCo representational (StablePtr#
                                                                      (IORef
                                                                         (IOArray
                                                                            Int
                                                                            (Maybe
                                                                               (ThreadId,
                                                                                EventManager))))) Addr#
                                         :: (StablePtr#
                                               (IORef
                                                  (IOArray
                                                     Int (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                                 'AddrRep)
                                            ~R# (Addr# :: TYPE 'AddrRep)))
                                ipv9_iaIrF
                         of
                         { (# ds7_daIm3, ds8_daIm2 #) ->
                         case eqAddr#
                                (ipv10_iaIrG
                                 `cast` (UnsafeCo representational (StablePtr#
                                                                      (IORef
                                                                         (IOArray
                                                                            Int
                                                                            (Maybe
                                                                               (ThreadId,
                                                                                EventManager))))) Addr#
                                         :: (StablePtr#
                                               (IORef
                                                  (IOArray
                                                     Int (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                                 'AddrRep)
                                            ~R# (Addr# :: TYPE 'AddrRep)))
                                ds8_daIm2
                         of {
                           __DEFAULT ->
                             case {__pkg_ccall base-4.11.0.0 forall a.
                           StablePtr# a -> State# RealWorld -> (# State# RealWorld #)}_iaIrT
                                    @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                                    ipv10_iaIrG
                                    ds7_daIm3
                             of
                             { (# ds9_iaIrW #) ->
                             deRefStablePtr#
                               @ (IORef (IOArray Int (Maybe (ThreadId, EventManager))))
                               (ds8_daIm2
                                `cast` (UnsafeCo representational Addr# (StablePtr#
                                                                           (IORef
                                                                              (IOArray
                                                                                 Int
                                                                                 (Maybe
                                                                                    (ThreadId,
                                                                                     EventManager)))))
                                        :: (Addr# :: TYPE 'AddrRep)
                                           ~R# (StablePtr#
                                                  (IORef
                                                     (IOArray
                                                        Int
                                                        (Maybe (ThreadId, EventManager)))) :: TYPE
                                                                                                'AddrRep)))
                               ds9_iaIrW
                             };
                           1# ->
                             (# ds7_daIm3,
                                ipv8_saJ4f
                                `cast` (Sym (GHC.IORef.N:IORef[0]) <IOArray
                                                                      Int
                                                                      (Maybe
                                                                         (ThreadId,
                                                                          EventManager))>_N
                                        :: (GHC.STRef.STRef
                                              RealWorld
                                              (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                                           ~R# (IORef
                                                  (IOArray
                                                     Int (Maybe (ThreadId, EventManager))) :: *)) #)
                         }
                         }
                         })
                      ipv6_iaIrA
                }
                }
                }
                };
              1# -> case GHC.Arr.negRange of wild_00 { }
            } } in
      case <=# 0# u_saJ49 of {
        __DEFAULT -> jump $j_saJuY 0#;
        1# -> jump $j_saJuY (+# u_saJ49 1#)
      }
      }
      }

-- RHS size: {terms: 5, types: 48, coercions: 0, joins: 0/0}
eventManager [InlPrag=NOINLINE]
  :: IORef (IOArray Int (Maybe (ThreadId, EventManager)))
[GblId]
eventManager
  = case runRW#
           @ ('TupleRep '['TupleRep '[], 'LiftedRep])
           @ (# State# RealWorld,
                IORef (IOArray Int (Maybe (ThreadId, EventManager))) #)
           lvl9_raLJx
    of
    { (# ipv_i91ZH, ipv1_i91ZI #) ->
    ipv1_i91ZI
    }

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning5 :: Addr#
[GblId,
 Caf=NoCafRefs,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 40 0}]
GHC.Event.Thread.ensureIOManagerIsRunning5 = "TimerManager"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning4 :: [Char]
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=False, ConLike=True,
         WorkFree=False, Expandable=True, Guidance=IF_ARGS [] 20 0}]
GHC.Event.Thread.ensureIOManagerIsRunning4
  = unpackCString# GHC.Event.Thread.ensureIOManagerIsRunning5

-- RHS size: {terms: 74, types: 119, coercions: 12, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning3
  :: State# RealWorld -> (# State# RealWorld, Maybe ThreadId #)
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0] 326 30}]
GHC.Event.Thread.ensureIOManagerIsRunning3
  = \ (s_X7IBQ :: State# RealWorld) ->
      case GHC.Event.Poll.new1 s_X7IBQ of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case GHC.Event.TimerManager.new2 ipv1_i7IAz ipv_i7IAy of
      { (# ipv2_X7IDM, ipv3_X7IDO #) ->
      case ipv3_X7IDO of mgr_XaHXZ
      { GHC.Event.TimerManager.TimerManager ipv4_saItn ipv5_saIto
                                            ipv6_saItp ipv7_saItq ipv8_saItr ipv9_saIts ipv10_saItt
                                            ipv11_saItu ipv12_saItv ->
      case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld #)}_daIll
             (narrow32Int# ipv9_saIts) ipv2_X7IDM
      of
      { (# ds_daIlj #) ->
      case timerManager
           `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                   :: (IORef (Maybe TM.TimerManager) :: *)
                      ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
      of
      { GHC.STRef.STRef var#_i7IBc ->
      case writeMutVar#
             @ RealWorld
             @ (Maybe TM.TimerManager)
             var#_i7IBc
             (GHC.Base.Just @ TM.TimerManager mgr_XaHXZ)
             ds_daIlj
      of s2#_i7IBe
      { __DEFAULT ->
      case fork#
             @ (IO ())
             ((\ (eta_iamwF :: State# RealWorld) ->
                 catch#
                   @ ()
                   @ SomeException
                   (\ (w1_sasbA [OS=OneShot] :: State# RealWorld) ->
                      GHC.Event.TimerManager.$wloop
                        ipv4_saItn
                        ipv5_saIto
                        ipv6_saItp
                        ipv7_saItq
                        ipv8_saItr
                        ipv9_saIts
                        ipv10_saItt
                        ipv11_saItu
                        ipv12_saItv
                        w1_sasbA)
                   GHC.Conc.Sync.forkIO2
                   eta_iamwF)
              `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                      :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                         ~R# (IO () :: *)))
             s2#_i7IBe
      of
      { (# ipv13_iamwJ, ipv14_iamwK #) ->
      case GHC.Foreign.charIsRepresentable3
             @ ()
             GHC.IO.Encoding.UTF8.utf8
             GHC.Event.Thread.ensureIOManagerIsRunning4
             ((\ (ds4_iaIng :: Ptr Foreign.C.Types.CChar)
                 (eta1_iaInh [OS=OneShot] :: State# RealWorld) ->
                 case ds4_iaIng of { GHC.Ptr.Ptr p_iaInk ->
                 case labelThread# ipv14_iamwK p_iaInk eta1_iaInh of s1_iaInm
                 { __DEFAULT ->
                 (# s1_iaInm, GHC.Tuple.() #)
                 }
                 })
              `cast` (<Ptr Foreign.C.Types.CChar>_R
                      ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                      :: (Ptr Foreign.C.Types.CChar
                          -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                         ~R# (Ptr Foreign.C.Types.CChar -> IO () :: *)))
             ipv13_iamwJ
      of
      { (# ipv15_X7JkQ, ipv16_X7JkS #) ->
      (# ipv15_X7JkQ,
         GHC.Base.Just @ ThreadId (GHC.Conc.Sync.ThreadId ipv14_iamwK) #)
      }
      }
      }
      }
      }
      }
      }
      }

-- RHS size: {terms: 105, types: 199, coercions: 5, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning2
  :: Maybe ThreadId
     -> State# RealWorld -> (# State# RealWorld, Maybe ThreadId #)
[GblId,
 Arity=2,
 Str=<S,1*U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [40 0] 366 30}]
GHC.Event.Thread.ensureIOManagerIsRunning2
  = \ (old_aaHXx [OS=OneShot] :: Maybe ThreadId)
      (eta_X9 [OS=OneShot] :: State# RealWorld) ->
      case old_aaHXx of wild_Xq {
        Nothing -> GHC.Event.Thread.ensureIOManagerIsRunning3 eta_X9;
        Just t_aaHXC ->
          case t_aaHXC of { GHC.Conc.Sync.ThreadId ww1_iaIra ->
          case threadStatus# ww1_iaIra eta_X9 of
          { (# ipv_iaJMz, ipv1_iaJMA, ipv2_iaJMB, ipv3_iaJMC #) ->
          case ipv1_iaJMA of {
            __DEFAULT -> (# ipv_iaJMz, wild_Xq #);
            16# -> GHC.Event.Thread.ensureIOManagerIsRunning3 ipv_iaJMz;
            17# ->
              case timerManager
                   `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                           :: (IORef (Maybe TM.TimerManager) :: *)
                              ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
              of
              { GHC.STRef.STRef var#_i7IB3 ->
              case readMutVar#
                     @ RealWorld @ (Maybe TM.TimerManager) var#_i7IB3 ipv_iaJMz
              of
              { (# ipv4_X7ICe, ipv5_X7ICg #) ->
              case ipv5_X7ICg of {
                Nothing -> GHC.Event.Thread.ensureIOManagerIsRunning3 ipv4_X7ICe;
                Just em_aaHXF ->
                  case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld #)}_daIll
                         -1# ipv4_X7ICe
                  of
                  { (# ds2_daIlj #) ->
                  case em_aaHXF of
                  { GHC.Event.TimerManager.TimerManager ww3_sasbd ww4_sasbe ww5_sasbf
                                                        ww6_sasbg ww7_sasbh ww8_sasbi ww9_sasbj
                                                        ww10_sasbk ww11_sasbl ->
                  case ww3_sasbd of
                  { GHC.Event.Internal.Backend @ a_saLge bState_saLgf ds3_saLgg
                                               ds4_saLgh ds5_saLgi bDelete_saLgj ->
                  case writeMutVar#
                         @ RealWorld
                         @ GHC.Event.TimerManager.State
                         ww5_sasbf
                         GHC.Event.TimerManager.Finished
                         ds2_daIlj
                  of s2#_i7IBe
                  { __DEFAULT ->
                  case ((bDelete_saLgj bState_saLgf)
                        `cast` (GHC.Types.N:IO[0] <()>_R
                                :: (IO () :: *)
                                   ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                         s2#_i7IBe
                  of
                  { (# ipv6_X7Jlk, ipv7_X7Jlm #) ->
                  case atomicModifyMutVar#
                         @ RealWorld
                         @ Bool
                         @ (Bool, ())
                         @ ()
                         ww11_sasbl
                         GHC.Event.Control.closeControl2
                         ipv6_X7Jlk
                  of
                  { (# ipv8_X7Jmh, ipv9_X7Jmj #) ->
                  case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld, Int# #)}_iao5C
                         (narrow32Int# ww7_sasbh) ipv8_X7Jmh
                  of
                  { (# ds8_iao5H, ds9_iao5I #) ->
                  case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld, Int# #)}_iao5C
                         (narrow32Int# ww8_sasbi) ds8_iao5H
                  of
                  { (# ds10_Xao9L, ds11_Xao9N #) ->
                  case ww10_sasbk of {
                    False ->
                      case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld, Int# #)}_iao5C
                             (narrow32Int# ww9_sasbj) ds10_Xao9L
                      of
                      { (# ds12_Xaoa2, ds13_Xaoa4 #) ->
                      GHC.Event.Thread.ensureIOManagerIsRunning3 ds12_Xaoa2
                      };
                    True ->
                      case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld #)}_dao8Y
                             -1# ds10_Xao9L
                      of
                      { (# ds12_dao8W #) ->
                      case {__pkg_ccall base-4.11.0.0 Int#
                           -> State# RealWorld -> (# State# RealWorld, Int# #)}_iao5C
                             (narrow32Int# ww9_sasbj) ds12_dao8W
                      of
                      { (# ds13_Xaoa2, ds14_Xaoa4 #) ->
                      GHC.Event.Thread.ensureIOManagerIsRunning3 ds13_Xaoa2
                      }
                      }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
              }
              }
              }
          }
          }
          }
      }

-- RHS size: {terms: 84, types: 140, coercions: 17, joins: 2/2}
GHC.Event.Thread.ensureIOManagerIsRunning6
  :: () -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<L,A><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0 0] 204 30}]
GHC.Event.Thread.ensureIOManagerIsRunning6
  = \ _ [Occ=Dead, OS=OneShot]
      (s_X7IBK [OS=OneShot] :: State# RealWorld) ->
      case eventManager
           `cast` (GHC.IORef.N:IORef[0] <IOArray
                                           Int (Maybe (ThreadId, EventManager))>_N
                   :: (IORef (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                      ~R# (GHC.STRef.STRef
                             RealWorld (IOArray Int (Maybe (ThreadId, EventManager))) :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar#
             @ RealWorld
             @ (IOArray Int (Maybe (ThreadId, EventManager)))
             var#_i7IB3
             s_X7IBK
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz
           `cast` (GHC.IOArray.N:IOArray[0] <Int>_N <Maybe
                                                       (ThreadId, EventManager)>_N
                   :: (IOArray Int (Maybe (ThreadId, EventManager)) :: *)
                      ~R# (GHC.Arr.STArray
                             RealWorld Int (Maybe (ThreadId, EventManager)) :: *))
      of
      { GHC.Arr.STArray l_i80pt u_i80pu dt_i80pv ds2_i80pw ->
      case u_i80pu of { I# y_saLg7 ->
      case l_i80pt of { I# ww1_saLga ->
      case ># 0# y_saLg7 of {
        __DEFAULT ->
          join {
            exit_X1V [Dmd=<L,C(U(U,U))>]
              :: State# RealWorld -> (# State# RealWorld, () #)
            [LclId[JoinId(1)], Arity=1, Str=<S,U>]
            exit_X1V (ipv2_i7JiK [OS=OneShot] :: State# RealWorld)
              = case numEnabledEventManagers
                     `cast` (GHC.IORef.N:IORef[0] <Int>_N
                             :: (IORef Int :: *) ~R# (GHC.STRef.STRef RealWorld Int :: *))
                of
                { GHC.STRef.STRef var#1_i7IBc ->
                case writeMutVar#
                       @ RealWorld
                       @ Int
                       var#1_i7IBc
                       (GHC.Types.I# (+# y_saLg7 1#))
                       ipv2_i7JiK
                of s2#_i7IBe
                { __DEFAULT ->
                (# s2#_i7IBe, GHC.Tuple.() #)
                }
                } } in
          joinrec {
            go1_saJOm [Occ=LoopBreaker]
              :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
            [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
            go1_saJOm (x_i819P :: Int#) (eta_X31 :: State# RealWorld)
              = case GHC.Event.Thread.$wstartIOManagerThread
                       ww1_saLga y_saLg7 ds2_i80pw x_i819P eta_X31
                of
                { (# ipv2_i7JiK, ipv3_i7JiL #) ->
                case ==# x_i819P y_saLg7 of {
                  __DEFAULT -> jump go1_saJOm (+# x_i819P 1#) ipv2_i7JiK;
                  1# -> jump exit_X1V ipv2_i7JiK
                }
                }; } in
          jump go1_saJOm 0# ipv_i7IAy;
        1# ->
          case numEnabledEventManagers
               `cast` (GHC.IORef.N:IORef[0] <Int>_N
                       :: (IORef Int :: *) ~R# (GHC.STRef.STRef RealWorld Int :: *))
          of
          { GHC.STRef.STRef var#1_i7IBc ->
          case writeMutVar#
                 @ RealWorld
                 @ Int
                 var#1_i7IBc
                 (GHC.Types.I# (+# y_saLg7 1#))
                 ipv_i7IAy
          of s2#_i7IBe
          { __DEFAULT ->
          (# s2#_i7IBe, GHC.Tuple.() #)
          }
          }
      }
      }
      }
      }
      }
      }

-- RHS size: {terms: 28, types: 48, coercions: 12, joins: 0/0}
GHC.Event.Thread.ensureIOManagerIsRunning1
  :: State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=1,
 Str=<L,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0] 120 30}]
GHC.Event.Thread.ensureIOManagerIsRunning1
  = \ (eta_B1 :: State# RealWorld) ->
      case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Int# #)}_daIlz
             realWorld#
      of
      { (# ds_daIly, ds1_daIlx #) ->
      case ds1_daIlx of {
        __DEFAULT ->
          case ioManagerLock of { GHC.MVar.MVar ww1_iaiAR ->
          case GHC.Conc.Sync.$wwithMVar
                 @ ()
                 @ ()
                 ww1_iaiAR
                 (GHC.Event.Thread.ensureIOManagerIsRunning6
                  `cast` (<()>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                          :: (() -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                             ~R# (() -> IO () :: *)))
                 eta_B1
          of
          { (# ipv_i7JiK, ipv1_i7JiL #) ->
          case timerManagerThreadVar of { GHC.MVar.MVar ww3_iaItj ->
          GHC.Conc.Sync.$wmodifyMVar_
            @ (Maybe ThreadId)
            ww3_iaItj
            (GHC.Event.Thread.ensureIOManagerIsRunning2
             `cast` (<Maybe ThreadId>_R
                     ->_R Sym (GHC.Types.N:IO[0] <Maybe ThreadId>_R)
                     :: (Maybe ThreadId
                         -> State# RealWorld -> (# State# RealWorld, Maybe ThreadId #) :: *)
                        ~R# (Maybe ThreadId -> IO (Maybe ThreadId) :: *)))
            ipv_i7JiK
          }
          }
          };
        0# -> (# eta_B1, GHC.Tuple.() #)
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 3, joins: 0/0}
ensureIOManagerIsRunning :: IO ()
[GblId,
 Arity=1,
 Str=<L,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.ensureIOManagerIsRunning1
               `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (IO () :: *))}]
ensureIOManagerIsRunning
  = GHC.Event.Thread.ensureIOManagerIsRunning1
    `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
            :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl10_raLJy :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl10_raLJy
  = "Pattern match failure in do expression at GHC/Event/Thread.hs:353:15-26"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
lvl11_raLJz :: State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
lvl11_raLJz
  = \ (eta_B1 :: State# RealWorld) ->
      GHC.IO.failIO1 @ () (unpackCString# lvl10_raLJy) eta_B1

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl12_raLJA :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl12_raLJA
  = "Pattern match failure in do expression at GHC/Event/Thread.hs:339:17-30"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
lvl13_raLJB :: State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
lvl13_raLJB
  = \ (eta_B1 :: State# RealWorld) ->
      GHC.IO.failIO1 @ () (unpackCString# lvl12_raLJA) eta_B1

-- RHS size: {terms: 9, types: 5, coercions: 0, joins: 0/0}
lvl14_raLJC :: Int -> Int -> Int -> Int
[GblId, Arity=3, Str=<B,U><B,U><B,U>x, Unf=OtherCon []]
lvl14_raLJC
  = \ (u_i80pu :: Int) (wild1_saIZM :: Int) (wild3_iax2l :: Int) ->
      GHC.Arr.$windexError
        @ Int
        @ Int
        GHC.Show.$fShowInt
        wild1_saIZM
        u_i80pu
        wild3_iax2l
        lvl4_raLJs

-- RHS size: {terms: 8, types: 4, coercions: 0, joins: 0/0}
lvl15_raLJD :: Int -> Int -> Int
[GblId, Arity=2, Str=<B,U><B,U>x, Unf=OtherCon []]
lvl15_raLJD
  = \ (u_saIYf :: Int) (wild3_iax2l :: Int) ->
      GHC.Arr.$windexError
        @ Int
        @ Int
        GHC.Show.$fShowInt
        lvl1_raLJo
        u_saIYf
        wild3_iax2l
        lvl4_raLJs

-- RHS size: {terms: 446, types: 529, coercions: 29, joins: 14/19}
GHC.Event.Thread.$wioManagerCapabilitiesChanged [InlPrag=NOUSERINLINE[0]]
  :: State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=1, Str=<S,U>, Unf=OtherCon []]
GHC.Event.Thread.$wioManagerCapabilitiesChanged
  = \ (w_saKNS :: State# RealWorld) ->
      case readInt32OffAddr#
             @ RealWorld (__label "enabled_capabilities" (data)) 0# w_saKNS
      of
      { (# ipv_iaIsF, ipv1_iaIsG #) ->
      case numEnabledEventManagers
           `cast` (GHC.IORef.N:IORef[0] <Int>_N
                   :: (IORef Int :: *) ~R# (GHC.STRef.STRef RealWorld Int :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar# @ RealWorld @ Int var#_i7IB3 ipv_iaIsF of
      { (# ipv2_X7IBT, ipv3_X7IBV #) ->
      case writeMutVar#
             @ RealWorld @ Int var#_i7IB3 (GHC.Types.I# ipv1_iaIsG) ipv2_X7IBT
      of s2#_i7IBe
      { __DEFAULT ->
      case eventManager
           `cast` (GHC.IORef.N:IORef[0] <IOArray
                                           Int (Maybe (ThreadId, EventManager))>_N
                   :: (IORef (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                      ~R# (GHC.STRef.STRef
                             RealWorld (IOArray Int (Maybe (ThreadId, EventManager))) :: *))
      of
      { GHC.STRef.STRef var#1_X7IEU ->
      case readMutVar#
             @ RealWorld
             @ (IOArray Int (Maybe (ThreadId, EventManager)))
             var#1_X7IEU
             s2#_i7IBe
      of
      { (# ipv4_X7IC4, ipv5_X7IC6 #) ->
      case ipv5_X7IC6
           `cast` (GHC.IOArray.N:IOArray[0] <Int>_N <Maybe
                                                       (ThreadId, EventManager)>_N
                   :: (IOArray Int (Maybe (ThreadId, EventManager)) :: *)
                      ~R# (GHC.Arr.STArray
                             RealWorld Int (Maybe (ThreadId, EventManager)) :: *))
      of
      { GHC.Arr.STArray l_i80pt u_i80pu dt_i80pv ds5_i80pw ->
      case u_i80pu of wild3_saLgo { I# x_saLgp ->
      case l_i80pt of wild4_saLgx { I# m_saLgy ->
      let {
        y_aA1I [Dmd=<S,U>] :: Int#
        [LclId]
        y_aA1I = +# x_saLgp 1# } in
      case ># ipv1_iaIsG y_aA1I of {
        __DEFAULT ->
          case ipv3_X7IBV of { I# y1_XA4D ->
          case ># ipv1_iaIsG y1_XA4D of {
            __DEFAULT -> (# ipv4_X7IC4, GHC.Tuple.() #);
            1# ->
              let {
                y2_i819M [Dmd=<S,U>] :: Int#
                [LclId]
                y2_i819M = -# ipv1_iaIsG 1# } in
              case ># y1_XA4D y2_i819M of {
                __DEFAULT ->
                  join {
                    exit_X20 [Dmd=<L,C(C1(U(U,U)))>]
                      :: Int -> Int -> (# State# RealWorld, () #)
                    [LclId[JoinId(2)], Arity=2, Str=<B,U><B,U>b]
                    exit_X20 (wild6_saIZM [OS=OneShot]
                                :: Int
                                Unf=OtherCon [])
                             (wild7_iax2l [OS=OneShot] :: Int)
                      = case lvl14_raLJC wild3_saLgo wild6_saIZM wild7_iax2l
                        of wild8_00 {
                        } } in
                  join {
                    exit1_X22 [Dmd=<L,C(C1(U(U,U)))>]
                      :: Int -> Int -> (# State# RealWorld, () #)
                    [LclId[JoinId(2)], Arity=2, Str=<B,U><B,U>b]
                    exit1_X22 (wild6_saIZM [OS=OneShot]
                                 :: Int
                                 Unf=OtherCon [])
                              (wild7_iax2l [OS=OneShot] :: Int)
                      = case lvl14_raLJC wild3_saLgo wild6_saIZM wild7_iax2l
                        of wild8_00 {
                        } } in
                  joinrec {
                    go1_saJQj [Occ=LoopBreaker]
                      :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
                    [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
                    go1_saJQj (x1_i819P :: Int#) (eta_B1 :: State# RealWorld)
                      = case <=# m_saLgy x1_i819P of {
                          __DEFAULT -> jump exit_X20 wild4_saLgx (GHC.Types.I# x1_i819P);
                          1# ->
                            case <=# x1_i819P x_saLgp of {
                              __DEFAULT -> jump exit1_X22 wild4_saLgx (GHC.Types.I# x1_i819P);
                              1# ->
                                case readArray#
                                       @ RealWorld
                                       @ (Maybe (ThreadId, EventManager))
                                       ds5_i80pw
                                       (-# x1_i819P m_saLgy)
                                       eta_B1
                                of
                                { (# ipv6_X7ICo, ipv7_X7ICq #) ->
                                case ipv7_X7ICq of {
                                  Nothing -> lvl11_raLJz ipv6_X7ICo;
                                  Just ds_daIhY ->
                                    case ds_daIhY of { (ds7_daIhZ, mgr_aaHXS) ->
                                    case restartPollLoop_raLJq
                                           mgr_aaHXS (GHC.Types.I# x1_i819P) ipv6_X7ICo
                                    of
                                    { (# ipv8_X7ICF, ipv9_X7ICH #) ->
                                    case writeArray#
                                           @ RealWorld
                                           @ (Maybe (ThreadId, EventManager))
                                           ds5_i80pw
                                           (-# x1_i819P m_saLgy)
                                           (GHC.Base.Just
                                              @ (ThreadId, EventManager) (ipv9_X7ICH, mgr_aaHXS))
                                           ipv8_X7ICF
                                    of s2#1_i80pX
                                    { __DEFAULT ->
                                    case ==# x1_i819P y2_i819M of {
                                      __DEFAULT -> jump go1_saJQj (+# x1_i819P 1#) s2#1_i80pX;
                                      1# -> (# s2#1_i80pX, GHC.Tuple.() #)
                                    }
                                    }
                                    }
                                    }
                                }
                                }
                            }
                        }; } in
                  jump go1_saJQj y1_XA4D ipv4_X7IC4;
                1# -> (# ipv4_X7IC4, GHC.Tuple.() #)
              }
          }
          };
        1# ->
          let {
            u1_saJ5D [Dmd=<S,U>] :: Int#
            [LclId]
            u1_saJ5D = -# ipv1_iaIsG 1# } in
          join {
            $j_saJwc [Dmd=<C(S),1*C1(U(U,U))>]
              :: Int# -> (# State# RealWorld, () #)
            [LclId[JoinId(1)], Arity=1, Str=<S,U>, Unf=OtherCon []]
            $j_saJwc (x1_alN9 [OS=OneShot] :: Int#)
              = case <# x1_alN9 0# of {
                  __DEFAULT ->
                    case newArray#
                           @ (Maybe (ThreadId, EventManager))
                           @ RealWorld
                           x1_alN9
                           (GHC.Base.Nothing @ (ThreadId, EventManager))
                           ipv4_X7IC4
                    of
                    { (# ipv6_iamtQ, ipv7_iamtR #) ->
                    let {
                      u2_saIYf :: Int
                      [LclId, Unf=OtherCon []]
                      u2_saIYf = GHC.Types.I# u1_saJ5D } in
                    join {
                      $w$j_saKNN [InlPrag=NOUSERINLINE[0], Dmd=<L,C(U(U,U))>]
                        :: State# RealWorld -> (# State# RealWorld, () #)
                      [LclId[JoinId(1)], Arity=1, Str=<S,U>]
                      $w$j_saKNN (w1_saKNL [OS=OneShot] :: State# RealWorld)
                        = case ># y_aA1I u1_saJ5D of {
                            __DEFAULT ->
                              join {
                                exit_X26 [Dmd=<L,C(U(U,U))>]
                                  :: State# RealWorld -> (# State# RealWorld, () #)
                                [LclId[JoinId(1)], Arity=1, Str=<S,U>]
                                exit_X26 (ipv8_X7JkW [OS=OneShot] :: State# RealWorld)
                                  = case writeMutVar#
                                           @ RealWorld
                                           @ (IOArray Int (Maybe (ThreadId, EventManager)))
                                           var#1_X7IEU
                                           ((GHC.Arr.STArray
                                               @ RealWorld
                                               @ Int
                                               @ (Maybe (ThreadId, EventManager))
                                               lvl1_raLJo
                                               u2_saIYf
                                               x1_alN9
                                               ipv7_iamtR)
                                            `cast` (Sym (GHC.IOArray.N:IOArray[0]) <Int>_N <Maybe
                                                                                              (ThreadId,
                                                                                               EventManager)>_N
                                                    :: (GHC.Arr.STArray
                                                          RealWorld
                                                          Int
                                                          (Maybe (ThreadId, EventManager)) :: *)
                                                       ~R# (IOArray
                                                              Int
                                                              (Maybe
                                                                 (ThreadId, EventManager)) :: *)))
                                           ipv8_X7JkW
                                    of s2#1_X7IGm
                                    { __DEFAULT ->
                                    (# s2#1_X7IGm, GHC.Tuple.() #)
                                    } } in
                              joinrec {
                                go1_saJQK [Occ=LoopBreaker]
                                  :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
                                [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
                                go1_saJQK (x2_i819P :: Int#) (eta_X6X :: State# RealWorld)
                                  = case GHC.Event.Thread.$wstartIOManagerThread
                                           0# u1_saJ5D ipv7_iamtR x2_i819P eta_X6X
                                    of
                                    { (# ipv8_X7JkW, ipv9_X7JkY #) ->
                                    case ==# x2_i819P u1_saJ5D of {
                                      __DEFAULT -> jump go1_saJQK (+# x2_i819P 1#) ipv8_X7JkW;
                                      1# -> jump exit_X26 ipv8_X7JkW
                                    }
                                    }; } in
                              jump go1_saJQK y_aA1I w1_saKNL;
                            1# ->
                              case writeMutVar#
                                     @ RealWorld
                                     @ (IOArray Int (Maybe (ThreadId, EventManager)))
                                     var#1_X7IEU
                                     ((GHC.Arr.STArray
                                         @ RealWorld
                                         @ Int
                                         @ (Maybe (ThreadId, EventManager))
                                         lvl1_raLJo
                                         u2_saIYf
                                         x1_alN9
                                         ipv7_iamtR)
                                      `cast` (Sym (GHC.IOArray.N:IOArray[0]) <Int>_N <Maybe
                                                                                        (ThreadId,
                                                                                         EventManager)>_N
                                              :: (GHC.Arr.STArray
                                                    RealWorld
                                                    Int
                                                    (Maybe (ThreadId, EventManager)) :: *)
                                                 ~R# (IOArray
                                                        Int (Maybe (ThreadId, EventManager)) :: *)))
                                     w1_saKNL
                              of s2#1_X7IGm
                              { __DEFAULT ->
                              (# s2#1_X7IGm, GHC.Tuple.() #)
                              }
                          } } in
                    case ># 0# x_saLgp of {
                      __DEFAULT ->
                        join {
                          exit_X24 [Dmd=<L,C(C1(U(U,U)))>]
                            :: Int -> Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(2)], Arity=2, Str=<B,U><B,U>b]
                          exit_X24 (wild5_saJ0b [OS=OneShot]
                                      :: Int
                                      Unf=OtherCon [])
                                   (wild6_iax2l [OS=OneShot] :: Int)
                            = case lvl14_raLJC wild3_saLgo wild5_saJ0b wild6_iax2l
                              of wild7_00 {
                              } } in
                        join {
                          exit1_X26 [Dmd=<L,C(C1(U(U,U)))>]
                            :: Int -> Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(2)], Arity=2, Str=<B,U><B,U>b]
                          exit1_X26 (wild5_saJ0b [OS=OneShot]
                                       :: Int
                                       Unf=OtherCon [])
                                    (wild6_iax2l [OS=OneShot] :: Int)
                            = case lvl14_raLJC wild3_saLgo wild5_saJ0b wild6_iax2l
                              of wild7_00 {
                              } } in
                        join {
                          exit2_X2n [Dmd=<L,C(U(U,U))>] :: Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(1)], Arity=1, Str=<B,U>b]
                          exit2_X2n (wild5_iax2l [OS=OneShot] :: Int)
                            = case lvl15_raLJD u2_saIYf wild5_iax2l of wild6_00 { } } in
                        join {
                          exit3_X2p [Dmd=<L,C(U(U,U))>] :: Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(1)], Arity=1, Str=<B,U>b]
                          exit3_X2p (wild5_iax2l [OS=OneShot] :: Int)
                            = case lvl15_raLJD u2_saIYf wild5_iax2l of wild6_00 { } } in
                        join {
                          exit4_X2m [Dmd=<L,C(U(U,U))>] :: Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(1)], Arity=1, Str=<B,U>b]
                          exit4_X2m (wild5_iax2l [OS=OneShot] :: Int)
                            = case lvl15_raLJD u2_saIYf wild5_iax2l of wild6_00 { } } in
                        join {
                          exit5_X2o [Dmd=<L,C(U(U,U))>] :: Int -> (# State# RealWorld, () #)
                          [LclId[JoinId(1)], Arity=1, Str=<B,U>b]
                          exit5_X2o (wild5_iax2l [OS=OneShot] :: Int)
                            = case lvl15_raLJD u2_saIYf wild5_iax2l of wild6_00 { } } in
                        joinrec {
                          go1_saJQP [Occ=LoopBreaker]
                            :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
                          [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
                          go1_saJQP (x2_i819P :: Int#) (eta_B1 :: State# RealWorld)
                            = let {
                                wild5_iax2l [Dmd=<L,U(U)>] :: Int
                                [LclId, Unf=OtherCon []]
                                wild5_iax2l = GHC.Types.I# x2_i819P } in
                              case <=# m_saLgy x2_i819P of {
                                __DEFAULT -> jump exit_X24 wild4_saLgx wild5_iax2l;
                                1# ->
                                  case <=# x2_i819P x_saLgp of {
                                    __DEFAULT -> jump exit1_X26 wild4_saLgx wild5_iax2l;
                                    1# ->
                                      case readArray#
                                             @ RealWorld
                                             @ (Maybe (ThreadId, EventManager))
                                             ds5_i80pw
                                             (-# x2_i819P m_saLgy)
                                             eta_B1
                                      of
                                      { (# ipv8_X7ICy, ipv9_X7ICA #) ->
                                      case ipv9_X7ICA of wild6_Xy {
                                        Nothing -> lvl13_raLJB ipv8_X7ICy;
                                        Just ds_daIhJ ->
                                          case ds_daIhJ of { (tid_aaHXO, mgr_aaHXP) ->
                                          case ipv3_X7IBV of { I# y1_XlRh ->
                                          case <# x2_i819P y1_XlRh of {
                                            __DEFAULT ->
                                              case restartPollLoop_raLJq
                                                     mgr_aaHXP wild5_iax2l ipv8_X7ICy
                                              of
                                              { (# ipv10_X7ICS, ipv11_X7ICU #) ->
                                              case <=# 0# x2_i819P of {
                                                __DEFAULT -> jump exit2_X2n wild5_iax2l;
                                                1# ->
                                                  case <=# x2_i819P u1_saJ5D of {
                                                    __DEFAULT -> jump exit3_X2p wild5_iax2l;
                                                    1# ->
                                                      case writeArray#
                                                             @ RealWorld
                                                             @ (Maybe (ThreadId, EventManager))
                                                             ipv7_iamtR
                                                             x2_i819P
                                                             (GHC.Base.Just
                                                                @ (ThreadId, EventManager)
                                                                (ipv11_X7ICU, mgr_aaHXP))
                                                             ipv10_X7ICS
                                                      of s2#1_i80pX
                                                      { __DEFAULT ->
                                                      case ==# x2_i819P x_saLgp of {
                                                        __DEFAULT ->
                                                          jump go1_saJQP
                                                            (+# x2_i819P 1#) s2#1_i80pX;
                                                        1# -> jump $w$j_saKNN s2#1_i80pX
                                                      }
                                                      }
                                                  }
                                              }
                                              };
                                            1# ->
                                              case <=# 0# x2_i819P of {
                                                __DEFAULT -> jump exit4_X2m wild5_iax2l;
                                                1# ->
                                                  case <=# x2_i819P u1_saJ5D of {
                                                    __DEFAULT -> jump exit5_X2o wild5_iax2l;
                                                    1# ->
                                                      case writeArray#
                                                             @ RealWorld
                                                             @ (Maybe (ThreadId, EventManager))
                                                             ipv7_iamtR
                                                             x2_i819P
                                                             wild6_Xy
                                                             ipv8_X7ICy
                                                      of s2#1_i80pX
                                                      { __DEFAULT ->
                                                      case ==# x2_i819P x_saLgp of {
                                                        __DEFAULT ->
                                                          jump go1_saJQP
                                                            (+# x2_i819P 1#) s2#1_i80pX;
                                                        1# -> jump $w$j_saKNN s2#1_i80pX
                                                      }
                                                      }
                                                  }
                                              }
                                          }
                                          }
                                          }
                                      }
                                      }
                                  }
                              }; } in
                        jump go1_saJQP 0# ipv6_iamtQ;
                      1# -> jump $w$j_saKNN ipv6_iamtQ
                    }
                    };
                  1# -> case GHC.Arr.negRange of wild5_00 { }
                } } in
          case <=# 0# u1_saJ5D of {
            __DEFAULT -> jump $j_saJwc 0#;
            1# -> jump $j_saJwc (+# u1_saJ5D 1#)
          }
      }
      }
      }
      }
      }
      }
      }
      }
      }
      }

-- RHS size: {terms: 4, types: 3, coercions: 0, joins: 0/0}
GHC.Event.Thread.ioManagerCapabilitiesChanged2 [InlPrag=NOUSERINLINE[0]]
  :: () -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<L,A><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=True)
         Tmpl= \ _ [Occ=Dead] (w1_saKNS [Occ=Once] :: State# RealWorld) ->
                 GHC.Event.Thread.$wioManagerCapabilitiesChanged w1_saKNS}]
GHC.Event.Thread.ioManagerCapabilitiesChanged2
  = \ _ [Occ=Dead] (w1_saKNS :: State# RealWorld) ->
      GHC.Event.Thread.$wioManagerCapabilitiesChanged w1_saKNS

-- RHS size: {terms: 8, types: 9, coercions: 5, joins: 0/0}
GHC.Event.Thread.ioManagerCapabilitiesChanged1
  :: State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w2_iaiAL [Occ=Once] :: State# RealWorld) ->
                 case ioManagerLock of { GHC.MVar.MVar ww1_iaiAR [Occ=Once] ->
                 GHC.Conc.Sync.$wwithMVar
                   @ ()
                   @ ()
                   ww1_iaiAR
                   (GHC.Event.Thread.ioManagerCapabilitiesChanged2
                    `cast` (<()>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                            :: (() -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                               ~R# (() -> IO () :: *)))
                   w2_iaiAL
                 }}]
GHC.Event.Thread.ioManagerCapabilitiesChanged1
  = \ (w2_iaiAL :: State# RealWorld) ->
      case ioManagerLock of { GHC.MVar.MVar ww1_iaiAR ->
      GHC.Conc.Sync.$wwithMVar
        @ ()
        @ ()
        ww1_iaiAR
        (GHC.Event.Thread.ioManagerCapabilitiesChanged2
         `cast` (<()>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                 :: (() -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                    ~R# (() -> IO () :: *)))
        w2_iaiAL
      }

-- RHS size: {terms: 1, types: 0, coercions: 3, joins: 0/0}
ioManagerCapabilitiesChanged :: IO ()
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.ioManagerCapabilitiesChanged1
               `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (IO () :: *))}]
ioManagerCapabilitiesChanged
  = GHC.Event.Thread.ioManagerCapabilitiesChanged1
    `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
            :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (IO () :: *))

-- RHS size: {terms: 10, types: 5, coercions: 0, joins: 0/0}
GHC.Event.Thread.getSystemEventManager2
  :: Int -> Int -> Int# -> Int
[GblId, Arity=3, Str=<B,U><B,U><B,U>x, Unf=OtherCon []]
GHC.Event.Thread.getSystemEventManager2
  = \ (u_i80qd :: Int) (l_i80qc :: Int) (ipv2_iaIvu :: Int#) ->
      GHC.Arr.$windexError
        @ Int
        @ Int
        GHC.Show.$fShowInt
        l_i80qc
        u_i80qd
        (GHC.Types.I# ipv2_iaIvu)
        lvl4_raLJs

-- RHS size: {terms: 67, types: 139, coercions: 13, joins: 0/0}
GHC.Event.Thread.getSystemEventManager1
  :: State# RealWorld -> (# State# RealWorld, Maybe EventManager #)
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0] 229 30}]
GHC.Event.Thread.getSystemEventManager1
  = \ (s_X7IBJ :: State# RealWorld) ->
      case myThreadId# s_X7IBJ of { (# ipv_ia56z, ipv1_ia56A #) ->
      case threadStatus# ipv1_ia56A ipv_ia56z of
      { (# ipv2_iaIvs, ipv3_iaIvt, ipv4_iaIvu, ipv5_iaIvv #) ->
      case eventManager
           `cast` (GHC.IORef.N:IORef[0] <IOArray
                                           Int (Maybe (ThreadId, EventManager))>_N
                   :: (IORef (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                      ~R# (GHC.STRef.STRef
                             RealWorld (IOArray Int (Maybe (ThreadId, EventManager))) :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar#
             @ RealWorld
             @ (IOArray Int (Maybe (ThreadId, EventManager)))
             var#_i7IB3
             ipv2_iaIvs
      of
      { (# ipv6_X7IC6, ipv7_X7IC8 #) ->
      case ipv7_X7IC8
           `cast` (GHC.IOArray.N:IOArray[0] <Int>_N <Maybe
                                                       (ThreadId, EventManager)>_N
                   :: (IOArray Int (Maybe (ThreadId, EventManager)) :: *)
                      ~R# (GHC.Arr.STArray
                             RealWorld Int (Maybe (ThreadId, EventManager)) :: *))
      of
      { GHC.Arr.STArray l_i80qc u_i80qd dt_i80qe ds3_i80qf ->
      case l_i80qc of wild2_saLgL { I# m_saLgM ->
      case u_i80qd of wild3_saLgO { I# n_saLgP ->
      case <=# m_saLgM ipv4_iaIvu of {
        __DEFAULT ->
          case GHC.Event.Thread.getSystemEventManager2
                 wild3_saLgO wild2_saLgL ipv4_iaIvu
          of wild4_00 {
          };
        1# ->
          case <=# ipv4_iaIvu n_saLgP of {
            __DEFAULT ->
              case GHC.Event.Thread.getSystemEventManager2
                     wild3_saLgO wild2_saLgL ipv4_iaIvu
              of wild4_00 {
              };
            1# ->
              case readArray#
                     @ RealWorld
                     @ (Maybe (ThreadId, EventManager))
                     ds3_i80qf
                     (-# ipv4_iaIvu m_saLgM)
                     ipv6_X7IC6
              of
              { (# ipv8_X7ICb, ipv9_X7ICd #) ->
              (# ipv8_X7ICb,
                 case ipv9_X7ICd of {
                   Nothing -> GHC.Base.Nothing @ EventManager;
                   Just a1_iaIvW ->
                     GHC.Base.Just
                       @ EventManager (snd @ ThreadId @ EventManager a1_iaIvW)
                 } #)
              }
          }
      }
      }
      }
      }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 4, joins: 0/0}
getSystemEventManager :: IO (Maybe EventManager)
[GblId,
 Arity=1,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.getSystemEventManager1
               `cast` (Sym (GHC.Types.N:IO[0] <Maybe EventManager>_R)
                       :: (State# RealWorld
                           -> (# State# RealWorld, Maybe EventManager #) :: *)
                          ~R# (IO (Maybe EventManager) :: *))}]
getSystemEventManager
  = GHC.Event.Thread.getSystemEventManager1
    `cast` (Sym (GHC.Types.N:IO[0] <Maybe EventManager>_R)
            :: (State# RealWorld
                -> (# State# RealWorld, Maybe EventManager #) :: *)
               ~R# (IO (Maybe EventManager) :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl16_raLJE :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl16_raLJE = "threadWaitSTM"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl17_raLJF :: [Char]
[GblId]
lvl17_raLJF = unpackCString# lvl16_raLJE

-- RHS size: {terms: 5, types: 2, coercions: 0, joins: 0/0}
lvl18_raLJG :: GHC.IO.Exception.IOError
[GblId]
lvl18_raLJG
  = Foreign.C.Error.$werrnoToIOError
      lvl17_raLJF
      9#
      (GHC.Base.Nothing @ GHC.IO.Handle.Types.Handle)
      (GHC.Base.Nothing @ String)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl19_raLJH :: SomeException
[GblId]
lvl19_raLJH
  = GHC.IO.Exception.$fExceptionIOException_$ctoException lvl18_raLJG

-- RHS size: {terms: 3, types: 2, coercions: 0, joins: 0/0}
lvl20_raLJI :: (Bool, Bool)
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl20_raLJI = (GHC.Types.False, GHC.Types.True)

-- RHS size: {terms: 3, types: 2, coercions: 0, joins: 0/0}
lvl21_raLJJ :: (Bool, Bool)
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl21_raLJJ = (GHC.Types.False, GHC.Types.False)

-- RHS size: {terms: 3, types: 2, coercions: 0, joins: 0/0}
lvl22_raLJK :: (Bool, Bool)
[GblId, Caf=NoCafRefs, Str=m, Unf=OtherCon []]
lvl22_raLJK = (GHC.Types.True, GHC.Types.True)

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl23_raLJL :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl23_raLJL
  = "Pattern match failure in do expression at GHC/Event/Thread.hs:183:3-10"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
lvl24_raLJM
  :: State# RealWorld -> (# State# RealWorld, EventManager #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
lvl24_raLJM
  = \ (eta_B1 :: State# RealWorld) ->
      GHC.IO.failIO1 @ EventManager (unpackCString# lvl23_raLJL) eta_B1

-- RHS size: {terms: 709, types: 1,271, coercions: 52, joins: 2/12}
GHC.Event.Thread.threadWaitReadSTM1
  :: Event
     -> Fd
     -> State# RealWorld
     -> (# State# RealWorld, (STM (), IO ()) #)
[GblId, Arity=3, Str=<L,U(U)><L,U(U)><S,U>, Unf=OtherCon []]
GHC.Event.Thread.threadWaitReadSTM1
  = \ (evt_aaHWW :: Event)
      (fd_aaHWX :: Fd)
      (eta_X11 :: State# RealWorld) ->
      case getMaskingState# eta_X11 of { (# ipv_ia56X, ipv1_ia56Y #) ->
      let {
        io_saIXJ [Dmd=<C(S),C(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, (STM (), IO ()) #)
        [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
        io_saIXJ
          = \ (s_X7IBS :: State# RealWorld) ->
              case newTVar#
                     @ (Maybe Event) @ RealWorld (GHC.Base.Nothing @ Event) s_X7IBS
              of
              { (# ipv2_iaIwd, ipv3_iaIwe #) ->
              case GHC.Event.Thread.getSystemEventManager1 ipv2_iaIwd of
              { (# ipv4_X7IC4, ipv5_X7IC6 #) ->
              case ipv5_X7IC6 of {
                Nothing -> case lvl24_raLJM ipv4_X7IC4 of wild1_00 { };
                Just mgr_aaHX9 ->
                  case mgr_aaHX9 of wild1_X4a
                  { GHC.Event.Manager.EventManager ds3_dawQk dt_dawXe dt1_dawXf
                                                   dt2_dawXg dt3_dawXh dt4_dawXi dt5_dawXj dt6_dawXk
                                                   dt7_dawXl dt8_dawXm dt9_dawXn dt10_dawXo
                                                   dt11_dawXp ->
                  case dt_dawXe of wild2_saLgZ { I# m1_saLh0 ->
                  case dt1_dawXf of wild3_saLh2 { I# n_saLh3 ->
                  case ds3_dawQk of
                  { GHC.Event.Internal.Backend @ a_saLh6 bState_saLh7 ds4_saLh8
                                               bModifyFd_saLh9 ds5_saLha ds6_saLhb ->
                  case fetchAddIntArray# @ RealWorld dt5_dawXj 0# 1# ipv4_X7IC4 of
                  { (# ipv6_iariL, ipv7_iariM #) ->
                  case fd_aaHWX
                       `cast` (System.Posix.Types.N:Fd[0] ; Foreign.C.Types.N:CInt[0]
                               :: (Fd :: *) ~R# (GHC.Int.Int32 :: *))
                  of dt16_aawmO
                  { GHC.Int.I32# dt17_aawmP ->
                  case evt_aaHWW
                       `cast` (GHC.Event.Internal.N:Event[0]
                               :: (Event :: *) ~R# (Int :: *))
                  of dt18_aawnz
                  { I# dt19_aawnA ->
                  case getMaskingState# ipv6_iariL of
                  { (# ipv8_iafMW, ipv9_iafMX #) ->
                  let {
                    i1_saIXZ [Dmd=<S,U>] :: Int#
                    [LclId]
                    i1_saIXZ = andI# dt17_aawmP 31# } in
                  case <=# m1_saLh0 i1_saIXZ of {
                    __DEFAULT ->
                      case GHC.Event.Thread.getSystemEventManager2
                             wild3_saLh2 wild2_saLgZ i1_saIXZ
                      of wild4_00 {
                      };
                    1# ->
                      case <=# i1_saIXZ n_saLh3 of {
                        __DEFAULT ->
                          case GHC.Event.Thread.getSystemEventManager2
                                 wild3_saLh2 wild2_saLgZ i1_saIXZ
                          of wild4_00 {
                          };
                        1# ->
                          case indexArray#
                                 @ (MVar (GHC.Event.IntTable.IntTable [M.FdData]))
                                 dt3_dawXh
                                 (-# i1_saIXZ m1_saLh0)
                          of
                          { (# ipv10_iawOK #) ->
                          case ipv10_iawOK of { GHC.MVar.MVar ww1_saKOd ->
                          let {
                            $wio_saKOa [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(C1(U(U,U)))>]
                              :: MutVar# RealWorld (GHC.Event.IntTable.IT [M.FdData])
                                 -> State# RealWorld -> (# State# RealWorld, (Bool, Bool) #)
                            [LclId, Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
                            $wio_saKOa
                              = \ (ww2_saKO8 [OS=OneShot]
                                     :: MutVar# RealWorld (GHC.Event.IntTable.IT [M.FdData]))
                                  (w_saKO5 [OS=OneShot] :: State# RealWorld) ->
                                  let {
                                    lvl31_saJqf
                                      :: M.FdKey
                                         -> Event -> State# RealWorld -> (# State# RealWorld, () #)
                                    [LclId,
                                     Arity=3,
                                     Str=<L,A><L,U><S,U>,
                                     Unf=Unf{Src=InlineStable, TopLvl=False, Value=True,
                                             ConLike=True, WorkFree=True, Expandable=True,
                                             Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
                                             Tmpl= \ _ [Occ=Dead]
                                                     (e_aaHX0 [Occ=Once] :: Event)
                                                     (eta1_X1E [Occ=Once] :: State# RealWorld) ->
                                                     atomically#
                                                       @ ()
                                                       (\ (eta2_iaIwq [Occ=Once, OS=OneShot]
                                                             :: State# RealWorld) ->
                                                          case writeTVar#
                                                                 @ RealWorld
                                                                 @ (Maybe Event)
                                                                 ipv3_iaIwe
                                                                 (GHC.Base.Just @ Event e_aaHX0)
                                                                 eta2_iaIwq
                                                          of s2#_iaIwv
                                                          { __DEFAULT ->
                                                          (# s2#_iaIwv, GHC.Tuple.() #)
                                                          })
                                                       eta1_X1E}]
                                    lvl31_saJqf
                                      = \ _ [Occ=Dead]
                                          (e_aaHX0 :: Event)
                                          (eta1_X1E :: State# RealWorld) ->
                                          atomically#
                                            @ ()
                                            (\ (eta2_iaIwq [OS=OneShot] :: State# RealWorld) ->
                                               case writeTVar#
                                                      @ RealWorld
                                                      @ (Maybe Event)
                                                      ipv3_iaIwe
                                                      (GHC.Base.Just @ Event e_aaHX0)
                                                      eta2_iaIwq
                                               of s2#_iaIwv
                                               { __DEFAULT ->
                                               (# s2#_iaIwv, GHC.Tuple.() #)
                                               })
                                            eta1_X1E } in
                                  case GHC.Event.IntTable.$winsertWith
                                         @ [M.FdData]
                                         (++ @ M.FdData)
                                         dt17_aawmP
                                         (GHC.Types.:
                                            @ M.FdData
                                            (GHC.Event.Manager.FdData
                                               dt17_aawmP
                                               ipv7_iariM
                                               dt19_aawnA
                                               (lvl31_saJqf
                                                `cast` (<M.FdKey>_R
                                                        ->_R <Event>_R
                                                        ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                                        :: (M.FdKey
                                                            -> Event
                                                            -> State# RealWorld
                                                            -> (# State# RealWorld, () #) :: *)
                                                           ~R# (M.FdKey -> Event -> IO () :: *))))
                                            (GHC.Types.[] @ M.FdData))
                                         ww2_saKO8
                                         w_saKO5
                                  of
                                  { (# ipv11_X7IFr, ipv12_X7IFt #) ->
                                  join {
                                    $j_saIXT [Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
                                      :: Int# -> Int -> (# State# RealWorld, (Bool, Bool) #)
                                    [LclId[JoinId(2)],
                                     Arity=2,
                                     Str=<S,U><S,1*U(U)>,
                                     Unf=OtherCon []]
                                    $j_saIXT (x#_i7Vds [OS=OneShot] :: Int#)
                                             (wild4_i7Vdq [OS=OneShot]
                                                :: Int
                                                Unf=OtherCon [])
                                      = case wild4_i7Vdq of { I# x_saLhe ->
                                        let {
                                          x#1_saIXV [Dmd=<S,U>] :: Int#
                                          [LclId]
                                          x#1_saIXV = orI# x#_i7Vds dt19_aawnA } in
                                        case andI# x#1_saIXV 8# of {
                                          __DEFAULT ->
                                            case /=# x_saLhe x#1_saIXV of {
                                              __DEFAULT -> (# ipv11_X7IFr, lvl20_raLJI #);
                                              1# ->
                                                case ((bModifyFd_saLh9
                                                         bState_saLh7
                                                         (dt16_aawmO
                                                          `cast` (Sym (Foreign.C.Types.N:CInt[0]) ; Sym (System.Posix.Types.N:Fd[0])
                                                                  :: (GHC.Int.Int32 :: *)
                                                                     ~R# (Fd :: *)))
                                                         ((GHC.Types.I# (andI# x#_i7Vds 7#))
                                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                                  :: (Int :: *) ~R# (Event :: *)))
                                                         ((GHC.Types.I# (andI# x#1_saIXV 7#))
                                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                                  :: (Int :: *) ~R# (Event :: *))))
                                                      `cast` (GHC.Types.N:IO[0] <Bool>_R
                                                              :: (IO Bool :: *)
                                                                 ~R# (State# RealWorld
                                                                      -> (# State# RealWorld,
                                                                            Bool #) :: *)))
                                                       ipv11_X7IFr
                                                of
                                                { (# ipv13_X7IFI, ipv14_X7IFK #) ->
                                                case ipv14_X7IFK of {
                                                  False ->
                                                    case ipv12_X7IFt of {
                                                      Nothing ->
                                                        case readMutVar#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.IT [M.FdData])
                                                               ww2_saKO8
                                                               ipv13_X7IFI
                                                        of
                                                        { (# ipv15_iayE8, ipv16_iayE9 #) ->
                                                        case ipv16_iayE9 of
                                                        { GHC.Event.IntTable.IT dt20_iayEe
                                                                                dt21_iayEf
                                                                                dt22_iayEg ->
                                                        let {
                                                          n#_iayEd [Dmd=<S,U>] :: Int#
                                                          [LclId]
                                                          n#_iayEd
                                                            = andI#
                                                                dt17_aawmP
                                                                (-#
                                                                   (sizeofMutableArray#
                                                                      @ RealWorld
                                                                      @ (GHC.Event.IntTable.Bucket
                                                                           [M.FdData])
                                                                      dt20_iayEe)
                                                                   1#) } in
                                                        case readArray#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.Bucket
                                                                    [M.FdData])
                                                               dt20_iayEe
                                                               n#_iayEd
                                                               ipv15_iayE8
                                                        of
                                                        { (# ipv17_iayEm, ipv18_iayEn #) ->
                                                        letrec {
                                                          $wgo_iayEk [InlPrag=NOUSERINLINE[0],
                                                                      Occ=LoopBreaker]
                                                            :: GHC.Event.IntTable.Bucket [M.FdData]
                                                               -> (# Bool, Maybe [M.FdData],
                                                                     GHC.Event.IntTable.Bucket
                                                                       [M.FdData] #)
                                                          [LclId,
                                                           Arity=1,
                                                           Str=<S,1*U>,
                                                           Unf=OtherCon []]
                                                          $wgo_iayEk
                                                            = \ (w2_iayEl
                                                                   :: GHC.Event.IntTable.Bucket
                                                                        [M.FdData]) ->
                                                                case w2_iayEl of {
                                                                  GHC.Event.IntTable.Empty ->
                                                                    (# GHC.Types.False,
                                                                       GHC.Base.Nothing
                                                                         @ [M.FdData],
                                                                       GHC.Event.IntTable.Empty
                                                                         @ [M.FdData] #);
                                                                  GHC.Event.IntTable.Bucket dt23_iayEs
                                                                                            ds14_iayEt
                                                                                            ds15_iayEu ->
                                                                    case ==# dt23_iayEs dt17_aawmP
                                                                    of {
                                                                      __DEFAULT ->
                                                                        case $wgo_iayEk ds15_iayEu
                                                                        of
                                                                        { (# ww4_iayEz, ww5_iayEA,
                                                                             ww6_iayEB #) ->
                                                                        (# ww4_iayEz, ww5_iayEA,
                                                                           GHC.Event.IntTable.Bucket
                                                                             @ [M.FdData]
                                                                             dt23_iayEs
                                                                             ds14_iayEt
                                                                             ww6_iayEB #)
                                                                        };
                                                                      1# ->
                                                                        (# GHC.Types.True,
                                                                           GHC.Base.Just
                                                                             @ [M.FdData]
                                                                             ds14_iayEt,
                                                                           ds15_iayEu #)
                                                                    }
                                                                }; } in
                                                        case $wgo_iayEk ipv18_iayEn of
                                                        { (# ww4_iayEF, ww5_iayEG, ww6_iayEH #) ->
                                                        case ww5_iayEG of {
                                                          Nothing -> (# ipv17_iayEm, lvl21_raLJJ #);
                                                          Just ipv19_iayEN ->
                                                            case writeArray#
                                                                   @ RealWorld
                                                                   @ (GHC.Event.IntTable.Bucket
                                                                        [M.FdData])
                                                                   dt20_iayEe
                                                                   n#_iayEd
                                                                   ww6_iayEH
                                                                   ipv17_iayEm
                                                            of s1#_iayEP
                                                            { __DEFAULT ->
                                                            case ww4_iayEF of {
                                                              False -> (# s1#_iayEP, lvl21_raLJJ #);
                                                              True ->
                                                                case readIntOffAddr#
                                                                       @ RealWorld
                                                                       dt21_iayEf
                                                                       0#
                                                                       s1#_iayEP
                                                                of
                                                                { (# ipv20_iayEX, ipv21_iayEY #) ->
                                                                case writeIntOffAddr#
                                                                       @ RealWorld
                                                                       dt21_iayEf
                                                                       0#
                                                                       (-# ipv21_iayEY 1#)
                                                                       ipv20_iayEX
                                                                of s2_iayF0
                                                                { __DEFAULT ->
                                                                case touch#
                                                                       @ 'LiftedRep
                                                                       @ GHC.ForeignPtr.ForeignPtrContents
                                                                       dt22_iayEg
                                                                       s2_iayF0
                                                                of s'_iayF1
                                                                { __DEFAULT ->
                                                                (# s'_iayF1, lvl21_raLJJ #)
                                                                }
                                                                }
                                                                }
                                                            }
                                                            }
                                                        }
                                                        }
                                                        }
                                                        }
                                                        };
                                                      Just v_iayF3 ->
                                                        case GHC.Event.IntTable.$winsertWith
                                                               @ [M.FdData]
                                                               (const @ [M.FdData] @ [M.FdData])
                                                               dt17_aawmP
                                                               v_iayF3
                                                               ww2_saKO8
                                                               ipv13_X7IFI
                                                        of
                                                        { (# ipv15_iayF7, ipv16_iayF8 #) ->
                                                        (# ipv15_iayF7, lvl21_raLJJ #)
                                                        }
                                                    };
                                                  True -> (# ipv13_X7IFI, lvl22_raLJK #)
                                                }
                                                }
                                            };
                                          0# ->
                                            case ((ds5_saLha
                                                     bState_saLh7
                                                     (dt16_aawmO
                                                      `cast` (Sym (Foreign.C.Types.N:CInt[0]) ; Sym (System.Posix.Types.N:Fd[0])
                                                              :: (GHC.Int.Int32 :: *)
                                                                 ~R# (Fd :: *)))
                                                     ((GHC.Types.I# (andI# x#1_saIXV 7#))
                                                      `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                              :: (Int :: *) ~R# (Event :: *))))
                                                  `cast` (GHC.Types.N:IO[0] <Bool>_R
                                                          :: (IO Bool :: *)
                                                             ~R# (State# RealWorld
                                                                  -> (# State# RealWorld,
                                                                        Bool #) :: *)))
                                                   ipv11_X7IFr
                                            of
                                            { (# ipv13_X7IFJ, ipv14_X7IFL #) ->
                                            case ipv14_X7IFL of {
                                              False ->
                                                case ipv12_X7IFt of {
                                                  Nothing ->
                                                    case readMutVar#
                                                           @ RealWorld
                                                           @ (GHC.Event.IntTable.IT [M.FdData])
                                                           ww2_saKO8
                                                           ipv13_X7IFJ
                                                    of
                                                    { (# ipv15_iayE8, ipv16_iayE9 #) ->
                                                    case ipv16_iayE9 of
                                                    { GHC.Event.IntTable.IT dt20_iayEe dt21_iayEf
                                                                            dt22_iayEg ->
                                                    let {
                                                      n#_iayEd [Dmd=<S,U>] :: Int#
                                                      [LclId]
                                                      n#_iayEd
                                                        = andI#
                                                            dt17_aawmP
                                                            (-#
                                                               (sizeofMutableArray#
                                                                  @ RealWorld
                                                                  @ (GHC.Event.IntTable.Bucket
                                                                       [M.FdData])
                                                                  dt20_iayEe)
                                                               1#) } in
                                                    case readArray#
                                                           @ RealWorld
                                                           @ (GHC.Event.IntTable.Bucket [M.FdData])
                                                           dt20_iayEe
                                                           n#_iayEd
                                                           ipv15_iayE8
                                                    of
                                                    { (# ipv17_iayEm, ipv18_iayEn #) ->
                                                    letrec {
                                                      $wgo_iayEk [InlPrag=NOUSERINLINE[0],
                                                                  Occ=LoopBreaker]
                                                        :: GHC.Event.IntTable.Bucket [M.FdData]
                                                           -> (# Bool, Maybe [M.FdData],
                                                                 GHC.Event.IntTable.Bucket
                                                                   [M.FdData] #)
                                                      [LclId, Arity=1, Str=<S,1*U>, Unf=OtherCon []]
                                                      $wgo_iayEk
                                                        = \ (w2_iayEl
                                                               :: GHC.Event.IntTable.Bucket
                                                                    [M.FdData]) ->
                                                            case w2_iayEl of {
                                                              GHC.Event.IntTable.Empty ->
                                                                (# GHC.Types.False,
                                                                   GHC.Base.Nothing @ [M.FdData],
                                                                   GHC.Event.IntTable.Empty
                                                                     @ [M.FdData] #);
                                                              GHC.Event.IntTable.Bucket dt23_iayEs
                                                                                        ds14_iayEt
                                                                                        ds15_iayEu ->
                                                                case ==# dt23_iayEs dt17_aawmP of {
                                                                  __DEFAULT ->
                                                                    case $wgo_iayEk ds15_iayEu of
                                                                    { (# ww4_iayEz, ww5_iayEA,
                                                                         ww6_iayEB #) ->
                                                                    (# ww4_iayEz, ww5_iayEA,
                                                                       GHC.Event.IntTable.Bucket
                                                                         @ [M.FdData]
                                                                         dt23_iayEs
                                                                         ds14_iayEt
                                                                         ww6_iayEB #)
                                                                    };
                                                                  1# ->
                                                                    (# GHC.Types.True,
                                                                       GHC.Base.Just
                                                                         @ [M.FdData] ds14_iayEt,
                                                                       ds15_iayEu #)
                                                                }
                                                            }; } in
                                                    case $wgo_iayEk ipv18_iayEn of
                                                    { (# ww4_iayEF, ww5_iayEG, ww6_iayEH #) ->
                                                    case ww5_iayEG of {
                                                      Nothing -> (# ipv17_iayEm, lvl21_raLJJ #);
                                                      Just ipv19_iayEN ->
                                                        case writeArray#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.Bucket
                                                                    [M.FdData])
                                                               dt20_iayEe
                                                               n#_iayEd
                                                               ww6_iayEH
                                                               ipv17_iayEm
                                                        of s1#_iayEP
                                                        { __DEFAULT ->
                                                        case ww4_iayEF of {
                                                          False -> (# s1#_iayEP, lvl21_raLJJ #);
                                                          True ->
                                                            case readIntOffAddr#
                                                                   @ RealWorld
                                                                   dt21_iayEf
                                                                   0#
                                                                   s1#_iayEP
                                                            of
                                                            { (# ipv20_iayEX, ipv21_iayEY #) ->
                                                            case writeIntOffAddr#
                                                                   @ RealWorld
                                                                   dt21_iayEf
                                                                   0#
                                                                   (-# ipv21_iayEY 1#)
                                                                   ipv20_iayEX
                                                            of s2_iayF0
                                                            { __DEFAULT ->
                                                            case touch#
                                                                   @ 'LiftedRep
                                                                   @ GHC.ForeignPtr.ForeignPtrContents
                                                                   dt22_iayEg
                                                                   s2_iayF0
                                                            of s'_iayF1
                                                            { __DEFAULT ->
                                                            (# s'_iayF1, lvl21_raLJJ #)
                                                            }
                                                            }
                                                            }
                                                        }
                                                        }
                                                    }
                                                    }
                                                    }
                                                    }
                                                    };
                                                  Just v_iayF3 ->
                                                    case GHC.Event.IntTable.$winsertWith
                                                           @ [M.FdData]
                                                           (const @ [M.FdData] @ [M.FdData])
                                                           dt17_aawmP
                                                           v_iayF3
                                                           ww2_saKO8
                                                           ipv13_X7IFJ
                                                    of
                                                    { (# ipv15_iayF7, ipv16_iayF8 #) ->
                                                    (# ipv15_iayF7, lvl21_raLJJ #)
                                                    }
                                                };
                                              True -> (# ipv13_X7IFJ, lvl20_raLJI #)
                                            }
                                            }
                                        }
                                        } } in
                                  case ipv12_X7IFt of {
                                    Nothing ->
                                      jump $j_saIXT 0# GHC.Event.Internal.$fMonoidEventLifetime1;
                                    Just x1_i8O4S ->
                                      case GHC.Event.Manager.$weventsOf x1_i8O4S of ww3_sazrd
                                      { __DEFAULT ->
                                      jump $j_saIXT ww3_sazrd (GHC.Types.I# ww3_sazrd)
                                      }
                                  }
                                  } } in
                          let {
                            io1_saIXO [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(C1(U))>]
                              :: GHC.Event.IntTable.IntTable [M.FdData]
                                 -> State# RealWorld -> (# State# RealWorld, (Bool, Bool) #)
                            [LclId,
                             Arity=2,
                             Str=<S(S),1*U(U)><S,U>,
                             Unf=Unf{Src=InlineStable, TopLvl=False, Value=True, ConLike=True,
                                     WorkFree=True, Expandable=True,
                                     Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
                                     Tmpl= \ (w_saKO4 [Occ=Once]
                                                :: GHC.Event.IntTable.IntTable [M.FdData])
                                             (w1_saKO5 [Occ=Once] :: State# RealWorld) ->
                                             case w_saKO4
                                                  `cast` (GHC.Event.IntTable.N:IntTable[0]
                                                              <[M.FdData]>_R ; GHC.IORef.N:IORef[0] <GHC.Event.IntTable.IT
                                                                                                       [M.FdData]>_N
                                                          :: (GHC.Event.IntTable.IntTable
                                                                [M.FdData] :: *)
                                                             ~R# (GHC.STRef.STRef
                                                                    RealWorld
                                                                    (GHC.Event.IntTable.IT
                                                                       [M.FdData]) :: *))
                                             of
                                             { GHC.STRef.STRef ww3_saKO8 [Occ=Once] ->
                                             $wio_saKOa ww3_saKO8 w1_saKO5
                                             }}]
                            io1_saIXO
                              = \ (w_saKO4 [OS=OneShot]
                                     :: GHC.Event.IntTable.IntTable [M.FdData])
                                  (w1_saKO5 [OS=OneShot] :: State# RealWorld) ->
                                  case w_saKO4
                                       `cast` (GHC.Event.IntTable.N:IntTable[0]
                                                   <[M.FdData]>_R ; GHC.IORef.N:IORef[0] <GHC.Event.IntTable.IT
                                                                                            [M.FdData]>_N
                                               :: (GHC.Event.IntTable.IntTable [M.FdData] :: *)
                                                  ~R# (GHC.STRef.STRef
                                                         RealWorld
                                                         (GHC.Event.IntTable.IT [M.FdData]) :: *))
                                  of
                                  { GHC.STRef.STRef ww3_saKO8 ->
                                  $wio_saKOa ww3_saKO8 w1_saKO5
                                  } } in
                          join {
                            $j_saJ7d [Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
                              :: State# RealWorld
                                 -> M.FdKey -> (# State# RealWorld, (STM (), IO ()) #)
                            [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U(U,U)>, Unf=OtherCon []]
                            $j_saJ7d (ipv11_X7ICg [OS=OneShot] :: State# RealWorld)
                                     (ipv12_X7ICi [OS=OneShot] :: M.FdKey)
                              = (# ipv11_X7ICg,
                                   ((\ (s1_iaIxO :: State# RealWorld) ->
                                       case readTVar#
                                              @ RealWorld @ (Maybe Event) ipv3_iaIwe s1_iaIxO
                                       of
                                       { (# ipv13_iaIxR, ipv14_iaIxS #) ->
                                       case ipv14_iaIxS of {
                                         Nothing -> retry# @ () ipv13_iaIxR;
                                         Just evt'_aaHX4 ->
                                           case evt'_aaHX4
                                                `cast` (GHC.Event.Internal.N:Event[0]
                                                        :: (Event :: *) ~R# (Int :: *))
                                           of
                                           { I# x#_iaihA ->
                                           case andI# x#_iaihA 4# of {
                                             __DEFAULT ->
                                               raiseIO#
                                                 @ SomeException @ () lvl19_raLJH ipv13_iaIxR;
                                             0# -> (# ipv13_iaIxR, GHC.Tuple.() #)
                                           }
                                           }
                                       }
                                       })
                                    `cast` (Sym (GHC.Conc.Sync.N:STM[0] <()>_R)
                                            :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                                               ~R# (STM () :: *)),
                                    (\ (s1_i7JiH :: State# RealWorld) ->
                                       case GHC.Event.Manager.unregisterFd2
                                              wild1_X4a ipv12_X7ICi s1_i7JiH
                                       of
                                       { (# ipv13_i7JiK, ipv14_i7JiL #) ->
                                       (# ipv13_i7JiK, GHC.Tuple.() #)
                                       })
                                    `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                                            :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                                               ~R# (IO () :: *))) #) } in
                          case ipv9_iafMX of {
                            __DEFAULT ->
                              case takeMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOd
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFE, ipv12_X7IFG #) ->
                              case catch#
                                     @ (Bool, Bool)
                                     @ SomeException
                                     (maskAsyncExceptions# @ (Bool, Bool) (io1_saIXO ipv12_X7IFG))
                                     (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                        (s1_iafNa [OS=OneShot] :: State# RealWorld) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOd
                                               ipv12_X7IFG
                                               s1_iafNa
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        raiseIO# @ SomeException @ (Bool, Bool) e1_iafN9 s2#_i9DsB
                                        })
                                     ipv11_X7IFE
                              of
                              { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                              case putMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOd
                                     ipv12_X7IFG
                                     ipv13_X7IAZ
                              of s2#_i9DsB
                              { __DEFAULT ->
                              case ipv14_X7IB1 of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case atomically#
                                         @ ()
                                         (\ (eta1_iaIwq [OS=OneShot] :: State# RealWorld) ->
                                            case writeTVar#
                                                   @ RealWorld
                                                   @ (Maybe Event)
                                                   ipv3_iaIwe
                                                   (GHC.Base.Just
                                                      @ Event
                                                      (dt18_aawnz
                                                       `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                               :: (Int :: *) ~R# (Event :: *))))
                                                   eta1_iaIwq
                                            of s2#1_iaIwv
                                            { __DEFAULT ->
                                            (# s2#1_iaIwv, GHC.Tuple.() #)
                                            })
                                         s2#_i9DsB
                                  of
                                  { (# ipv15_i7JiK, ipv16_i7JiL #) ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    ipv15_i7JiK (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    s2#_i9DsB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              }
                              }
                              };
                            0# ->
                              case maskAsyncExceptions#
                                     @ (Bool, Bool)
                                     (\ (s1_X7IFv [OS=OneShot] :: State# RealWorld) ->
                                        case takeMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOd
                                               s1_X7IFv
                                        of
                                        { (# ipv11_X7IFG, ipv12_X7IFI #) ->
                                        case catch#
                                               @ (Bool, Bool)
                                               @ SomeException
                                               (unmaskAsyncExceptions#
                                                  @ (Bool, Bool) (io1_saIXO ipv12_X7IFI))
                                               (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                                  (s2_iafNa [OS=OneShot] :: State# RealWorld) ->
                                                  case putMVar#
                                                         @ RealWorld
                                                         @ (GHC.Event.IntTable.IntTable [M.FdData])
                                                         ww1_saKOd
                                                         ipv12_X7IFI
                                                         s2_iafNa
                                                  of s2#_i9DsB
                                                  { __DEFAULT ->
                                                  raiseIO#
                                                    @ SomeException
                                                    @ (Bool, Bool)
                                                    e1_iafN9
                                                    s2#_i9DsB
                                                  })
                                               ipv11_X7IFG
                                        of
                                        { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOd
                                               ipv12_X7IFI
                                               ipv13_X7IAZ
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        (# s2#_i9DsB, ipv14_X7IB1 #)
                                        }
                                        }
                                        })
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFr, ipv12_X7IFt #) ->
                              case ipv12_X7IFt of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case atomically#
                                         @ ()
                                         (\ (eta1_iaIwq [OS=OneShot] :: State# RealWorld) ->
                                            case writeTVar#
                                                   @ RealWorld
                                                   @ (Maybe Event)
                                                   ipv3_iaIwe
                                                   (GHC.Base.Just
                                                      @ Event
                                                      (dt18_aawnz
                                                       `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                               :: (Int :: *) ~R# (Event :: *))))
                                                   eta1_iaIwq
                                            of s2#_iaIwv
                                            { __DEFAULT ->
                                            (# s2#_iaIwv, GHC.Tuple.() #)
                                            })
                                         ipv11_X7IFr
                                  of
                                  { (# ipv13_i7JiK, ipv14_i7JiL #) ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    ipv13_i7JiK (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    ipv11_X7IFr (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              };
                            1# ->
                              case takeMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOd
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFF, ipv12_X7IFH #) ->
                              case catch#
                                     @ (Bool, Bool)
                                     @ SomeException
                                     (maskUninterruptible# @ (Bool, Bool) (io1_saIXO ipv12_X7IFH))
                                     (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                        (s1_iafNa [OS=OneShot] :: State# RealWorld) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOd
                                               ipv12_X7IFH
                                               s1_iafNa
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        raiseIO# @ SomeException @ (Bool, Bool) e1_iafN9 s2#_i9DsB
                                        })
                                     ipv11_X7IFF
                              of
                              { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                              case putMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOd
                                     ipv12_X7IFH
                                     ipv13_X7IAZ
                              of s2#_i9DsB
                              { __DEFAULT ->
                              case ipv14_X7IB1 of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case atomically#
                                         @ ()
                                         (\ (eta1_iaIwq [OS=OneShot] :: State# RealWorld) ->
                                            case writeTVar#
                                                   @ RealWorld
                                                   @ (Maybe Event)
                                                   ipv3_iaIwe
                                                   (GHC.Base.Just
                                                      @ Event
                                                      (dt18_aawnz
                                                       `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                               :: (Int :: *) ~R# (Event :: *))))
                                                   eta1_iaIwq
                                            of s2#1_iaIwv
                                            { __DEFAULT ->
                                            (# s2#1_iaIwv, GHC.Tuple.() #)
                                            })
                                         s2#_i9DsB
                                  of
                                  { (# ipv15_i7JiK, ipv16_i7JiL #) ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    ipv15_i7JiK (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ7d
                                    s2#_i9DsB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              }
                              }
                              }
                          }
                          }
                          }
                      }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
              }
              }
              } } in
      case ipv1_ia56Y of {
        __DEFAULT -> io_saIXJ ipv_ia56X;
        0# -> maskAsyncExceptions# @ (STM (), IO ()) io_saIXJ ipv_ia56X
      }
      }

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
threadWaitReadSTM2_raLJN
  :: Fd
     -> State# RealWorld -> (# State# RealWorld, (STM (), IO ()) #)
[GblId, Arity=2, Unf=OtherCon []]
threadWaitReadSTM2_raLJN
  = GHC.Event.Thread.threadWaitReadSTM1 evtRead

-- RHS size: {terms: 1, types: 0, coercions: 9, joins: 0/0}
threadWaitReadSTM [InlPrag=INLINE (sat-args=0)]
  :: Fd -> IO (STM (), IO ())
[GblId,
 Arity=2,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=False,boring_ok=False)
         Tmpl= (GHC.Event.Thread.threadWaitReadSTM1 evtRead)
               `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <(STM (), IO ())>_R)
                       :: (Fd
                           -> State# RealWorld
                           -> (# State# RealWorld, (STM (), IO ()) #) :: *)
                          ~R# (Fd -> IO (STM (), IO ()) :: *))}]
threadWaitReadSTM
  = threadWaitReadSTM2_raLJN
    `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <(STM (), IO ())>_R)
            :: (Fd
                -> State# RealWorld
                -> (# State# RealWorld, (STM (), IO ()) #) :: *)
               ~R# (Fd -> IO (STM (), IO ()) :: *))

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
threadWaitWriteSTM1_raLJO
  :: Fd
     -> State# RealWorld -> (# State# RealWorld, (STM (), IO ()) #)
[GblId, Arity=2, Unf=OtherCon []]
threadWaitWriteSTM1_raLJO
  = GHC.Event.Thread.threadWaitReadSTM1 evtWrite

-- RHS size: {terms: 1, types: 0, coercions: 9, joins: 0/0}
threadWaitWriteSTM [InlPrag=INLINE (sat-args=0)]
  :: Fd -> IO (STM (), IO ())
[GblId,
 Arity=2,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=False,boring_ok=False)
         Tmpl= (GHC.Event.Thread.threadWaitReadSTM1 evtWrite)
               `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <(STM (), IO ())>_R)
                       :: (Fd
                           -> State# RealWorld
                           -> (# State# RealWorld, (STM (), IO ()) #) :: *)
                          ~R# (Fd -> IO (STM (), IO ()) :: *))}]
threadWaitWriteSTM
  = threadWaitWriteSTM1_raLJO
    `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <(STM (), IO ())>_R)
            :: (Fd
                -> State# RealWorld
                -> (# State# RealWorld, (STM (), IO ()) #) :: *)
               ~R# (Fd -> IO (STM (), IO ()) :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl25_raLJP :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl25_raLJP = "threadWait"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl26_raLJQ :: [Char]
[GblId]
lvl26_raLJQ = unpackCString# lvl25_raLJP

-- RHS size: {terms: 5, types: 2, coercions: 0, joins: 0/0}
lvl27_raLJR :: GHC.IO.Exception.IOError
[GblId]
lvl27_raLJR
  = Foreign.C.Error.$werrnoToIOError
      lvl26_raLJQ
      9#
      (GHC.Base.Nothing @ GHC.IO.Handle.Types.Handle)
      (GHC.Base.Nothing @ String)

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
lvl28_raLJS :: SomeException
[GblId]
lvl28_raLJS
  = GHC.IO.Exception.$fExceptionIOException_$ctoException lvl27_raLJR

-- RHS size: {terms: 671, types: 1,157, coercions: 46, joins: 2/12}
GHC.Event.Thread.threadWaitRead1
  :: Event -> Fd -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=3, Str=<L,U(U)><L,U(U)><S,U>, Unf=OtherCon []]
GHC.Event.Thread.threadWaitRead1
  = \ (evt_aaHWP :: Event)
      (fd_aaHWQ :: Fd)
      (eta_X19 :: State# RealWorld) ->
      case getMaskingState# eta_X19 of { (# ipv_ia56X, ipv1_ia56Y #) ->
      let {
        io_saIXr [Dmd=<C(S),C(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, () #)
        [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
        io_saIXr
          = \ (s_X7IBV :: State# RealWorld) ->
              case newMVar# @ RealWorld @ Event s_X7IBV of
              { (# ipv2_iaIyp, ipv3_iaIyq #) ->
              case GHC.Event.Thread.getSystemEventManager1 ipv2_iaIyp of
              { (# ipv4_X7IC7, ipv5_X7IC9 #) ->
              case ipv5_X7IC9 of {
                Nothing -> case lvl24_raLJM ipv4_X7IC7 of wild1_00 { };
                Just mgr_aaHX9 ->
                  case mgr_aaHX9 of wild1_X4a
                  { GHC.Event.Manager.EventManager ds3_dawQk dt_dawXe dt1_dawXf
                                                   dt2_dawXg dt3_dawXh dt4_dawXi dt5_dawXj dt6_dawXk
                                                   dt7_dawXl dt8_dawXm dt9_dawXn dt10_dawXo
                                                   dt11_dawXp ->
                  case dt_dawXe of wild2_saLhl { I# m1_saLhm ->
                  case dt1_dawXf of wild3_saLho { I# n_saLhp ->
                  case ds3_dawQk of
                  { GHC.Event.Internal.Backend @ a_saLhs bState_saLht ds4_saLhu
                                               bModifyFd_saLhv ds5_saLhw ds6_saLhx ->
                  case fetchAddIntArray# @ RealWorld dt5_dawXj 0# 1# ipv4_X7IC7 of
                  { (# ipv6_iariL, ipv7_iariM #) ->
                  case fd_aaHWQ
                       `cast` (System.Posix.Types.N:Fd[0] ; Foreign.C.Types.N:CInt[0]
                               :: (Fd :: *) ~R# (GHC.Int.Int32 :: *))
                  of dt16_aawmO
                  { GHC.Int.I32# dt17_aawmP ->
                  case evt_aaHWP
                       `cast` (GHC.Event.Internal.N:Event[0]
                               :: (Event :: *) ~R# (Int :: *))
                  of dt18_aawnz
                  { I# dt19_aawnA ->
                  case getMaskingState# ipv6_iariL of
                  { (# ipv8_iafMW, ipv9_iafMX #) ->
                  let {
                    i1_saIXH [Dmd=<S,U>] :: Int#
                    [LclId]
                    i1_saIXH = andI# dt17_aawmP 31# } in
                  case <=# m1_saLhm i1_saIXH of {
                    __DEFAULT ->
                      case GHC.Event.Thread.getSystemEventManager2
                             wild3_saLho wild2_saLhl i1_saIXH
                      of wild4_00 {
                      };
                    1# ->
                      case <=# i1_saIXH n_saLhp of {
                        __DEFAULT ->
                          case GHC.Event.Thread.getSystemEventManager2
                                 wild3_saLho wild2_saLhl i1_saIXH
                          of wild4_00 {
                          };
                        1# ->
                          case indexArray#
                                 @ (MVar (GHC.Event.IntTable.IntTable [M.FdData]))
                                 dt3_dawXh
                                 (-# i1_saIXH m1_saLhm)
                          of
                          { (# ipv10_iawOK #) ->
                          case ipv10_iawOK of { GHC.MVar.MVar ww1_saKOD ->
                          let {
                            $wio_saKOA [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(C1(U(U,U)))>]
                              :: MutVar# RealWorld (GHC.Event.IntTable.IT [M.FdData])
                                 -> State# RealWorld -> (# State# RealWorld, (Bool, Bool) #)
                            [LclId, Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
                            $wio_saKOA
                              = \ (ww2_saKOy [OS=OneShot]
                                     :: MutVar# RealWorld (GHC.Event.IntTable.IT [M.FdData]))
                                  (w_saKOv [OS=OneShot] :: State# RealWorld) ->
                                  let {
                                    lvl31_saJrs
                                      :: M.FdKey
                                         -> Event -> State# RealWorld -> (# State# RealWorld, () #)
                                    [LclId,
                                     Arity=3,
                                     Str=<L,A><L,U><S,U>,
                                     Unf=Unf{Src=InlineStable, TopLvl=False, Value=True,
                                             ConLike=True, WorkFree=True, Expandable=True,
                                             Guidance=ALWAYS_IF(arity=3,unsat_ok=True,boring_ok=False)
                                             Tmpl= \ _ [Occ=Dead]
                                                     (e_aaHWT [Occ=Once] :: Event)
                                                     (eta1_B1 [Occ=Once] :: State# RealWorld) ->
                                                     case putMVar#
                                                            @ RealWorld
                                                            @ Event
                                                            ipv3_iaIyq
                                                            e_aaHWT
                                                            eta1_B1
                                                     of s2#_i9DsB
                                                     { __DEFAULT ->
                                                     (# s2#_i9DsB, GHC.Tuple.() #)
                                                     }}]
                                    lvl31_saJrs
                                      = \ _ [Occ=Dead]
                                          (e_aaHWT :: Event)
                                          (eta1_B1 :: State# RealWorld) ->
                                          case putMVar#
                                                 @ RealWorld @ Event ipv3_iaIyq e_aaHWT eta1_B1
                                          of s2#_i9DsB
                                          { __DEFAULT ->
                                          (# s2#_i9DsB, GHC.Tuple.() #)
                                          } } in
                                  case GHC.Event.IntTable.$winsertWith
                                         @ [M.FdData]
                                         (++ @ M.FdData)
                                         dt17_aawmP
                                         (GHC.Types.:
                                            @ M.FdData
                                            (GHC.Event.Manager.FdData
                                               dt17_aawmP
                                               ipv7_iariM
                                               dt19_aawnA
                                               (lvl31_saJrs
                                                `cast` (<M.FdKey>_R
                                                        ->_R <Event>_R
                                                        ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                                        :: (M.FdKey
                                                            -> Event
                                                            -> State# RealWorld
                                                            -> (# State# RealWorld, () #) :: *)
                                                           ~R# (M.FdKey -> Event -> IO () :: *))))
                                            (GHC.Types.[] @ M.FdData))
                                         ww2_saKOy
                                         w_saKOv
                                  of
                                  { (# ipv11_X7IFr, ipv12_X7IFt #) ->
                                  join {
                                    $j_saIXB [Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
                                      :: Int# -> Int -> (# State# RealWorld, (Bool, Bool) #)
                                    [LclId[JoinId(2)],
                                     Arity=2,
                                     Str=<S,U><S,1*U(U)>,
                                     Unf=OtherCon []]
                                    $j_saIXB (x#_i7Vds [OS=OneShot] :: Int#)
                                             (wild4_i7Vdq [OS=OneShot]
                                                :: Int
                                                Unf=OtherCon [])
                                      = case wild4_i7Vdq of { I# x_saLhA ->
                                        let {
                                          x#1_saIXD [Dmd=<S,U>] :: Int#
                                          [LclId]
                                          x#1_saIXD = orI# x#_i7Vds dt19_aawnA } in
                                        case andI# x#1_saIXD 8# of {
                                          __DEFAULT ->
                                            case /=# x_saLhA x#1_saIXD of {
                                              __DEFAULT -> (# ipv11_X7IFr, lvl20_raLJI #);
                                              1# ->
                                                case ((bModifyFd_saLhv
                                                         bState_saLht
                                                         (dt16_aawmO
                                                          `cast` (Sym (Foreign.C.Types.N:CInt[0]) ; Sym (System.Posix.Types.N:Fd[0])
                                                                  :: (GHC.Int.Int32 :: *)
                                                                     ~R# (Fd :: *)))
                                                         ((GHC.Types.I# (andI# x#_i7Vds 7#))
                                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                                  :: (Int :: *) ~R# (Event :: *)))
                                                         ((GHC.Types.I# (andI# x#1_saIXD 7#))
                                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                                  :: (Int :: *) ~R# (Event :: *))))
                                                      `cast` (GHC.Types.N:IO[0] <Bool>_R
                                                              :: (IO Bool :: *)
                                                                 ~R# (State# RealWorld
                                                                      -> (# State# RealWorld,
                                                                            Bool #) :: *)))
                                                       ipv11_X7IFr
                                                of
                                                { (# ipv13_X7IFI, ipv14_X7IFK #) ->
                                                case ipv14_X7IFK of {
                                                  False ->
                                                    case ipv12_X7IFt of {
                                                      Nothing ->
                                                        case readMutVar#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.IT [M.FdData])
                                                               ww2_saKOy
                                                               ipv13_X7IFI
                                                        of
                                                        { (# ipv15_iayE8, ipv16_iayE9 #) ->
                                                        case ipv16_iayE9 of
                                                        { GHC.Event.IntTable.IT dt20_iayEe
                                                                                dt21_iayEf
                                                                                dt22_iayEg ->
                                                        let {
                                                          n#_iayEd [Dmd=<S,U>] :: Int#
                                                          [LclId]
                                                          n#_iayEd
                                                            = andI#
                                                                dt17_aawmP
                                                                (-#
                                                                   (sizeofMutableArray#
                                                                      @ RealWorld
                                                                      @ (GHC.Event.IntTable.Bucket
                                                                           [M.FdData])
                                                                      dt20_iayEe)
                                                                   1#) } in
                                                        case readArray#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.Bucket
                                                                    [M.FdData])
                                                               dt20_iayEe
                                                               n#_iayEd
                                                               ipv15_iayE8
                                                        of
                                                        { (# ipv17_iayEm, ipv18_iayEn #) ->
                                                        letrec {
                                                          $wgo_iayEk [InlPrag=NOUSERINLINE[0],
                                                                      Occ=LoopBreaker]
                                                            :: GHC.Event.IntTable.Bucket [M.FdData]
                                                               -> (# Bool, Maybe [M.FdData],
                                                                     GHC.Event.IntTable.Bucket
                                                                       [M.FdData] #)
                                                          [LclId,
                                                           Arity=1,
                                                           Str=<S,1*U>,
                                                           Unf=OtherCon []]
                                                          $wgo_iayEk
                                                            = \ (w2_iayEl
                                                                   :: GHC.Event.IntTable.Bucket
                                                                        [M.FdData]) ->
                                                                case w2_iayEl of {
                                                                  GHC.Event.IntTable.Empty ->
                                                                    (# GHC.Types.False,
                                                                       GHC.Base.Nothing
                                                                         @ [M.FdData],
                                                                       GHC.Event.IntTable.Empty
                                                                         @ [M.FdData] #);
                                                                  GHC.Event.IntTable.Bucket dt23_iayEs
                                                                                            ds14_iayEt
                                                                                            ds15_iayEu ->
                                                                    case ==# dt23_iayEs dt17_aawmP
                                                                    of {
                                                                      __DEFAULT ->
                                                                        case $wgo_iayEk ds15_iayEu
                                                                        of
                                                                        { (# ww4_iayEz, ww5_iayEA,
                                                                             ww6_iayEB #) ->
                                                                        (# ww4_iayEz, ww5_iayEA,
                                                                           GHC.Event.IntTable.Bucket
                                                                             @ [M.FdData]
                                                                             dt23_iayEs
                                                                             ds14_iayEt
                                                                             ww6_iayEB #)
                                                                        };
                                                                      1# ->
                                                                        (# GHC.Types.True,
                                                                           GHC.Base.Just
                                                                             @ [M.FdData]
                                                                             ds14_iayEt,
                                                                           ds15_iayEu #)
                                                                    }
                                                                }; } in
                                                        case $wgo_iayEk ipv18_iayEn of
                                                        { (# ww4_iayEF, ww5_iayEG, ww6_iayEH #) ->
                                                        case ww5_iayEG of {
                                                          Nothing -> (# ipv17_iayEm, lvl21_raLJJ #);
                                                          Just ipv19_iayEN ->
                                                            case writeArray#
                                                                   @ RealWorld
                                                                   @ (GHC.Event.IntTable.Bucket
                                                                        [M.FdData])
                                                                   dt20_iayEe
                                                                   n#_iayEd
                                                                   ww6_iayEH
                                                                   ipv17_iayEm
                                                            of s1#_iayEP
                                                            { __DEFAULT ->
                                                            case ww4_iayEF of {
                                                              False -> (# s1#_iayEP, lvl21_raLJJ #);
                                                              True ->
                                                                case readIntOffAddr#
                                                                       @ RealWorld
                                                                       dt21_iayEf
                                                                       0#
                                                                       s1#_iayEP
                                                                of
                                                                { (# ipv20_iayEX, ipv21_iayEY #) ->
                                                                case writeIntOffAddr#
                                                                       @ RealWorld
                                                                       dt21_iayEf
                                                                       0#
                                                                       (-# ipv21_iayEY 1#)
                                                                       ipv20_iayEX
                                                                of s2_iayF0
                                                                { __DEFAULT ->
                                                                case touch#
                                                                       @ 'LiftedRep
                                                                       @ GHC.ForeignPtr.ForeignPtrContents
                                                                       dt22_iayEg
                                                                       s2_iayF0
                                                                of s'_iayF1
                                                                { __DEFAULT ->
                                                                (# s'_iayF1, lvl21_raLJJ #)
                                                                }
                                                                }
                                                                }
                                                            }
                                                            }
                                                        }
                                                        }
                                                        }
                                                        }
                                                        };
                                                      Just v_iayF3 ->
                                                        case GHC.Event.IntTable.$winsertWith
                                                               @ [M.FdData]
                                                               (const @ [M.FdData] @ [M.FdData])
                                                               dt17_aawmP
                                                               v_iayF3
                                                               ww2_saKOy
                                                               ipv13_X7IFI
                                                        of
                                                        { (# ipv15_iayF7, ipv16_iayF8 #) ->
                                                        (# ipv15_iayF7, lvl21_raLJJ #)
                                                        }
                                                    };
                                                  True -> (# ipv13_X7IFI, lvl22_raLJK #)
                                                }
                                                }
                                            };
                                          0# ->
                                            case ((ds5_saLhw
                                                     bState_saLht
                                                     (dt16_aawmO
                                                      `cast` (Sym (Foreign.C.Types.N:CInt[0]) ; Sym (System.Posix.Types.N:Fd[0])
                                                              :: (GHC.Int.Int32 :: *)
                                                                 ~R# (Fd :: *)))
                                                     ((GHC.Types.I# (andI# x#1_saIXD 7#))
                                                      `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                              :: (Int :: *) ~R# (Event :: *))))
                                                  `cast` (GHC.Types.N:IO[0] <Bool>_R
                                                          :: (IO Bool :: *)
                                                             ~R# (State# RealWorld
                                                                  -> (# State# RealWorld,
                                                                        Bool #) :: *)))
                                                   ipv11_X7IFr
                                            of
                                            { (# ipv13_X7IFJ, ipv14_X7IFL #) ->
                                            case ipv14_X7IFL of {
                                              False ->
                                                case ipv12_X7IFt of {
                                                  Nothing ->
                                                    case readMutVar#
                                                           @ RealWorld
                                                           @ (GHC.Event.IntTable.IT [M.FdData])
                                                           ww2_saKOy
                                                           ipv13_X7IFJ
                                                    of
                                                    { (# ipv15_iayE8, ipv16_iayE9 #) ->
                                                    case ipv16_iayE9 of
                                                    { GHC.Event.IntTable.IT dt20_iayEe dt21_iayEf
                                                                            dt22_iayEg ->
                                                    let {
                                                      n#_iayEd [Dmd=<S,U>] :: Int#
                                                      [LclId]
                                                      n#_iayEd
                                                        = andI#
                                                            dt17_aawmP
                                                            (-#
                                                               (sizeofMutableArray#
                                                                  @ RealWorld
                                                                  @ (GHC.Event.IntTable.Bucket
                                                                       [M.FdData])
                                                                  dt20_iayEe)
                                                               1#) } in
                                                    case readArray#
                                                           @ RealWorld
                                                           @ (GHC.Event.IntTable.Bucket [M.FdData])
                                                           dt20_iayEe
                                                           n#_iayEd
                                                           ipv15_iayE8
                                                    of
                                                    { (# ipv17_iayEm, ipv18_iayEn #) ->
                                                    letrec {
                                                      $wgo_iayEk [InlPrag=NOUSERINLINE[0],
                                                                  Occ=LoopBreaker]
                                                        :: GHC.Event.IntTable.Bucket [M.FdData]
                                                           -> (# Bool, Maybe [M.FdData],
                                                                 GHC.Event.IntTable.Bucket
                                                                   [M.FdData] #)
                                                      [LclId, Arity=1, Str=<S,1*U>, Unf=OtherCon []]
                                                      $wgo_iayEk
                                                        = \ (w2_iayEl
                                                               :: GHC.Event.IntTable.Bucket
                                                                    [M.FdData]) ->
                                                            case w2_iayEl of {
                                                              GHC.Event.IntTable.Empty ->
                                                                (# GHC.Types.False,
                                                                   GHC.Base.Nothing @ [M.FdData],
                                                                   GHC.Event.IntTable.Empty
                                                                     @ [M.FdData] #);
                                                              GHC.Event.IntTable.Bucket dt23_iayEs
                                                                                        ds14_iayEt
                                                                                        ds15_iayEu ->
                                                                case ==# dt23_iayEs dt17_aawmP of {
                                                                  __DEFAULT ->
                                                                    case $wgo_iayEk ds15_iayEu of
                                                                    { (# ww4_iayEz, ww5_iayEA,
                                                                         ww6_iayEB #) ->
                                                                    (# ww4_iayEz, ww5_iayEA,
                                                                       GHC.Event.IntTable.Bucket
                                                                         @ [M.FdData]
                                                                         dt23_iayEs
                                                                         ds14_iayEt
                                                                         ww6_iayEB #)
                                                                    };
                                                                  1# ->
                                                                    (# GHC.Types.True,
                                                                       GHC.Base.Just
                                                                         @ [M.FdData] ds14_iayEt,
                                                                       ds15_iayEu #)
                                                                }
                                                            }; } in
                                                    case $wgo_iayEk ipv18_iayEn of
                                                    { (# ww4_iayEF, ww5_iayEG, ww6_iayEH #) ->
                                                    case ww5_iayEG of {
                                                      Nothing -> (# ipv17_iayEm, lvl21_raLJJ #);
                                                      Just ipv19_iayEN ->
                                                        case writeArray#
                                                               @ RealWorld
                                                               @ (GHC.Event.IntTable.Bucket
                                                                    [M.FdData])
                                                               dt20_iayEe
                                                               n#_iayEd
                                                               ww6_iayEH
                                                               ipv17_iayEm
                                                        of s1#_iayEP
                                                        { __DEFAULT ->
                                                        case ww4_iayEF of {
                                                          False -> (# s1#_iayEP, lvl21_raLJJ #);
                                                          True ->
                                                            case readIntOffAddr#
                                                                   @ RealWorld
                                                                   dt21_iayEf
                                                                   0#
                                                                   s1#_iayEP
                                                            of
                                                            { (# ipv20_iayEX, ipv21_iayEY #) ->
                                                            case writeIntOffAddr#
                                                                   @ RealWorld
                                                                   dt21_iayEf
                                                                   0#
                                                                   (-# ipv21_iayEY 1#)
                                                                   ipv20_iayEX
                                                            of s2_iayF0
                                                            { __DEFAULT ->
                                                            case touch#
                                                                   @ 'LiftedRep
                                                                   @ GHC.ForeignPtr.ForeignPtrContents
                                                                   dt22_iayEg
                                                                   s2_iayF0
                                                            of s'_iayF1
                                                            { __DEFAULT ->
                                                            (# s'_iayF1, lvl21_raLJJ #)
                                                            }
                                                            }
                                                            }
                                                        }
                                                        }
                                                    }
                                                    }
                                                    }
                                                    }
                                                    };
                                                  Just v_iayF3 ->
                                                    case GHC.Event.IntTable.$winsertWith
                                                           @ [M.FdData]
                                                           (const @ [M.FdData] @ [M.FdData])
                                                           dt17_aawmP
                                                           v_iayF3
                                                           ww2_saKOy
                                                           ipv13_X7IFJ
                                                    of
                                                    { (# ipv15_iayF7, ipv16_iayF8 #) ->
                                                    (# ipv15_iayF7, lvl21_raLJJ #)
                                                    }
                                                };
                                              True -> (# ipv13_X7IFJ, lvl20_raLJI #)
                                            }
                                            }
                                        }
                                        } } in
                                  case ipv12_X7IFt of {
                                    Nothing ->
                                      jump $j_saIXB 0# GHC.Event.Internal.$fMonoidEventLifetime1;
                                    Just x1_i8O4S ->
                                      case GHC.Event.Manager.$weventsOf x1_i8O4S of ww3_sazrd
                                      { __DEFAULT ->
                                      jump $j_saIXB ww3_sazrd (GHC.Types.I# ww3_sazrd)
                                      }
                                  }
                                  } } in
                          let {
                            io1_saIXw [InlPrag=NOUSERINLINE[0], Dmd=<L,1*C1(C1(U))>]
                              :: GHC.Event.IntTable.IntTable [M.FdData]
                                 -> State# RealWorld -> (# State# RealWorld, (Bool, Bool) #)
                            [LclId,
                             Arity=2,
                             Str=<S(S),1*U(U)><S,U>,
                             Unf=Unf{Src=InlineStable, TopLvl=False, Value=True, ConLike=True,
                                     WorkFree=True, Expandable=True,
                                     Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
                                     Tmpl= \ (w_saKOu [Occ=Once]
                                                :: GHC.Event.IntTable.IntTable [M.FdData])
                                             (w1_saKOv [Occ=Once] :: State# RealWorld) ->
                                             case w_saKOu
                                                  `cast` (GHC.Event.IntTable.N:IntTable[0]
                                                              <[M.FdData]>_R ; GHC.IORef.N:IORef[0] <GHC.Event.IntTable.IT
                                                                                                       [M.FdData]>_N
                                                          :: (GHC.Event.IntTable.IntTable
                                                                [M.FdData] :: *)
                                                             ~R# (GHC.STRef.STRef
                                                                    RealWorld
                                                                    (GHC.Event.IntTable.IT
                                                                       [M.FdData]) :: *))
                                             of
                                             { GHC.STRef.STRef ww3_saKOy [Occ=Once] ->
                                             $wio_saKOA ww3_saKOy w1_saKOv
                                             }}]
                            io1_saIXw
                              = \ (w_saKOu [OS=OneShot]
                                     :: GHC.Event.IntTable.IntTable [M.FdData])
                                  (w1_saKOv [OS=OneShot] :: State# RealWorld) ->
                                  case w_saKOu
                                       `cast` (GHC.Event.IntTable.N:IntTable[0]
                                                   <[M.FdData]>_R ; GHC.IORef.N:IORef[0] <GHC.Event.IntTable.IT
                                                                                            [M.FdData]>_N
                                               :: (GHC.Event.IntTable.IntTable [M.FdData] :: *)
                                                  ~R# (GHC.STRef.STRef
                                                         RealWorld
                                                         (GHC.Event.IntTable.IT [M.FdData]) :: *))
                                  of
                                  { GHC.STRef.STRef ww3_saKOy ->
                                  $wio_saKOA ww3_saKOy w1_saKOv
                                  } } in
                          join {
                            $j_saJ8n [Dmd=<C(C(S)),1*C1(C1(U(U,U)))>]
                              :: State# RealWorld -> M.FdKey -> (# State# RealWorld, () #)
                            [LclId[JoinId(2)], Arity=2, Str=<S,U><L,1*U(U,U)>, Unf=OtherCon []]
                            $j_saJ8n (ipv11_X7ICj [OS=OneShot] :: State# RealWorld)
                                     (ipv12_X7ICl [OS=OneShot] :: M.FdKey)
                              = case catch#
                                       @ Event
                                       @ SomeException
                                       (\ (eta1_i9Dsl [OS=OneShot] :: State# RealWorld) ->
                                          takeMVar# @ RealWorld @ Event ipv3_iaIyq eta1_i9Dsl)
                                       (\ (e_iaIzD [OS=OneShot] :: SomeException)
                                          (s1_iaIzE [OS=OneShot] :: State# RealWorld) ->
                                          case GHC.Event.Manager.unregisterFd2
                                                 wild1_X4a ipv12_X7ICl s1_iaIzE
                                          of
                                          { (# ipv13_iaIzH, ipv14_iaIzI #) ->
                                          raiseIO# @ SomeException @ Event e_iaIzD ipv13_iaIzH
                                          })
                                       ipv11_X7ICj
                                of
                                { (# ipv13_X7ICq, ipv14_X7ICs #) ->
                                case ipv14_X7ICs
                                     `cast` (GHC.Event.Internal.N:Event[0]
                                             :: (Event :: *) ~R# (Int :: *))
                                of
                                { I# x#_iaihA ->
                                case andI# x#_iaihA 4# of {
                                  __DEFAULT ->
                                    raiseIO# @ SomeException @ () lvl28_raLJS ipv13_X7ICq;
                                  0# -> (# ipv13_X7ICq, GHC.Tuple.() #)
                                }
                                }
                                } } in
                          case ipv9_iafMX of {
                            __DEFAULT ->
                              case takeMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOD
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFE, ipv12_X7IFG #) ->
                              case catch#
                                     @ (Bool, Bool)
                                     @ SomeException
                                     (maskAsyncExceptions# @ (Bool, Bool) (io1_saIXw ipv12_X7IFG))
                                     (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                        (s1_iafNa [OS=OneShot] :: State# RealWorld) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOD
                                               ipv12_X7IFG
                                               s1_iafNa
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        raiseIO# @ SomeException @ (Bool, Bool) e1_iafN9 s2#_i9DsB
                                        })
                                     ipv11_X7IFE
                              of
                              { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                              case putMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOD
                                     ipv12_X7IFG
                                     ipv13_X7IAZ
                              of s2#_i9DsB
                              { __DEFAULT ->
                              case ipv14_X7IB1 of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case putMVar#
                                         @ RealWorld
                                         @ Event
                                         ipv3_iaIyq
                                         (dt18_aawnz
                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                  :: (Int :: *) ~R# (Event :: *)))
                                         s2#_i9DsB
                                  of s2#1_X9DvB
                                  { __DEFAULT ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    s2#1_X9DvB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    s2#_i9DsB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              }
                              }
                              };
                            0# ->
                              case maskAsyncExceptions#
                                     @ (Bool, Bool)
                                     (\ (s1_X7IFv [OS=OneShot] :: State# RealWorld) ->
                                        case takeMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOD
                                               s1_X7IFv
                                        of
                                        { (# ipv11_X7IFG, ipv12_X7IFI #) ->
                                        case catch#
                                               @ (Bool, Bool)
                                               @ SomeException
                                               (unmaskAsyncExceptions#
                                                  @ (Bool, Bool) (io1_saIXw ipv12_X7IFI))
                                               (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                                  (s2_iafNa [OS=OneShot] :: State# RealWorld) ->
                                                  case putMVar#
                                                         @ RealWorld
                                                         @ (GHC.Event.IntTable.IntTable [M.FdData])
                                                         ww1_saKOD
                                                         ipv12_X7IFI
                                                         s2_iafNa
                                                  of s2#_i9DsB
                                                  { __DEFAULT ->
                                                  raiseIO#
                                                    @ SomeException
                                                    @ (Bool, Bool)
                                                    e1_iafN9
                                                    s2#_i9DsB
                                                  })
                                               ipv11_X7IFG
                                        of
                                        { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOD
                                               ipv12_X7IFI
                                               ipv13_X7IAZ
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        (# s2#_i9DsB, ipv14_X7IB1 #)
                                        }
                                        }
                                        })
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFr, ipv12_X7IFt #) ->
                              case ipv12_X7IFt of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case putMVar#
                                         @ RealWorld
                                         @ Event
                                         ipv3_iaIyq
                                         (dt18_aawnz
                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                  :: (Int :: *) ~R# (Event :: *)))
                                         ipv11_X7IFr
                                  of s2#_i9DsB
                                  { __DEFAULT ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    s2#_i9DsB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    ipv11_X7IFr (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              };
                            1# ->
                              case takeMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOD
                                     ipv8_iafMW
                              of
                              { (# ipv11_X7IFF, ipv12_X7IFH #) ->
                              case catch#
                                     @ (Bool, Bool)
                                     @ SomeException
                                     (maskUninterruptible# @ (Bool, Bool) (io1_saIXw ipv12_X7IFH))
                                     (\ (e1_iafN9 [OS=OneShot] :: SomeException)
                                        (s1_iafNa [OS=OneShot] :: State# RealWorld) ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               ww1_saKOD
                                               ipv12_X7IFH
                                               s1_iafNa
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        raiseIO# @ SomeException @ (Bool, Bool) e1_iafN9 s2#_i9DsB
                                        })
                                     ipv11_X7IFF
                              of
                              { (# ipv13_X7IAZ, ipv14_X7IB1 #) ->
                              case putMVar#
                                     @ RealWorld
                                     @ (GHC.Event.IntTable.IntTable [M.FdData])
                                     ww1_saKOD
                                     ipv12_X7IFH
                                     ipv13_X7IAZ
                              of s2#_i9DsB
                              { __DEFAULT ->
                              case ipv14_X7IB1 of { (modify_aawlh, ok_aawli) ->
                              case ok_aawli of {
                                False ->
                                  case putMVar#
                                         @ RealWorld
                                         @ Event
                                         ipv3_iaIyq
                                         (dt18_aawnz
                                          `cast` (Sym (GHC.Event.Internal.N:Event[0])
                                                  :: (Int :: *) ~R# (Event :: *)))
                                         s2#_i9DsB
                                  of s2#1_X9DvC
                                  { __DEFAULT ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    s2#1_X9DvC (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                                  };
                                True ->
                                  case modify_aawlh of { __DEFAULT ->
                                  jump $j_saJ8n
                                    s2#_i9DsB (GHC.Event.Manager.FdKey dt17_aawmP ipv7_iariM)
                                  }
                              }
                              }
                              }
                              }
                              }
                          }
                          }
                          }
                      }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
                  }
              }
              }
              } } in
      case ipv1_ia56Y of {
        __DEFAULT -> io_saIXr ipv_ia56X;
        0# -> maskAsyncExceptions# @ () io_saIXr ipv_ia56X
      }
      }

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
threadWaitWrite1_raLJT
  :: Fd -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=2, Unf=OtherCon []]
threadWaitWrite1_raLJT = GHC.Event.Thread.threadWaitRead1 evtWrite

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
threadWaitWrite [InlPrag=INLINE (sat-args=0)] :: Fd -> IO ()
[GblId,
 Arity=2,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=False,boring_ok=False)
         Tmpl= (GHC.Event.Thread.threadWaitRead1 evtWrite)
               `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Fd -> IO () :: *))}]
threadWaitWrite
  = threadWaitWrite1_raLJT
    `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Fd -> IO () :: *))

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
threadWaitRead2_raLJU
  :: Fd -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=2, Unf=OtherCon []]
threadWaitRead2_raLJU = GHC.Event.Thread.threadWaitRead1 evtRead

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
threadWaitRead [InlPrag=INLINE (sat-args=0)] :: Fd -> IO ()
[GblId,
 Arity=2,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=False,boring_ok=False)
         Tmpl= (GHC.Event.Thread.threadWaitRead1 evtRead)
               `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Fd -> IO () :: *))}]
threadWaitRead
  = threadWaitRead2_raLJU
    `cast` (<Fd>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Fd -> IO () :: *))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
lvl29_raLJV :: Addr#
[GblId, Caf=NoCafRefs, Unf=OtherCon []]
lvl29_raLJV
  = "Pattern match failure in do expression at GHC/Event/Thread.hs:104:5-17"#

-- RHS size: {terms: 5, types: 3, coercions: 0, joins: 0/0}
lvl30_raLJW
  :: State# RealWorld -> (# State# RealWorld, EventManager #)
[GblId, Arity=1, Str=<B,U>x, Unf=OtherCon []]
lvl30_raLJW
  = \ (eta_B1 :: State# RealWorld) ->
      GHC.IO.failIO1 @ EventManager (unpackCString# lvl29_raLJV) eta_B1

Rec {
-- RHS size: {terms: 16, types: 31, coercions: 2, joins: 0/0}
go_raLJX
  :: [IO ()] -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=2, Caf=NoCafRefs, Str=<S,1*U><S,U>, Unf=OtherCon []]
go_raLJX
  = \ (ds_X7Jg0 :: [IO ()]) (eta_B1 :: State# RealWorld) ->
      case ds_X7Jg0 of {
        [] -> (# eta_B1, GHC.Tuple.() #);
        : y_i7Jcp ys_i7Jcq ->
          case (y_i7Jcp
                `cast` (GHC.Types.N:IO[0] <()>_R
                        :: (IO () :: *)
                           ~R# (State# RealWorld -> (# State# RealWorld, () #) :: *)))
                 eta_B1
          of
          { (# ipv_i7JiK, ipv1_i7JiL #) ->
          go_raLJX ys_i7Jcq ipv_i7JiK
          }
      }
end Rec }

-- RHS size: {terms: 402, types: 780, coercions: 50, joins: 1/8}
GHC.Event.Thread.closeFdWith1
  :: (Fd -> IO ())
     -> Fd -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=3, Str=<L,C(C1(U))><L,U(U)><S,U>, Unf=OtherCon []]
GHC.Event.Thread.closeFdWith1
  = \ (close_aaHWu :: Fd -> IO ())
      (fd_aaHWv :: Fd)
      (eta_X1h :: State# RealWorld) ->
      case eventManager
           `cast` (GHC.IORef.N:IORef[0] <IOArray
                                           Int (Maybe (ThreadId, EventManager))>_N
                   :: (IORef (IOArray Int (Maybe (ThreadId, EventManager))) :: *)
                      ~R# (GHC.STRef.STRef
                             RealWorld (IOArray Int (Maybe (ThreadId, EventManager))) :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar#
             @ RealWorld
             @ (IOArray Int (Maybe (ThreadId, EventManager)))
             var#_i7IB3
             eta_X1h
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case ipv1_i7IAz
           `cast` (GHC.IOArray.N:IOArray[0] <Int>_N <Maybe
                                                       (ThreadId, EventManager)>_N
                   :: (IOArray Int (Maybe (ThreadId, EventManager)) :: *)
                      ~R# (GHC.Arr.STArray
                             RealWorld Int (Maybe (ThreadId, EventManager)) :: *))
      of
      { GHC.Arr.STArray l_i80pt u_i80pu dt_i80pv ds2_i80pw ->
      case l_i80pt of wild2_saLhD { I# x_saLhE ->
      case u_i80pu of wild3_saLhG { I# y_saLhH ->
      join {
        $j_saJV3 [Dmd=<L,1*C1(C1(U(U,U)))>]
          :: State# RealWorld -> [EventManager] -> (# State# RealWorld, () #)
        [LclId[JoinId(2)], Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
        $j_saJV3 (ipv2_X7ICl [OS=OneShot] :: State# RealWorld)
                 (ipv3_X7ICn [OS=OneShot] :: [EventManager])
          = case getMaskingState# ipv2_X7ICl of
            { (# ipv4_ia56X, ipv5_ia56Y #) ->
            let {
              io_saIXp [Dmd=<C(S),C(U(U,U))>]
                :: State# RealWorld -> (# State# RealWorld, () #)
              [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
              io_saIXp
                = \ (s_X7IEf :: State# RealWorld) ->
                    letrec {
                      go1_saK3j [Occ=LoopBreaker]
                        :: [EventManager]
                           -> State# RealWorld
                           -> (# State# RealWorld, [GHC.Event.IntTable.IntTable [M.FdData]] #)
                      [LclId, Arity=2, Str=<S,1*U><S,U>, Unf=OtherCon []]
                      go1_saK3j
                        = \ (ds3_i7Jck :: [EventManager]) (eta1_B1 :: State# RealWorld) ->
                            case ds3_i7Jck of {
                              [] ->
                                (# eta1_B1,
                                   GHC.Types.[] @ (GHC.Event.IntTable.IntTable [M.FdData]) #);
                              : y1_i7Jcp ys_i7Jcq ->
                                case y1_i7Jcp of
                                { GHC.Event.Manager.EventManager ds4_dawVB dt1_dawYk dt2_dawYl
                                                                 dt3_dawYm dt4_dawYn dt5_dawYo
                                                                 dt6_dawYp dt7_dawYq dt8_dawYr
                                                                 dt9_dawYs dt10_dawYt dt11_dawYu
                                                                 dt12_dawYv ->
                                case dt1_dawYk of wild6_saLhJ { I# m_saLhK ->
                                case dt2_dawYl of wild7_saLhM { I# n_saLhN ->
                                case fd_aaHWv
                                     `cast` (System.Posix.Types.N:Fd[0] ; Foreign.C.Types.N:CInt[0]
                                             :: (Fd :: *) ~R# (GHC.Int.Int32 :: *))
                                of
                                { GHC.Int.I32# x#_i9h2V ->
                                let {
                                  i1_iax2r [Dmd=<S,U>] :: Int#
                                  [LclId]
                                  i1_iax2r = andI# x#_i9h2V 31# } in
                                case <=# m_saLhK i1_iax2r of {
                                  __DEFAULT ->
                                    case GHC.Event.Thread.getSystemEventManager2
                                           wild7_saLhM wild6_saLhJ i1_iax2r
                                    of wild9_00 {
                                    };
                                  1# ->
                                    case <=# i1_iax2r n_saLhN of {
                                      __DEFAULT ->
                                        case GHC.Event.Thread.getSystemEventManager2
                                               wild7_saLhM wild6_saLhJ i1_iax2r
                                        of wild9_00 {
                                        };
                                      1# ->
                                        case indexArray#
                                               @ (MVar (GHC.Event.IntTable.IntTable [M.FdData]))
                                               dt4_dawYn
                                               (-# i1_iax2r m_saLhK)
                                        of
                                        { (# ipv6_iawOK #) ->
                                        case ipv6_iawOK of { GHC.MVar.MVar mvar#_i9Dso ->
                                        case takeMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               mvar#_i9Dso
                                               eta1_B1
                                        of
                                        { (# ipv7_X7ICA, ipv8_X7ICC #) ->
                                        case go1_saK3j ys_i7Jcq ipv7_X7ICA of
                                        { (# ipv9_X7ICG, ipv10_X7ICI #) ->
                                        (# ipv9_X7ICG,
                                           GHC.Types.:
                                             @ (GHC.Event.IntTable.IntTable [M.FdData])
                                             ipv8_X7ICC
                                             ipv10_X7ICI #)
                                        }
                                        }
                                        }
                                        }
                                    }
                                }
                                }
                                }
                                }
                                }
                            }; } in
                    case go1_saK3j ipv3_X7ICn s_X7IEf of
                    { (# ipv6_X7ICx, ipv7_X7ICz #) ->
                    letrec {
                      go2_saK3r [Occ=LoopBreaker]
                        :: [EventManager]
                           -> [GHC.Event.IntTable.IntTable [M.FdData]]
                           -> State# RealWorld
                           -> (# State# RealWorld, [IO ()] #)
                      [LclId, Arity=3, Str=<S,1*U><L,1*U><S,U>, Unf=OtherCon []]
                      go2_saK3r
                        = \ (ds4_iaIB3 :: [EventManager])
                            (_ys_iaIB4 :: [GHC.Event.IntTable.IntTable [M.FdData]])
                            (eta1_B1 :: State# RealWorld) ->
                            case ds4_iaIB3 of {
                              [] -> (# eta1_B1, GHC.Types.[] @ (IO ()) #);
                              : ipv8_iaIB9 ipv9_iaIBa ->
                                case _ys_iaIB4 of {
                                  [] -> (# eta1_B1, GHC.Types.[] @ (IO ()) #);
                                  : ipv10_iaIBg ipv11_iaIBh ->
                                    case ipv10_iaIBg
                                         `cast` (GHC.Event.IntTable.N:IntTable[0]
                                                     <[M.FdData]>_R ; GHC.IORef.N:IORef[0] <GHC.Event.IntTable.IT
                                                                                              [M.FdData]>_N
                                                 :: (GHC.Event.IntTable.IntTable [M.FdData] :: *)
                                                    ~R# (GHC.STRef.STRef
                                                           RealWorld
                                                           (GHC.Event.IntTable.IT [M.FdData]) :: *))
                                    of
                                    { GHC.STRef.STRef ww1_sazu9 ->
                                    case fd_aaHWv
                                         `cast` (System.Posix.Types.N:Fd[0] ; Foreign.C.Types.N:CInt[0]
                                                 :: (Fd :: *) ~R# (GHC.Int.Int32 :: *))
                                    of
                                    { GHC.Int.I32# ww3_sazud ->
                                    case GHC.Event.Manager.$wcloseFd_
                                           ipv8_iaIB9 ww1_sazu9 ww3_sazud eta1_B1
                                    of
                                    { (# ipv12_X7ICI, ipv13_X7ICK #) ->
                                    case go2_saK3r ipv9_iaIBa ipv11_iaIBh ipv12_X7ICI of
                                    { (# ipv14_X7ICO, ipv15_X7ICQ #) ->
                                    (# ipv14_X7ICO, GHC.Types.: @ (IO ()) ipv13_X7ICK ipv15_X7ICQ #)
                                    }
                                    }
                                    }
                                    }
                                }
                            }; } in
                    case go2_saK3r ipv3_X7ICn ipv7_X7ICz ipv6_X7ICx of
                    { (# ipv8_X7ICF, ipv9_X7ICH #) ->
                    case getMaskingState# ipv8_X7ICF of
                    { (# ipv10_iarsq, ipv11_iarsr #) ->
                    let {
                      sequel_saK3F [Dmd=<S,U>] :: [IO ()]
                      [LclId]
                      sequel_saK3F
                        = zipWith3
                            @ EventManager
                            @ (GHC.Event.IntTable.IntTable [M.FdData])
                            @ (IO ())
                            @ (IO ())
                            ((\ (mgr_aaHWy :: EventManager)
                                (table_aaHWz [OS=OneShot]
                                   :: GHC.Event.IntTable.IntTable [M.FdData])
                                (cbApp_aaHWA [OS=OneShot] :: IO ())
                                (s1_i7JiH :: State# RealWorld) ->
                                case mgr_aaHWy of
                                { GHC.Event.Manager.EventManager ds6_dawVB dt1_dawYk dt2_dawYl
                                                                 dt3_dawYm dt4_dawYn dt5_dawYo
                                                                 dt6_dawYp dt7_dawYq dt8_dawYr
                                                                 dt9_dawYs dt10_dawYt dt11_dawYu
                                                                 dt12_dawYv ->
                                case dt1_dawYk of wild5_saLhS { I# m_saLhT ->
                                case dt2_dawYl of wild6_saLhV { I# n_saLhW ->
                                case fd_aaHWv
                                     `cast` (System.Posix.Types.N:Fd[0] ; Foreign.C.Types.N:CInt[0]
                                             :: (Fd :: *) ~R# (GHC.Int.Int32 :: *))
                                of
                                { GHC.Int.I32# x#_i9h2V ->
                                let {
                                  i1_iax2r [Dmd=<S,U>] :: Int#
                                  [LclId]
                                  i1_iax2r = andI# x#_i9h2V 31# } in
                                case <=# m_saLhT i1_iax2r of {
                                  __DEFAULT ->
                                    case GHC.Event.Thread.getSystemEventManager2
                                           wild6_saLhV wild5_saLhS i1_iax2r
                                    of wild8_00 {
                                    };
                                  1# ->
                                    case <=# i1_iax2r n_saLhW of {
                                      __DEFAULT ->
                                        case GHC.Event.Thread.getSystemEventManager2
                                               wild6_saLhV wild5_saLhS i1_iax2r
                                        of wild8_00 {
                                        };
                                      1# ->
                                        case indexArray#
                                               @ (MVar (GHC.Event.IntTable.IntTable [M.FdData]))
                                               dt4_dawYn
                                               (-# i1_iax2r m_saLhT)
                                        of
                                        { (# ipv12_iawOK #) ->
                                        case ipv12_iawOK of { GHC.MVar.MVar mvar#_i9Dsz ->
                                        case putMVar#
                                               @ RealWorld
                                               @ (GHC.Event.IntTable.IntTable [M.FdData])
                                               mvar#_i9Dsz
                                               table_aaHWz
                                               s1_i7JiH
                                        of s2#_i9DsB
                                        { __DEFAULT ->
                                        (cbApp_aaHWA
                                         `cast` (GHC.Types.N:IO[0] <()>_R
                                                 :: (IO () :: *)
                                                    ~R# (State# RealWorld
                                                         -> (# State# RealWorld, () #) :: *)))
                                          s2#_i9DsB
                                        }
                                        }
                                        }
                                    }
                                }
                                }
                                }
                                }
                                })
                             `cast` (<EventManager>_R
                                     ->_R <GHC.Event.IntTable.IntTable [M.FdData]>_R
                                     ->_R <IO ()>_R
                                     ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                                     :: (EventManager
                                         -> GHC.Event.IntTable.IntTable [M.FdData]
                                         -> IO ()
                                         -> State# RealWorld
                                         -> (# State# RealWorld, () #) :: *)
                                        ~R# (EventManager
                                             -> GHC.Event.IntTable.IntTable [M.FdData]
                                             -> IO ()
                                             -> IO () :: *)))
                            ipv3_X7ICn
                            ipv7_X7ICz
                            ipv9_X7ICH } in
                    case ipv11_iarsr of {
                      __DEFAULT ->
                        case catch#
                               @ ()
                               @ SomeException
                               (maskAsyncExceptions#
                                  @ ()
                                  ((close_aaHWu fd_aaHWv)
                                   `cast` (GHC.Types.N:IO[0] <()>_R
                                           :: (IO () :: *)
                                              ~R# (State# RealWorld
                                                   -> (# State# RealWorld, () #) :: *))))
                               (\ (e1_iarsu [OS=OneShot] :: SomeException)
                                  (s1_iarsv [OS=OneShot] :: State# RealWorld) ->
                                  case go_raLJX sequel_saK3F s1_iarsv of
                                  { (# ipv12_iarsy, ipv13_iarsz #) ->
                                  raiseIO# @ SomeException @ () e1_iarsu ipv12_iarsy
                                  })
                               ipv10_iarsq
                        of
                        { (# ipv12_iarsD, ipv13_iarsE #) ->
                        case go_raLJX sequel_saK3F ipv12_iarsD of
                        { (# ipv14_iarsI, ipv15_iarsJ #) ->
                        (# ipv14_iarsI, ipv13_iarsE #)
                        }
                        };
                      0# ->
                        maskAsyncExceptions#
                          @ ()
                          (\ (s1_iarsL [OS=OneShot] :: State# RealWorld) ->
                             case catch#
                                    @ ()
                                    @ SomeException
                                    (unmaskAsyncExceptions#
                                       @ ()
                                       ((close_aaHWu fd_aaHWv)
                                        `cast` (GHC.Types.N:IO[0] <()>_R
                                                :: (IO () :: *)
                                                   ~R# (State# RealWorld
                                                        -> (# State# RealWorld, () #) :: *))))
                                    (\ (e1_iarsM [OS=OneShot] :: SomeException)
                                       (s2_iarsN [OS=OneShot] :: State# RealWorld) ->
                                       case go_raLJX sequel_saK3F s2_iarsN of
                                       { (# ipv12_iarsQ, ipv13_iarsR #) ->
                                       raiseIO# @ SomeException @ () e1_iarsM ipv12_iarsQ
                                       })
                                    s1_iarsL
                             of
                             { (# ipv12_iarsV, ipv13_iarsW #) ->
                             case go_raLJX sequel_saK3F ipv12_iarsV of
                             { (# ipv14_iart0, ipv15_iart1 #) ->
                             (# ipv14_iart0, ipv13_iarsW #)
                             }
                             })
                          ipv10_iarsq;
                      1# ->
                        case catch#
                               @ ()
                               @ SomeException
                               (maskUninterruptible#
                                  @ ()
                                  ((close_aaHWu fd_aaHWv)
                                   `cast` (GHC.Types.N:IO[0] <()>_R
                                           :: (IO () :: *)
                                              ~R# (State# RealWorld
                                                   -> (# State# RealWorld, () #) :: *))))
                               (\ (e1_iart3 [OS=OneShot] :: SomeException)
                                  (s1_iart4 [OS=OneShot] :: State# RealWorld) ->
                                  case go_raLJX sequel_saK3F s1_iart4 of
                                  { (# ipv12_iart7, ipv13_iart8 #) ->
                                  raiseIO# @ SomeException @ () e1_iart3 ipv12_iart7
                                  })
                               ipv10_iarsq
                        of
                        { (# ipv12_iartc, ipv13_iartd #) ->
                        case go_raLJX sequel_saK3F ipv12_iartc of
                        { (# ipv14_iarth, ipv15_iarti #) ->
                        (# ipv14_iarth, ipv13_iartd #)
                        }
                        }
                    }
                    }
                    }
                    } } in
            case ipv5_ia56Y of {
              __DEFAULT -> io_saIXp ipv4_ia56X;
              0# -> maskAsyncExceptions# @ () io_saIXp ipv4_ia56X
            }
            } } in
      case ># x_saLhE y_saLhH of {
        __DEFAULT ->
          letrec {
            go1_saJV6 [Occ=LoopBreaker]
              :: Int#
                 -> State# RealWorld -> (# State# RealWorld, [EventManager] #)
            [LclId, Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
            go1_saJV6
              = \ (x1_i819P :: Int#) (eta1_B1 :: State# RealWorld) ->
                  case <=# x_saLhE x1_i819P of {
                    __DEFAULT ->
                      case GHC.Event.Thread.getSystemEventManager2
                             wild3_saLhG wild2_saLhD x1_i819P
                      of wild4_00 {
                      };
                    1# ->
                      case <=# x1_i819P y_saLhH of {
                        __DEFAULT ->
                          case GHC.Event.Thread.getSystemEventManager2
                                 wild3_saLhG wild2_saLhD x1_i819P
                          of wild4_00 {
                          };
                        1# ->
                          case readArray#
                                 @ RealWorld
                                 @ (Maybe (ThreadId, EventManager))
                                 ds2_i80pw
                                 (-# x1_i819P x_saLhE)
                                 eta1_B1
                          of
                          { (# ipv2_X7ICl, ipv3_X7ICn #) ->
                          case ipv3_X7ICn of {
                            Nothing -> case lvl30_raLJW ipv2_X7ICl of wild5_00 { };
                            Just ds_daIkm ->
                              case ds_daIkm of { (ds4_daIkn, mgr_aaHWI) ->
                              case mgr_aaHWI of mgr1_XaHXs
                              { GHC.Event.Manager.EventManager ipv4_saIAa ipv5_saIAb ipv6_saIAc
                                                               ipv7_saIAd ipv8_saIAe ipv9_saIAf
                                                               ipv10_saIAg ipv11_saIAh ipv12_saIAi
                                                               ipv13_saIAj ipv14_saIAk ipv15_saIAl
                                                               ipv16_saIAm ->
                              case ==# x1_i819P y_saLhH of {
                                __DEFAULT ->
                                  case go1_saJV6 (+# x1_i819P 1#) ipv2_X7ICl of
                                  { (# ipv17_X7ICu, ipv18_X7ICw #) ->
                                  (# ipv17_X7ICu,
                                     GHC.Types.: @ EventManager mgr1_XaHXs ipv18_X7ICw #)
                                  };
                                1# ->
                                  (# ipv2_X7ICl,
                                     GHC.Types.:
                                       @ EventManager mgr1_XaHXs (GHC.Types.[] @ EventManager) #)
                              }
                              }
                              }
                          }
                          }
                      }
                  }; } in
          case go1_saJV6 x_saLhE ipv_i7IAy of
          { (# ipv2_X7ICl, ipv3_X7ICn #) ->
          jump $j_saJV3 ipv2_X7ICl ipv3_X7ICn
          };
        1# -> jump $j_saJV3 ipv_i7IAy (GHC.Types.[] @ EventManager)
      }
      }
      }
      }
      }
      }

-- RHS size: {terms: 1, types: 0, coercions: 9, joins: 0/0}
closeFdWith :: (Fd -> IO ()) -> Fd -> IO ()
[GblId,
 Arity=3,
 Str=<L,C(C1(U))><L,U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.closeFdWith1
               `cast` (<Fd -> IO ()>_R
                       ->_R <Fd>_R
                       ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: ((Fd -> IO ())
                           -> Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# ((Fd -> IO ()) -> Fd -> IO () :: *))}]
closeFdWith
  = GHC.Event.Thread.closeFdWith1
    `cast` (<Fd -> IO ()>_R
            ->_R <Fd>_R
            ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: ((Fd -> IO ())
                -> Fd -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# ((Fd -> IO ()) -> Fd -> IO () :: *))

-- RHS size: {terms: 10, types: 28, coercions: 0, joins: 0/0}
GHC.Event.Thread.registerDelay2
  :: State# RealWorld -> (# State# RealWorld, TVar Bool #)
[GblId,
 Arity=1,
 Caf=NoCafRefs,
 Str=<S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
         Tmpl= \ (s1#_iaIwa [Occ=Once, OS=OneShot] :: State# RealWorld) ->
                 case newTVar# @ Bool @ RealWorld GHC.Types.False s1#_iaIwa of
                 { (# ipv_iaIwd [Occ=Once], ipv1_iaIwe [Occ=Once] #) ->
                 (# ipv_iaIwd, GHC.Conc.Sync.TVar @ Bool ipv1_iaIwe #)
                 }}]
GHC.Event.Thread.registerDelay2
  = \ (s1#_iaIwa [OS=OneShot] :: State# RealWorld) ->
      case newTVar# @ Bool @ RealWorld GHC.Types.False s1#_iaIwa of
      { (# ipv_iaIwd, ipv1_iaIwe #) ->
      (# ipv_iaIwd, GHC.Conc.Sync.TVar @ Bool ipv1_iaIwe #)
      }

-- RHS size: {terms: 187, types: 324, coercions: 8, joins: 0/4}
GHC.Event.Thread.$wregisterDelay [InlPrag=NOUSERINLINE[0]]
  :: Int# -> State# RealWorld -> (# State# RealWorld, TVar Bool #)
[GblId,
 Arity=2,
 Str=<S,U><S,U>,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [0 0] 583 180}]
GHC.Event.Thread.$wregisterDelay
  = \ (ww_saKP5 :: Int#) (w_saKP2 :: State# RealWorld) ->
      case atomically#
             @ (TVar Bool) GHC.Event.Thread.registerDelay2 w_saKP2
      of
      { (# ipv_i7IAy, ipv1_i7IAz #) ->
      case timerManager
           `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                   :: (IORef (Maybe TM.TimerManager) :: *)
                      ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
      of
      { GHC.STRef.STRef var#_i7IB3 ->
      case readMutVar#
             @ RealWorld @ (Maybe TM.TimerManager) var#_i7IB3 ipv_i7IAy
      of
      { (# ipv2_X7IET, ipv3_X7IEV #) ->
      case ipv3_X7IEV of {
        Nothing ->
          case GHC.Event.Thread.getSystemTimerManager2 ipv2_X7IET
          of wild2_00 {
          };
        Just mgr_aaHXe ->
          case mgr_aaHXe of
          { GHC.Event.TimerManager.TimerManager ww2_sasaQ ww3_sasaR ww4_sasaS
                                                ww5_sasaT ww6_sasaU ww7_sasaV ww8_sasaW ww9_sasaX
                                                ww10_sasaY ->
          case fetchAddIntArray# @ RealWorld ww5_sasaT 0# 1# ipv2_X7IET of
          { (# ipv4_iariL, ipv5_iariM #) ->
          let {
            w1_saJVh [Dmd=<L,C(U)>]
              :: State# RealWorld -> (# State# RealWorld, () #)
            [LclId,
             Arity=1,
             Str=<S,U>,
             Unf=Unf{Src=InlineStable, TopLvl=False, Value=True, ConLike=True,
                     WorkFree=True, Expandable=True,
                     Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
                     Tmpl= \ (eta_iaIwq [Occ=Once] :: State# RealWorld) ->
                             case ipv1_i7IAz of { GHC.Conc.Sync.TVar tvar#_iaIwt [Occ=Once] ->
                             case writeTVar#
                                    @ RealWorld @ Bool tvar#_iaIwt GHC.Types.True eta_iaIwq
                             of s2#_iaIwv
                             { __DEFAULT ->
                             (# s2#_iaIwv, GHC.Tuple.() #)
                             }
                             }}]
            w1_saJVh
              = \ (eta_iaIwq :: State# RealWorld) ->
                  case ipv1_i7IAz of { GHC.Conc.Sync.TVar tvar#_iaIwt ->
                  case writeTVar#
                         @ RealWorld @ Bool tvar#_iaIwt GHC.Types.True eta_iaIwq
                  of s2#_iaIwv
                  { __DEFAULT ->
                  (# s2#_iaIwv, GHC.Tuple.() #)
                  }
                  } } in
          case <=# ww_saKP5 0# of {
            __DEFAULT ->
              case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Word# #)}_iariw
                     ipv4_iariL
              of
              { (# ds4_iariz, ds5_iariA #) ->
              let {
                w2_saJVi :: State# RealWorld -> (# State# RealWorld, () #)
                [LclId, Arity=1, Unf=OtherCon []]
                w2_saJVi = atomically# @ () w1_saJVh } in
              let {
                ipv6_sarE0 [Dmd=<L,U(U)>] :: Int
                [LclId, Unf=OtherCon []]
                ipv6_sarE0 = GHC.Types.I# ipv5_iariM } in
              let {
                p_sarKH :: Word#
                [LclId]
                p_sarKH
                  = plusWord# (timesWord# (int2Word# ww_saKP5) 1000##) ds5_iariA } in
              case atomicModifyMutVar#
                     @ RealWorld
                     @ GHC.Event.TimerManager.TimeoutQueue
                     @ (GHC.Event.TimerManager.TimeoutQueue, Bool)
                     @ Bool
                     ww3_sasaR
                     (\ (a1_iarpe :: GHC.Event.TimerManager.TimeoutQueue) ->
                        case GHC.Event.PSQ.$wunsafeInsertNew
                               @ TM.TimeoutCallback
                               ipv5_iariM
                               p_sarKH
                               (w2_saJVi
                                `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                                        :: (State# RealWorld -> (# State# RealWorld, () #) :: *)
                                           ~R# (IO () :: *)))
                               (GHC.Event.PSQ.delete
                                  @ TM.TimeoutCallback
                                  (ipv6_sarE0
                                   `cast` (Sym (GHC.Event.Unique.N:Unique[0])
                                           :: (Int :: *) ~R# (GHC.Event.Unique.Unique :: *)))
                                  a1_iarpe)
                        of a'1_iarpk
                        { __DEFAULT ->
                        (a'1_iarpk,
                         case a1_iarpe of {
                           GHC.Event.PSQ.Bin dt_iarhg dt1_iarhh x_iarhi dt2_iarhj l_iarhk
                                             r_iarhl ->
                             case a'1_iarpk of {
                               GHC.Event.PSQ.Bin dt4_Xarlb dt5_Xarld x1_Xarlf dt6_Xarlh l1_Xarlj
                                                 r1_Xarll ->
                                 tagToEnum# @ Bool (neWord# dt1_iarhh dt5_Xarld);
                               GHC.Event.PSQ.Tip dt4_iarhq dt5_iarhr x1_iarhs ->
                                 tagToEnum# @ Bool (neWord# dt1_iarhh dt5_iarhr);
                               GHC.Event.PSQ.Nil -> GHC.Types.True
                             };
                           GHC.Event.PSQ.Tip dt_iarhq dt1_iarhr x_iarhs ->
                             case a'1_iarpk of {
                               GHC.Event.PSQ.Bin dt2_iarhg dt3_iarhh x1_iarhi dt4_iarhj l_iarhk
                                                 r_iarhl ->
                                 tagToEnum# @ Bool (neWord# dt1_iarhr dt3_iarhh);
                               GHC.Event.PSQ.Tip dt2_Xarlh dt3_Xarlj x1_Xarll ->
                                 tagToEnum# @ Bool (neWord# dt1_iarhr dt3_Xarlj);
                               GHC.Event.PSQ.Nil -> GHC.Types.True
                             };
                           GHC.Event.PSQ.Nil -> GHC.Types.True
                         })
                        })
                     ds4_iariz
              of
              { (# ipv7_iarpn, ipv8_iarpo #) ->
              case ipv8_iarpo of {
                False -> (# ipv7_iarpn, ipv1_i7IAz #);
                True ->
                  case {__pkg_ccall base-4.11.0.0 Int#
                           -> Word# -> State# RealWorld -> (# State# RealWorld, Int# #)}_dao99
                         (narrow32Int# ww8_sasaW) 1## ipv7_iarpn
                  of
                  { (# ds_dao97, ds7_dao96 #) ->
                  case narrow32Int# ds7_dao96 of {
                    __DEFAULT ->
                      case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Int# #)}_iaobJ
                             ds_dao97
                      of
                      { (# ds8_iaobM, ds9_iaobN #) ->
                      case readMutVar# @ RealWorld @ Bool ww10_sasaY ds8_iaobM of
                      { (# ipv9_X7ICP, ipv10_X7ICR #) ->
                      case ipv10_X7ICR of {
                        False ->
                          case Foreign.C.Error.throwErrno1
                                 @ () GHC.Event.Control.sendWakeup2 ipv9_X7ICP
                          of
                          { (# ipv11_i7JiK, ipv12_i7JiL #) ->
                          (# ipv11_i7JiK, ipv1_i7IAz #)
                          };
                        True ->
                          case narrow32Int# ds9_iaobN of {
                            __DEFAULT ->
                              case Foreign.C.Error.throwErrno1
                                     @ () GHC.Event.Control.sendWakeup2 ipv9_X7ICP
                              of
                              { (# ipv11_i7JiK, ipv12_i7JiL #) ->
                              (# ipv11_i7JiK, ipv1_i7IAz #)
                              };
                            9# -> (# ipv9_X7ICP, ipv1_i7IAz #)
                          }
                      }
                      }
                      };
                    0# -> (# ds_dao97, ipv1_i7IAz #)
                  }
                  }
              }
              }
              };
            1# ->
              case atomically# @ () w1_saJVh ipv4_iariL of
              { (# ipv6_i7JiK, ipv7_i7JiL #) ->
              (# ipv6_i7JiK, ipv1_i7IAz #)
              }
          }
          }
          }
      }
      }
      }
      }

-- RHS size: {terms: 8, types: 5, coercions: 0, joins: 0/0}
GHC.Event.Thread.registerDelay1 [InlPrag=NOUSERINLINE[0]]
  :: Int -> State# RealWorld -> (# State# RealWorld, TVar Bool #)
[GblId,
 Arity=2,
 Str=<S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_saKP1 [Occ=Once!] :: Int)
                 (w1_saKP2 [Occ=Once] :: State# RealWorld) ->
                 case w_saKP1 of { I# ww1_saKP5 [Occ=Once] ->
                 GHC.Event.Thread.$wregisterDelay ww1_saKP5 w1_saKP2
                 }}]
GHC.Event.Thread.registerDelay1
  = \ (w_saKP1 :: Int) (w1_saKP2 :: State# RealWorld) ->
      case w_saKP1 of { I# ww1_saKP5 ->
      GHC.Event.Thread.$wregisterDelay ww1_saKP5 w1_saKP2
      }

-- RHS size: {terms: 1, types: 0, coercions: 6, joins: 0/0}
registerDelay :: Int -> IO (TVar Bool)
[GblId,
 Arity=2,
 Str=<S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.registerDelay1
               `cast` (<Int>_R ->_R Sym (GHC.Types.N:IO[0] <TVar Bool>_R)
                       :: (Int
                           -> State# RealWorld -> (# State# RealWorld, TVar Bool #) :: *)
                          ~R# (Int -> IO (TVar Bool) :: *))}]
registerDelay
  = GHC.Event.Thread.registerDelay1
    `cast` (<Int>_R ->_R Sym (GHC.Types.N:IO[0] <TVar Bool>_R)
            :: (Int
                -> State# RealWorld -> (# State# RealWorld, TVar Bool #) :: *)
               ~R# (Int -> IO (TVar Bool) :: *))

-- RHS size: {terms: 313, types: 440, coercions: 39, joins: 1/5}
GHC.Event.Thread.$wthreadDelay [InlPrag=NOUSERINLINE[0]]
  :: Int# -> State# RealWorld -> (# State# RealWorld, () #)
[GblId, Arity=2, Str=<S,U><S,U>, Unf=OtherCon []]
GHC.Event.Thread.$wthreadDelay
  = \ (ww_saKPf :: Int#) (w_saKPc :: State# RealWorld) ->
      case getMaskingState# w_saKPc of { (# ipv_ia56X, ipv1_ia56Y #) ->
      let {
        io_saIXj [Dmd=<C(S),C(U(U,U))>]
          :: State# RealWorld -> (# State# RealWorld, () #)
        [LclId, Arity=1, Str=<S,U>, Unf=OtherCon []]
        io_saIXj
          = \ (s_X7IC1 :: State# RealWorld) ->
              case timerManager
                   `cast` (GHC.IORef.N:IORef[0] <Maybe TM.TimerManager>_N
                           :: (IORef (Maybe TM.TimerManager) :: *)
                              ~R# (GHC.STRef.STRef RealWorld (Maybe TM.TimerManager) :: *))
              of
              { GHC.STRef.STRef var#_i7IB3 ->
              case readMutVar#
                     @ RealWorld @ (Maybe TM.TimerManager) var#_i7IB3 s_X7IC1
              of
              { (# ipv2_i7IAy, ipv3_i7IAz #) ->
              case ipv3_i7IAz of {
                Nothing ->
                  case GHC.Event.Thread.getSystemTimerManager2 ipv2_i7IAy
                  of wild2_00 {
                  };
                Just mgr_aaHXe ->
                  case newMVar# @ RealWorld @ () ipv2_i7IAy of
                  { (# ipv4_iaIyp, ipv5_iaIyq #) ->
                  case mgr_aaHXe of
                  { GHC.Event.TimerManager.TimerManager ww2_sasaQ ww3_sasaR ww4_sasaS
                                                        ww5_sasaT ww6_sasaU ww7_sasaV ww8_sasaW
                                                        ww9_sasaX ww10_sasaY ->
                  case fetchAddIntArray# @ RealWorld ww5_sasaT 0# 1# ipv4_iaIyp of
                  { (# ipv6_iariL, ipv7_iariM #) ->
                  let {
                    ipv8_sarE0 [Dmd=<L,U(U)>] :: Int
                    [LclId, Unf=OtherCon []]
                    ipv8_sarE0 = GHC.Types.I# ipv7_iariM } in
                  join {
                    $j_saJVY [Dmd=<L,1*C1(C1(U(U,U)))>]
                      :: State# RealWorld -> TM.TimeoutKey -> (# State# RealWorld, () #)
                    [LclId[JoinId(2)], Arity=2, Str=<S,U><L,U(U)>, Unf=OtherCon []]
                    $j_saJVY (ipv9_X7ICj [OS=OneShot] :: State# RealWorld)
                             (ipv10_X7ICl [OS=OneShot] :: TM.TimeoutKey)
                      = catch#
                          @ ()
                          @ SomeException
                          (\ (eta_i9Dsl [OS=OneShot] :: State# RealWorld) ->
                             takeMVar# @ RealWorld @ () ipv5_iaIyq eta_i9Dsl)
                          (\ (e_iaIzD [OS=OneShot] :: SomeException)
                             (s1_iaIzE [OS=OneShot] :: State# RealWorld) ->
                             case atomicModifyMutVar#
                                    @ RealWorld
                                    @ GHC.Event.TimerManager.TimeoutQueue
                                    @ (GHC.Event.TimerManager.TimeoutQueue, Bool)
                                    @ Bool
                                    ww3_sasaR
                                    (\ (a1_iarpe :: GHC.Event.TimerManager.TimeoutQueue) ->
                                       case GHC.Event.PSQ.delete
                                              @ TM.TimeoutCallback
                                              (ipv10_X7ICl
                                               `cast` (GHC.Event.TimerManager.N:TimeoutKey[0]
                                                       :: (TM.TimeoutKey :: *)
                                                          ~R# (GHC.Event.Unique.Unique :: *)))
                                              a1_iarpe
                                       of a'1_iarpk
                                       { __DEFAULT ->
                                       (a'1_iarpk,
                                        case a1_iarpe of {
                                          GHC.Event.PSQ.Bin dt_iarhg dt1_iarhh x_iarhi dt2_iarhj
                                                            l_iarhk r_iarhl ->
                                            case a'1_iarpk of {
                                              GHC.Event.PSQ.Bin dt4_Xarlb dt5_Xarld x1_Xarlf
                                                                dt6_Xarlh l1_Xarlj r1_Xarll ->
                                                tagToEnum# @ Bool (neWord# dt1_iarhh dt5_Xarld);
                                              GHC.Event.PSQ.Tip dt4_iarhq dt5_iarhr x1_iarhs ->
                                                tagToEnum# @ Bool (neWord# dt1_iarhh dt5_iarhr);
                                              GHC.Event.PSQ.Nil -> GHC.Types.True
                                            };
                                          GHC.Event.PSQ.Tip dt_iarhq dt1_iarhr x_iarhs ->
                                            case a'1_iarpk of {
                                              GHC.Event.PSQ.Bin dt2_iarhg dt3_iarhh x1_iarhi
                                                                dt4_iarhj l_iarhk r_iarhl ->
                                                tagToEnum# @ Bool (neWord# dt1_iarhr dt3_iarhh);
                                              GHC.Event.PSQ.Tip dt2_Xarlh dt3_Xarlj x1_Xarll ->
                                                tagToEnum# @ Bool (neWord# dt1_iarhr dt3_Xarlj);
                                              GHC.Event.PSQ.Nil -> GHC.Types.True
                                            };
                                          GHC.Event.PSQ.Nil -> GHC.Types.True
                                        })
                                       })
                                    s1_iaIzE
                             of
                             { (# ipv11_iarpn, ipv12_iarpo #) ->
                             case ipv12_iarpo of {
                               False -> raiseIO# @ SomeException @ () e_iaIzD ipv11_iarpn;
                               True ->
                                 case {__pkg_ccall base-4.11.0.0 Int#
                           -> Word# -> State# RealWorld -> (# State# RealWorld, Int# #)}_dao99
                                        (narrow32Int# ww8_sasaW) 1## ipv11_iarpn
                                 of
                                 { (# ds5_dao97, ds6_dao96 #) ->
                                 case narrow32Int# ds6_dao96 of {
                                   __DEFAULT ->
                                     case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Int# #)}_iaobJ
                                            ds5_dao97
                                     of
                                     { (# ds7_iaobM, ds8_iaobN #) ->
                                     case readMutVar# @ RealWorld @ Bool ww10_sasaY ds7_iaobM of
                                     { (# ipv13_X7ICP, ipv14_X7ICR #) ->
                                     case ipv14_X7ICR of {
                                       False ->
                                         case Foreign.C.Error.throwErrno1
                                                @ () GHC.Event.Control.sendWakeup2 ipv13_X7ICP
                                         of
                                         { (# ipv15_iaIzH, ipv16_iaIzI #) ->
                                         raiseIO# @ SomeException @ () e_iaIzD ipv15_iaIzH
                                         };
                                       True ->
                                         case narrow32Int# ds8_iaobN of {
                                           __DEFAULT ->
                                             case Foreign.C.Error.throwErrno1
                                                    @ () GHC.Event.Control.sendWakeup2 ipv13_X7ICP
                                             of
                                             { (# ipv15_iaIzH, ipv16_iaIzI #) ->
                                             raiseIO# @ SomeException @ () e_iaIzD ipv15_iaIzH
                                             };
                                           9# -> raiseIO# @ SomeException @ () e_iaIzD ipv13_X7ICP
                                         }
                                     }
                                     }
                                     };
                                   0# -> raiseIO# @ SomeException @ () e_iaIzD ds5_dao97
                                 }
                                 }
                             }
                             })
                          ipv9_X7ICj } in
                  case <=# ww_saKPf 0# of {
                    __DEFAULT ->
                      case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Word# #)}_iariw
                             ipv6_iariL
                      of
                      { (# ds4_iariz, ds5_iariA #) ->
                      let {
                        w1_saJVI :: State# RealWorld -> (# State# RealWorld, () #)
                        [LclId,
                         Arity=1,
                         Str=<S,U>,
                         Unf=Unf{Src=InlineStable, TopLvl=False, Value=True, ConLike=True,
                                 WorkFree=True, Expandable=True,
                                 Guidance=ALWAYS_IF(arity=1,unsat_ok=True,boring_ok=False)
                                 Tmpl= \ (eta_i9Dsw [Occ=Once] :: State# RealWorld) ->
                                         case putMVar#
                                                @ RealWorld @ () ipv5_iaIyq GHC.Tuple.() eta_i9Dsw
                                         of s2#_i9DsB
                                         { __DEFAULT ->
                                         (# s2#_i9DsB, GHC.Tuple.() #)
                                         }}]
                        w1_saJVI
                          = \ (eta_i9Dsw :: State# RealWorld) ->
                              case putMVar# @ RealWorld @ () ipv5_iaIyq GHC.Tuple.() eta_i9Dsw
                              of s2#_i9DsB
                              { __DEFAULT ->
                              (# s2#_i9DsB, GHC.Tuple.() #)
                              } } in
                      let {
                        p_sarKH :: Word#
                        [LclId]
                        p_sarKH
                          = plusWord# (timesWord# (int2Word# ww_saKPf) 1000##) ds5_iariA } in
                      case atomicModifyMutVar#
                             @ RealWorld
                             @ GHC.Event.TimerManager.TimeoutQueue
                             @ (GHC.Event.TimerManager.TimeoutQueue, Bool)
                             @ Bool
                             ww3_sasaR
                             (\ (a1_iarpe :: GHC.Event.TimerManager.TimeoutQueue) ->
                                case GHC.Event.PSQ.$wunsafeInsertNew
                                       @ TM.TimeoutCallback
                                       ipv7_iariM
                                       p_sarKH
                                       (w1_saJVI
                                        `cast` (Sym (GHC.Types.N:IO[0] <()>_R)
                                                :: (State# RealWorld
                                                    -> (# State# RealWorld, () #) :: *)
                                                   ~R# (IO () :: *)))
                                       (GHC.Event.PSQ.delete
                                          @ TM.TimeoutCallback
                                          (ipv8_sarE0
                                           `cast` (Sym (GHC.Event.Unique.N:Unique[0])
                                                   :: (Int :: *)
                                                      ~R# (GHC.Event.Unique.Unique :: *)))
                                          a1_iarpe)
                                of a'1_iarpk
                                { __DEFAULT ->
                                (a'1_iarpk,
                                 case a1_iarpe of {
                                   GHC.Event.PSQ.Bin dt_iarhg dt1_iarhh x_iarhi dt2_iarhj l_iarhk
                                                     r_iarhl ->
                                     case a'1_iarpk of {
                                       GHC.Event.PSQ.Bin dt4_Xarlb dt5_Xarld x1_Xarlf dt6_Xarlh
                                                         l1_Xarlj r1_Xarll ->
                                         tagToEnum# @ Bool (neWord# dt1_iarhh dt5_Xarld);
                                       GHC.Event.PSQ.Tip dt4_iarhq dt5_iarhr x1_iarhs ->
                                         tagToEnum# @ Bool (neWord# dt1_iarhh dt5_iarhr);
                                       GHC.Event.PSQ.Nil -> GHC.Types.True
                                     };
                                   GHC.Event.PSQ.Tip dt_iarhq dt1_iarhr x_iarhs ->
                                     case a'1_iarpk of {
                                       GHC.Event.PSQ.Bin dt2_iarhg dt3_iarhh x1_iarhi dt4_iarhj
                                                         l_iarhk r_iarhl ->
                                         tagToEnum# @ Bool (neWord# dt1_iarhr dt3_iarhh);
                                       GHC.Event.PSQ.Tip dt2_Xarlh dt3_Xarlj x1_Xarll ->
                                         tagToEnum# @ Bool (neWord# dt1_iarhr dt3_Xarlj);
                                       GHC.Event.PSQ.Nil -> GHC.Types.True
                                     };
                                   GHC.Event.PSQ.Nil -> GHC.Types.True
                                 })
                                })
                             ds4_iariz
                      of
                      { (# ipv9_iarpn, ipv10_iarpo #) ->
                      case ipv10_iarpo of {
                        False ->
                          jump $j_saJVY
                            ipv9_iarpn
                            (ipv8_sarE0
                             `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                     :: (Int :: *) ~R# (TM.TimeoutKey :: *)));
                        True ->
                          case {__pkg_ccall base-4.11.0.0 Int#
                           -> Word# -> State# RealWorld -> (# State# RealWorld, Int# #)}_dao99
                                 (narrow32Int# ww8_sasaW) 1## ipv9_iarpn
                          of
                          { (# ds7_dao97, ds8_dao96 #) ->
                          case narrow32Int# ds8_dao96 of {
                            __DEFAULT ->
                              case {__pkg_ccall base-4.11.0.0 State# RealWorld
                           -> (# State# RealWorld, Int# #)}_iaobJ
                                     ds7_dao97
                              of
                              { (# ds9_iaobM, ds10_iaobN #) ->
                              case readMutVar# @ RealWorld @ Bool ww10_sasaY ds9_iaobM of
                              { (# ipv11_X7ICP, ipv12_X7ICR #) ->
                              case ipv12_X7ICR of {
                                False ->
                                  case Foreign.C.Error.throwErrno1
                                         @ () GHC.Event.Control.sendWakeup2 ipv11_X7ICP
                                  of
                                  { (# ipv13_i7JiK, ipv14_i7JiL #) ->
                                  jump $j_saJVY
                                    ipv13_i7JiK
                                    (ipv8_sarE0
                                     `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                             :: (Int :: *) ~R# (TM.TimeoutKey :: *)))
                                  };
                                True ->
                                  case narrow32Int# ds10_iaobN of {
                                    __DEFAULT ->
                                      case Foreign.C.Error.throwErrno1
                                             @ () GHC.Event.Control.sendWakeup2 ipv11_X7ICP
                                      of
                                      { (# ipv13_i7JiK, ipv14_i7JiL #) ->
                                      jump $j_saJVY
                                        ipv13_i7JiK
                                        (ipv8_sarE0
                                         `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                                 :: (Int :: *) ~R# (TM.TimeoutKey :: *)))
                                      };
                                    9# ->
                                      jump $j_saJVY
                                        ipv11_X7ICP
                                        (ipv8_sarE0
                                         `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                                 :: (Int :: *) ~R# (TM.TimeoutKey :: *)))
                                  }
                              }
                              }
                              };
                            0# ->
                              jump $j_saJVY
                                ds7_dao97
                                (ipv8_sarE0
                                 `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                         :: (Int :: *) ~R# (TM.TimeoutKey :: *)))
                          }
                          }
                      }
                      }
                      };
                    1# ->
                      case putMVar# @ RealWorld @ () ipv5_iaIyq GHC.Tuple.() ipv6_iariL
                      of s2#_i9DsB
                      { __DEFAULT ->
                      jump $j_saJVY
                        s2#_i9DsB
                        (ipv8_sarE0
                         `cast` (Sym (GHC.Event.Unique.N:Unique[0]) ; Sym (GHC.Event.TimerManager.N:TimeoutKey[0])
                                 :: (Int :: *) ~R# (TM.TimeoutKey :: *)))
                      }
                  }
                  }
                  }
                  }
              }
              }
              } } in
      case ipv1_ia56Y of {
        __DEFAULT -> io_saIXj ipv_ia56X;
        0# -> maskAsyncExceptions# @ () io_saIXj ipv_ia56X
      }
      }

-- RHS size: {terms: 8, types: 5, coercions: 0, joins: 0/0}
GHC.Event.Thread.threadDelay1 [InlPrag=NOUSERINLINE[0]]
  :: Int -> State# RealWorld -> (# State# RealWorld, () #)
[GblId,
 Arity=2,
 Str=<S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
         Tmpl= \ (w_saKPb [Occ=Once!] :: Int)
                 (w1_saKPc [Occ=Once] :: State# RealWorld) ->
                 case w_saKPb of { I# ww1_saKPf [Occ=Once] ->
                 GHC.Event.Thread.$wthreadDelay ww1_saKPf w1_saKPc
                 }}]
GHC.Event.Thread.threadDelay1
  = \ (w_saKPb :: Int) (w1_saKPc :: State# RealWorld) ->
      case w_saKPb of { I# ww1_saKPf ->
      GHC.Event.Thread.$wthreadDelay ww1_saKPf w1_saKPc
      }

-- RHS size: {terms: 1, types: 0, coercions: 5, joins: 0/0}
threadDelay :: Int -> IO ()
[GblId,
 Arity=2,
 Str=<S(S),1*U(U)><S,U>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)
         Tmpl= GHC.Event.Thread.threadDelay1
               `cast` (<Int>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
                       :: (Int -> State# RealWorld -> (# State# RealWorld, () #) :: *)
                          ~R# (Int -> IO () :: *))}]
threadDelay
  = GHC.Event.Thread.threadDelay1
    `cast` (<Int>_R ->_R Sym (GHC.Types.N:IO[0] <()>_R)
            :: (Int -> State# RealWorld -> (# State# RealWorld, () #) :: *)
               ~R# (Int -> IO () :: *))


